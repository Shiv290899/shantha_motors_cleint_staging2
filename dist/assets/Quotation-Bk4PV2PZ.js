import{r as l,j as e,G as En,R as Dn}from"./index-D3jyxz5S.js";import{L as ct,d as ce}from"./index-BaYR0Azk.js";import{A as Fn,s as dt,l as Tn,b as Vn,g as On,u as Ge,n as F,D as Bn,r as Wn}from"./caseInsensitive-Bczb6n5Q.js";import{W as Hn,B as ie}from"./button-CtJmIkB1.js";import{M as Mt}from"./index-C426kwCm.js";import{S as qn}from"./index-BBYJ-6BB.js";import{I as J,s as Ee}from"./index-CY4Kamfr.js";import{a as nn,R as _,S as ke}from"./index-CtRvdixs.js";import{F as j}from"./index-CcgLN9cm.js";import{l as zn,p as an,o as Ln,f as on,e as Zt,c as Un,K as en,m as Yn,q as _n,r as Qn,u as Ae,F as Gn,G as Kn,C as Xn,D as Jn,H as Zn,R as ea,z as tn,A as N}from"./TextArea-Q3gpJu61.js";import{D as Nt}from"./index-CU-RyMmz.js";import{T as ot}from"./index-C0lBYX3a.js";import{C as it}from"./index-CZRYr7Ag.js";import{D as ta,R as na}from"./PrinterOutlined-CzweR46M.js";import{I as aa}from"./AntdIcon-DD3d8MPl.js";import{R as oa}from"./PlusOutlined-aHmBnbM2.js";import"./useClosable-DfZqN2_R.js";import"./pickAttrs-CXQyGfOx.js";import"./PurePanel-CsQLL2O2.js";import"./PlusOutlined-AckC3LXy.js";import"./index-nbuh2wRs.js";import"./Skeleton-D--9XwWe.js";import"./EyeOutlined-pj_CrMc9.js";import"./useBubbleLock-Bjm2feVM.js";import"./LeftOutlined-D-CNePKA.js";import"./CheckOutlined-Dmu6kb1T.js";import"./DownOutlined-C-UypXHl.js";import"./index-CUWDS_la.js";var ia=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],rn=l.forwardRef(function(a,o){var m,d=a.prefixCls,x=d===void 0?"rc-switch":d,f=a.className,C=a.checked,u=a.defaultChecked,p=a.disabled,k=a.loadingIcon,T=a.checkedChildren,Q=a.unCheckedChildren,fe=a.onClick,G=a.onChange,de=a.onKeyDown,Se=zn(a,ia),K=an(!1,{value:C,defaultValue:u}),Z=Ln(K,2),R=Z[0],M=Z[1];function me(E,ee){var ae=R;return p||(ae=E,M(ae),G?.(ae,ee)),ae}function ye(E){E.which===en.LEFT?me(!1,E):E.which===en.RIGHT&&me(!0,E),de?.(E)}function V(E){var ee=me(!R,E);fe?.(ee,E)}var ne=on(x,f,(m={},Zt(m,"".concat(x,"-checked"),R),Zt(m,"".concat(x,"-disabled"),p),m));return l.createElement("button",Un({},Se,{type:"button",role:"switch","aria-checked":R,disabled:p,className:ne,ref:o,onKeyDown:ye,onClick:V}),k,l.createElement("span",{className:"".concat(x,"-inner")},l.createElement("span",{className:"".concat(x,"-inner-checked")},T),l.createElement("span",{className:"".concat(x,"-inner-unchecked")},Q)))});rn.displayName="Switch";const ra=a=>{const{componentCls:o,trackHeightSM:m,trackPadding:d,trackMinWidthSM:x,innerMinMarginSM:f,innerMaxMarginSM:C,handleSizeSM:u,calc:p}=a,k=`${o}-inner`,T=Ae(p(u).add(p(d).mul(2)).equal()),Q=Ae(p(C).mul(2).equal());return{[o]:{[`&${o}-small`]:{minWidth:x,height:m,lineHeight:Ae(m),[`${o}-inner`]:{paddingInlineStart:C,paddingInlineEnd:f,[`${k}-checked, ${k}-unchecked`]:{minHeight:m},[`${k}-checked`]:{marginInlineStart:`calc(-100% + ${T} - ${Q})`,marginInlineEnd:`calc(100% - ${T} + ${Q})`},[`${k}-unchecked`]:{marginTop:p(m).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${o}-handle`]:{width:u,height:u},[`${o}-loading-icon`]:{top:p(p(u).sub(a.switchLoadingIconSize)).div(2).equal(),fontSize:a.switchLoadingIconSize},[`&${o}-checked`]:{[`${o}-inner`]:{paddingInlineStart:f,paddingInlineEnd:C,[`${k}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${k}-unchecked`]:{marginInlineStart:`calc(100% - ${T} + ${Q})`,marginInlineEnd:`calc(-100% + ${T} - ${Q})`}},[`${o}-handle`]:{insetInlineStart:`calc(100% - ${Ae(p(u).add(d).equal())})`}},[`&:not(${o}-disabled):active`]:{[`&:not(${o}-checked) ${k}`]:{[`${k}-unchecked`]:{marginInlineStart:p(a.marginXXS).div(2).equal(),marginInlineEnd:p(a.marginXXS).mul(-1).div(2).equal()}},[`&${o}-checked ${k}`]:{[`${k}-checked`]:{marginInlineStart:p(a.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:p(a.marginXXS).div(2).equal()}}}}}}},sa=a=>{const{componentCls:o,handleSize:m,calc:d}=a;return{[o]:{[`${o}-loading-icon${a.iconCls}`]:{position:"relative",top:d(d(m).sub(a.fontSize)).div(2).equal(),color:a.switchLoadingIconColor,verticalAlign:"top"},[`&${o}-checked ${o}-loading-icon`]:{color:a.switchColor}}}},la=a=>{const{componentCls:o,trackPadding:m,handleBg:d,handleShadow:x,handleSize:f,calc:C}=a,u=`${o}-handle`;return{[o]:{[u]:{position:"absolute",top:m,insetInlineStart:m,width:f,height:f,transition:`all ${a.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:d,borderRadius:C(f).div(2).equal(),boxShadow:x,transition:`all ${a.switchDuration} ease-in-out`,content:'""'}},[`&${o}-checked ${u}`]:{insetInlineStart:`calc(100% - ${Ae(C(f).add(m).equal())})`},[`&:not(${o}-disabled):active`]:{[`${u}::before`]:{insetInlineEnd:a.switchHandleActiveInset,insetInlineStart:0},[`&${o}-checked ${u}::before`]:{insetInlineEnd:0,insetInlineStart:a.switchHandleActiveInset}}}}},ca=a=>{const{componentCls:o,trackHeight:m,trackPadding:d,innerMinMargin:x,innerMaxMargin:f,handleSize:C,calc:u}=a,p=`${o}-inner`,k=Ae(u(C).add(u(d).mul(2)).equal()),T=Ae(u(f).mul(2).equal());return{[o]:{[p]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:f,paddingInlineEnd:x,transition:`padding-inline-start ${a.switchDuration} ease-in-out, padding-inline-end ${a.switchDuration} ease-in-out`,[`${p}-checked, ${p}-unchecked`]:{display:"block",color:a.colorTextLightSolid,fontSize:a.fontSizeSM,transition:`margin-inline-start ${a.switchDuration} ease-in-out, margin-inline-end ${a.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:m},[`${p}-checked`]:{marginInlineStart:`calc(-100% + ${k} - ${T})`,marginInlineEnd:`calc(100% - ${k} + ${T})`},[`${p}-unchecked`]:{marginTop:u(m).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${o}-checked ${p}`]:{paddingInlineStart:x,paddingInlineEnd:f,[`${p}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${p}-unchecked`]:{marginInlineStart:`calc(100% - ${k} + ${T})`,marginInlineEnd:`calc(-100% + ${k} - ${T})`}},[`&:not(${o}-disabled):active`]:{[`&:not(${o}-checked) ${p}`]:{[`${p}-unchecked`]:{marginInlineStart:u(d).mul(2).equal(),marginInlineEnd:u(d).mul(-1).mul(2).equal()}},[`&${o}-checked ${p}`]:{[`${p}-checked`]:{marginInlineStart:u(d).mul(-1).mul(2).equal(),marginInlineEnd:u(d).mul(2).equal()}}}}}},da=a=>{const{componentCls:o,trackHeight:m,trackMinWidth:d}=a;return{[o]:Object.assign(Object.assign(Object.assign(Object.assign({},Qn(a)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:d,height:m,lineHeight:Ae(m),verticalAlign:"middle",background:a.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${a.motionDurationMid}`,userSelect:"none",[`&:hover:not(${o}-disabled)`]:{background:a.colorTextTertiary}}),Gn(a)),{[`&${o}-checked`]:{background:a.switchColor,[`&:hover:not(${o}-disabled)`]:{background:a.colorPrimaryHover}},[`&${o}-loading, &${o}-disabled`]:{cursor:"not-allowed",opacity:a.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${o}-rtl`]:{direction:"rtl"}})}},ma=a=>{const{fontSize:o,lineHeight:m,controlHeight:d,colorWhite:x}=a,f=o*m,C=d/2,u=2,p=f-u*2,k=C-u*2;return{trackHeight:f,trackHeightSM:C,trackMinWidth:p*2+u*4,trackMinWidthSM:k*2+u*2,trackPadding:u,handleBg:x,handleSize:p,handleSizeSM:k,handleShadow:`0 2px 4px 0 ${new Kn("#00230b").setA(.2).toRgbString()}`,innerMinMargin:p/2,innerMaxMargin:p+u+u*2,innerMinMarginSM:k/2,innerMaxMarginSM:k+u+u*2}},ha=Yn("Switch",a=>{const o=_n(a,{switchDuration:a.motionDurationMid,switchColor:a.colorPrimary,switchDisabledOpacity:a.opacityLoading,switchLoadingIconSize:a.calc(a.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${a.opacityLoading})`,switchHandleActiveInset:"-30%"});return[da(o),ca(o),la(o),sa(o),ra(o)]},ma);var ua=function(a,o){var m={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&o.indexOf(d)<0&&(m[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var x=0,d=Object.getOwnPropertySymbols(a);x<d.length;x++)o.indexOf(d[x])<0&&Object.prototype.propertyIsEnumerable.call(a,d[x])&&(m[d[x]]=a[d[x]]);return m};const pa=l.forwardRef((a,o)=>{const{prefixCls:m,size:d,disabled:x,loading:f,className:C,rootClassName:u,style:p,checked:k,value:T,defaultChecked:Q,defaultValue:fe,onChange:G}=a,de=ua(a,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[Se,K]=an(!1,{value:k??T,defaultValue:Q??fe}),{getPrefixCls:Z,direction:R,switch:M}=l.useContext(Xn),me=l.useContext(Jn),ye=(x??me)||f,V=Z("switch",m),ne=l.createElement("div",{className:`${V}-handle`},f&&l.createElement(ea,{className:`${V}-loading-icon`})),[E,ee,ae]=ha(V),oe=Zn(d),te=on(M?.className,{[`${V}-small`]:oe==="small",[`${V}-loading`]:f,[`${V}-rtl`]:R==="rtl"},C,u,ee,ae),he=Object.assign(Object.assign({},M?.style),p),Ie=(...re)=>{K(re[0]),G?.apply(void 0,re)};return E(l.createElement(Hn,{component:"Switch"},l.createElement(rn,Object.assign({},de,{checked:Se,onChange:Ie,prefixCls:V,className:te,style:he,disabled:ye,ref:o,loadingIcon:ne}))))}),$t=pa;$t.__ANT_SWITCH=!0;function Rt(){return Rt=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var m=arguments[o];for(var d in m)Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}return a},Rt.apply(this,arguments)}const ga=(a,o)=>l.createElement(aa,Rt({},a,{ref:o,icon:ta})),fa=l.forwardRef(ga);function ya({form:a,webhookUrl:o,EXECUTIVES:m=[],setBrand:d,setMode:x,setVehicleType:f,setFittings:C,setDocsReq:u,setEmiSet:p,setDownPayment:k,setOnRoadPrice:T,setCompany:Q,setModel:fe,setVariant:G,setExtraVehicles:de,setFollowUpEnabled:Se,setFollowUpAt:K,setFollowUpNotes:Z,onPayloadApplied:R,autoApply:M,buttonText:me="Fetch Details",buttonProps:ye={}}){const[V,ne]=l.useState(!1),[E,ee]=l.useState(""),[ae,oe]=l.useState(!1),[te,he]=l.useState([]),[Ie,re]=l.useState(""),Be=l.useRef(""),xe=w=>String(w||"").replace(/\D/g,"").replace(/^0+/,"").slice(-10),Me=()=>{const w=xe(E)||String(E||"").trim(),h=w?`The mobile number "${w}" is not in our quotation records.`:"No matching record found in our quotation records.";re(h),Mt.warning({centered:!0,title:"No quotation found",content:h,okText:"Got it"})},We=async()=>{if(!o)throw new Error("Quotation search webhook is not configured");const w=await dt({webhookUrl:o,method:"GET",payload:{action:"search",mode:"mobile",query:String(E||"")}}),h=w?.data||w;return{mode:"webhook",rows:Array.isArray(h?.rows)?h.rows:[]}},ue=w=>w&&w.formValues?w:{version:0,brand:"SHANTHA",mode:"cash",vehicleType:"scooter",fittings:[],docsReq:[],emiSet:"12",downPayment:0,onRoadPrice:0,company:"",model:"",variant:"",branch:"",followUp:{enabled:!1,at:null,notes:"",status:"pending"},formValues:{serialNo:"",name:"",mobile:"",address:"",company:"",bikeModel:"",variant:"",onRoadPrice:0,executive:m[0]?.name||"",remarks:"",branch:""},extraVehicles:[]},je=w=>{const h=w&&typeof w=="object"?w.payload:null,g=w&&typeof w=="object"?w.values||{}:{},A=pe=>Number(String(pe||0).replace(/[,â‚¹\s]/g,""))||0,D=(...pe)=>pe.find(ve=>ve!=null&&String(ve).trim()!=="")||"",L=(pe,ve)=>{for(const Je of ve){const Pe=pe?.[Je];if(Pe!=null&&String(Pe).trim()!=="")return Pe}return""},Ce=A(g.downPayment||g.DownPayment||g["Down Payment"]||g.DP||g.dp||g.Down_Payment),I=h&&typeof h=="object"?h:{},H=I.formValues||{},mt=D(L(g,["serialNo","Quotation_ID","Quotation ID","Quotation_Id","Serial","Quotation No","Quotation No."]),H.serialNo,I.serialNo),$e=D(L(g,["name","Customer_Name","Customer Name","Customer","Name"]),H.name),ht=D(L(g,["mobile","Mobile","Mobile Number","Phone"]),H.mobile),He=D(L(g,["company","Company"]),H.company,I.company),Fe=D(L(g,["bikeModel","Bike Model","Model"]),H.bikeModel,H.model,I.model),Xe=D(L(g,["variant","Variant"]),H.variant,I.variant),qe=D(L(g,["branch","Branch","Branch Name"]),H.branch,I.branch),Te=D(L(g,["executive","Executive_Name","Executive Name","Executive"]),H.executive,m[0]?.name||""),ut=D(L(g,["remarks","Remarks","Offerings"]),H.remarks,I.remarks),Ne=A(D(L(g,["onRoadPrice","OnRoadPrice","On-Road Price","On Road Price","Price"]),H.onRoadPrice,I.onRoadPrice)),Ve=A(D(L(g,["downPayment","DownPayment","Down Payment","DP","dp"]),H.downPayment,I.downPayment,Ce));return{version:I.version||0,brand:I.brand||"SHANTHA",mode:I.mode||"cash",vehicleType:I.vehicleType||"scooter",fittings:Array.isArray(I.fittings)?I.fittings:[],docsReq:Array.isArray(I.docsReq)?I.docsReq:[],emiSet:I.emiSet||"12",downPayment:Ve,onRoadPrice:Ne,company:He,model:Fe,variant:Xe,branch:qe,savedAt:I.savedAt||"",createdAt:I.createdAt||"",followUp:I.followUp||{enabled:!1,at:null,notes:"",status:"pending"},formValues:{serialNo:mt,name:$e,mobile:ht,address:D(g.address,g.Address,H.address,I.address),company:He,bikeModel:Fe,variant:Xe,onRoadPrice:Ne,downPayment:Ve,executive:Te,remarks:ut,branch:qe},extraVehicles:Array.isArray(I.extraVehicles)?I.extraVehicles:[]}},be=w=>{const h=ue(w);try{d?.(h.brand||"SHANTHA"),x?.(h.mode||"cash"),f?.(h.vehicleType||"scooter"),C?.(Array.isArray(h.fittings)?h.fittings:[]),u?.(Array.isArray(h.docsReq)?h.docsReq:[]),p?.(h.emiSet||"12"),k?.(Number(h.downPayment||0)),T?.(Number(h.onRoadPrice||0)),Q?.(h.company||""),fe?.(h.model||""),G?.(h.variant||""),de?.(Array.isArray(h.extraVehicles)?h.extraVehicles:[]);const g=h.followUp||{};Se?.(!!g.enabled),K?.(g.at?ce(g.at):null),Z?.(g.notes||"");const A=h.formValues||{};a.setFieldsValue({serialNo:A.serialNo||"",name:A.name||"",mobile:xe(A.mobile||""),address:A.address||"",company:A.company||h.company||"",bikeModel:A.bikeModel||h.model||"",variant:A.variant||h.variant||"",onRoadPrice:Number(A.onRoadPrice??h.onRoadPrice??0),downPayment:Number(A.downPayment??h.downPayment??0),executive:A.executive||m[0]?.name||"",remarks:A.remarks||"",branch:A.branch||h.branch||""}),T?.(Number(A.onRoadPrice??h.onRoadPrice??0)),R?.({serialNo:A.serialNo||h.serialNo||"",savedAt:h.savedAt||"",createdAt:h.createdAt||A.createdAt||""}),Ee.success("Quotation loaded."),ne(!1),he([]),ee("")}catch(g){console.warn("applyToForm error:",g),Ee.error("Could not apply fetched details.")}};l.useEffect(()=>{if(!M?.payload&&!M?.values)return;const w=String(M?.token||"")+":"+String(M?.values?.serialNo||M?.payload?.formValues?.serialNo||M?.payload?.serialNo||M?.values?.mobile||M?.payload?.formValues?.mobile||"");if(Be.current===w)return;Be.current=w;const h=je({payload:M?.payload||{},values:M?.values||{}});be(h)},[M]);const De=async()=>{const w=String(E||"").trim(),h=xe(w);if(!h||h.length!==10){Ee.warning("Enter a valid 10-digit mobile number.");return}ee(h),re(""),oe(!0);try{const g=await We();if(!g)throw new Error("No result");const A=(g.rows||[]).map(D=>({payload:je(D)}));if(!A.length){Me(),he([]);return}if(A.length===1){be(A[0].payload);return}he(A.slice(0,10)),Ee.info(`Found ${A.length} matches. Pick one.`)}catch(g){console.warn("FetchQuot search error:",g),Ee.error("Could not fetch quotations. Check the Apps Script/Webhook.")}finally{oe(!1)}},se=w=>{const h=w.payload||{},g=h.formValues||{},A=g.serialNo||"â€”",D=g.name||"â€”",L=xe(g.mobile)||"â€”",Ce=[g.company||h.company,g.bikeModel||h.model,g.variant||h.variant].filter(Boolean).join(" ")||"â€”",I=Number(g.onRoadPrice??h.onRoadPrice??0),H=g.branch||h.branch||"â€”";return e.jsx(ct.Item,{actions:[e.jsx(ie,{type:"link",onClick:()=>be(w.payload),children:"Use"})],children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:"100%"},children:[e.jsxs("div",{children:[e.jsx("b",{children:"Quotation:"})," ",A," Â  ",e.jsx("b",{children:"Name:"})," ",D]}),e.jsxs("div",{children:[e.jsx("b",{children:"Mobile:"})," ",L," Â  ",e.jsx("b",{children:"Vehicle:"})," ",Ce]}),e.jsxs("div",{style:{gridColumn:"1 / span 2",color:"#999"},children:[e.jsx("b",{children:"Branch:"})," ",H," Â  ",e.jsx("b",{children:"Price:"})," â‚¹",I.toLocaleString("en-IN")]})]})})};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{...ye,onClick:()=>{re(""),ne(!0)},children:me}),e.jsx(Mt,{title:"Fetch Quotation",open:V,onCancel:()=>{ne(!1),he([]),re("")},footer:[e.jsx(ie,{onClick:()=>{ne(!1),he([]),re("")},children:"Close"},"close"),e.jsx(ie,{type:"primary",loading:ae,onClick:De,children:"Search"},"search")],children:e.jsxs(qn,{direction:"vertical",style:{width:"100%"},children:[e.jsx(J,{placeholder:"Enter Mobile (10-digit or last few digits)",value:E,inputMode:"numeric",onChange:w=>ee(xe(w.target.value)),onPressEnter:De,allowClear:!0}),Ie&&e.jsx(Fn,{type:"warning",showIcon:!0,message:Ie}),ae&&e.jsx(nn,{}),te.length>1&&e.jsx(ct,{size:"small",bordered:!0,dataSource:te,renderItem:se})]})})]})}const xa="https://script.google.com/macros/s/AKfycby0YV2E2Ryb4YehYRzBistMW4sWN3XDcqaEfgkfRvEjmaKNVKq2Ubi3ul50AbxO6TVPJA/exec",Ke=xa,ba="https://docs.google.com/spreadsheets/d/e/2PACX-1vQYGuNPY_2ivfS7MTX4bWiu1DWdF2mrHSCnmTznZVEHxNmsrgcGWjVZN4UDUTOzQQdXTnbeM-ylCJbB/pub?gid=408799621&single=true&output=csv",rt={company:["Company","Company Name"],model:["Model","Model Name"],variant:["Variant"],price:["On-Road Price","On Road Price","Price","OnRoadPrice"]},va=a=>{const o=[];let m=[],d="",x=!1;for(let f=0;f<a.length;f++){const C=a[f],u=a[f+1];if(C==='"'&&!x){x=!0;continue}if(C==='"'&&x){if(u==='"'){d+='"',f++;continue}x=!1;continue}if(C===","&&!x){m.push(d),d="";continue}if((C===`
`||C==="\r")&&!x){(d!==""||m.length)&&(m.push(d),o.push(m),m=[],d=""),C==="\r"&&u===`
`&&f++;continue}d+=C}return(d!==""||m.length)&&(m.push(d),o.push(m)),o},wa=async a=>{const o=await fetch(a,{cache:"no-store"});if(!o.ok)throw new Error("Sheet fetch failed");const m=await o.text();if(m.trim().startsWith("<"))throw new Error("Expected CSV, got HTML");const d=va(m);if(!d.length)return[];const x=d[0].map(f=>(f||"").trim());return d.slice(1).map(f=>{const C={};return x.forEach((u,p)=>C[u]=f[p]??""),C})},st=(a,o)=>String(o.map(m=>a[m]??"").find(m=>m!=="")||"").trim(),Sa=(a={})=>({company:st(a,rt.company),model:st(a,rt.model),variant:st(a,rt.variant),onRoadPrice:Number(String(st(a,rt.price)||"0").replace(/[",\sâ‚¹]/g,""))||0}),ja=8e3,Ca=9,Na=11,Pt=[{name:"Rukmini",phone:"9901678562"},{name:"Meghana",phone:"9741609799"},{name:"Shubha",phone:"8971585057"},{name:"Rani",phone:"9108970455"},{name:"Likhitha",phone:"9535190015"},{name:"Vanitha",phone:"9380729861"},{name:"Prakash",phone:"9740176476"},{name:"Swathi",phone:"6363116317"},{name:"Kumar",phone:"7975807667"},{name:"Sujay",phone:"7022878048"},{name:"Kavi",phone:"9108970455"},{name:"Narasimha",phone:"9900887666"},{name:"Kavya",phone:"8073165374"}];async function Pa(a,o,m){try{const d=await Wn(a,o,m);if(d?.success&&d?.serial)return String(d.serial)}catch(d){console.error("Failed to reserve quotation serial via API",d)}return ce().format("YYMMDDHHmmss")}const ka=["All Round Guard","Side Stand","Ladies Foot Rest","Grip Cover","Seat Cover","Floor Mat","ISI Helmet"],Aa=["Crash Guard","Engine Guard","Tank Cover","Ladies Handle","Gripper","Seat Cover","ISI Helmet"],kt=["Aadhar Card","Pan Card","Bank Passbook","ATM Card","Local Address Proof"],Ia="Meghana",Ma="Byadarahalli",$a=[{required:!0,message:"Mobile number is required"},{pattern:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit Indian mobile number"}],le=a=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(Math.max(0,Math.round(a||0))),Ra=async a=>await dt({webhookUrl:Ke,method:"POST",payload:{action:"save",data:a}}),Ea=()=>({company:"",model:"",variant:"",onRoadPrice:0,downPayment:0,emiSet:"12"}),lt=["branch","executive","name","mobile","company","bikeModel","variant","onRoadPrice"],At=(a,o)=>{const m=o?.errorFields?.[0]?.name;m?.length&&a.scrollToField(m,{behavior:"smooth",block:"center"})},It=async a=>{const o=await a.validateFields(lt);if(!(Number(o?.onRoadPrice||0)>0))throw new Error("On-Road Price must be greater than 0.");if(!/^[6-9]\d{9}$/.test(String(o?.mobile||"")))throw new Error("Enter a valid 10-digit Indian mobile number.");return o};function co(){const[a]=j.useForm(),[o,m]=l.useState("SHANTHA"),[d,x]=l.useState([]),[f,C]=l.useState(""),[u,p]=l.useState(""),[k,T]=l.useState(""),[Q,fe]=l.useState(0),[G,de]=l.useState(0),Se=(t=6e3)=>{const n=Date.now()+t;de(n),setTimeout(()=>de(0),t+50)},[K,Z]=l.useState(0),[R,M]=l.useState(!1),[me,ye]=l.useState(!1),[V,ne]=l.useState("loan"),[E,ee]=l.useState("12"),ae=l.useMemo(()=>E==="12"?[12,18,24,36]:[24,30,36,48],[E]),[oe,te]=l.useState(0),[he,Ie]=l.useState(!1),[re,Be]=l.useState(!1),xe=l.useRef(!1),[Me,We]=l.useState("scooter"),[ue,je]=l.useState(["Side Stand","Floor Mat","ISI Helmet","Grip Cover"]),[be,De]=l.useState(kt),[se,w]=l.useState([]),[h,g]=l.useState(),[,A]=l.useState(""),[D,L]=l.useState(""),[Ce,I]=l.useState([]),[H,mt]=l.useState(!1),[$e,ht]=l.useState(""),[He,Fe]=l.useState(""),[Xe,qe]=l.useState(""),[Te,ut]=l.useState([]),[Ne,Ve]=l.useState(!0),[pe,ve]=l.useState(()=>ce().add(2,"day").hour(10).minute(0).second(0).millisecond(0)),[Je,Pe]=l.useState(""),[sn,Ze]=l.useState(!1),[ln,Et]=l.useState(!1),[pt,Oe]=l.useState([]),[cn,ze]=l.useState(!1),[dn,mn]=l.useState(null),[et,gt]=l.useState({serialNo:"",savedAt:"",createdAt:""}),Le="Quotation:outbox",ft=(t,n)=>{try{const r=localStorage.getItem(t);return r?JSON.parse(r):n}catch{return n}},Dt=(t,n)=>{try{localStorage.setItem(t,JSON.stringify(n))}catch{}},hn=t=>{const n=ft(Le,[]),r={id:Date.now()+":"+Math.random().toString(36).slice(2),job:t};return n.push(r),Dt(Le,n),r.id},Ft=t=>{const n=ft(Le,[]);Dt(Le,n.filter(r=>r.id!==t))},Tt=async()=>{try{const t=ft(Le,[]);if(!Array.isArray(t)||!t.length)return;for(const n of t){const r=n.job||{};try{if(r.type==="quot"&&Ke){const s=await dt({webhookUrl:Ke,method:"POST",payload:{action:"save",data:r.data}});if(!((s?.data||s)?.success!==!1))throw new Error("Webhook save failed");Ft(n.id)}}catch{}}}catch{}};l.useEffect(()=>{setTimeout(()=>{Tt()},0)},[]),l.useEffect(()=>{const t=()=>Tt();return window.addEventListener("online",t),()=>window.removeEventListener("online",t)},[]);const tt=j.useWatch("executive",a)||h||"",yt=l.useMemo(()=>{const t=i=>String(i||"").trim().toLowerCase(),n=t(tt);if(!n)return"";const r=i=>(i||[]).find(v=>t(v?.name)===n),s=r(Te)||r(Pt);if(s?.phone)return String(s.phone);try{const i=JSON.parse(localStorage.getItem("user")||"null"),v=t(i?.formDefaults?.staffName||i?.name||"");if(v&&v===n)return String(i?.phone||"")}catch{}return""},[tt,Te]),Ue=j.useWatch("branch",a),Vt=j.useWatch("executive",a);l.useEffect(()=>{const t={};!Ue&&D&&(t.branch=D),!Vt&&$e&&(t.executive=$e),Object.keys(t).length&&a.setFieldsValue(t)},[Ue,Vt,D,$e]);const[ge,un]=Ee.useMessage(),Ot=async(t="Saved successfully")=>{ge.destroy("save"),ge.open({key:"save",type:"success",content:t,duration:1.5}),await new Promise(n=>setTimeout(n,300))},Bt=l.useRef(null),pn=l.useMemo(()=>ce().format("DD-MM-YYYY HH:mm"),[]),gn=t=>{const n=t?.startsWith("http")?t:`${window.location.origin}${t||""}`,r=Date.now();return n.includes("?")?`${n}&v=${r}`:`${n}?v=${r}`};l.useEffect(()=>{(async()=>{try{const t=i=>String(i||"").trim().toUpperCase(),n=()=>{try{const i=localStorage.getItem("user");return i?JSON.parse(i):null}catch{return null}},r=i=>i?typeof i=="string"?i:typeof i=="object"&&(i._id||i.id||i.$oid)||null:null;let s=n();if(!s||!s.formDefaults){const i=await En().catch(()=>null);if(i?.success&&i.data){s=i.data;try{localStorage.setItem("user",JSON.stringify(s))}catch{}}}if(s){const i=s?.formDefaults?.staffName||s?.name||void 0,v=i?t(i):void 0,c=s?.role?String(s.role).toLowerCase():void 0,W=!!s?.canSwitchBranch||["owner","admin","backend"].includes(String(c||"").toLowerCase());mt(W);try{const z=String(c||"").toLowerCase();if(["owner","admin","backend"].includes(z)){const B=await Tn({status:"active",limit:500});if(B?.success&&Array.isArray(B?.data?.items)){const q=B.data.items.filter(b=>String(b?.status||"").toLowerCase()==="active").map(b=>({id:String(b.id||b._id||""),name:t(b.name),code:b.code?String(b.code).toUpperCase():""}));I(q)}try{const X=await Vn({role:"staff",status:"active",limit:1e5});if(X?.success&&Array.isArray(X?.data?.items)){const q=X.data.items.map(b=>({name:b.name,phone:b.phone||""}));ut(q)}}catch{}}else{const B=[],X=S=>{if(!S)return;const Y=typeof S=="string"?"":String(S?.status||"").toLowerCase();if(Y&&Y!=="active")return;const Re=S&&(S._id||S.id||S.$oid||S)||"",jt=typeof S=="string"?"":S?.name||"",at=t(jt),Qe=typeof S=="string"?"":S?.code||"";!Re||!at||B.push({id:String(Re),name:String(at),code:Qe?String(Qe).toUpperCase():""})};s?.primaryBranch&&X(s.primaryBranch),Array.isArray(s?.branches)&&s.branches.forEach(X);const q=new Set,b=[];B.forEach(S=>{q.has(S.id)||(q.add(S.id),b.push(S))}),I(b)}}catch{}let $=s?.formDefaults?.branchName?t(s.formDefaults.branchName):void 0;const P=s?.formDefaults?.branchCode&&String(s.formDefaults.branchCode).toUpperCase()||"";if(P){Fe(P);try{a.setFieldsValue({branchCode:P})}catch{}}const y=s?.formDefaults&&(s.formDefaults.branchId?._id||s.formDefaults.branchId||null)||s?.primaryBranch&&(s.primaryBranch?._id||s.primaryBranch||null)||Array.isArray(s?.branches)&&s.branches.length&&(s.branches[0]?._id||s.branches[0])||null;if(y)try{const z=await On(String(y)).catch(()=>null);if(z?.success&&z?.data&&($||($=z.data.name),z?.data?.code&&!He)){const B=String(z.data.code).toUpperCase();Fe(B),qe(String(z.data.id||y));try{a.setFieldsValue({branchCode:B})}catch{}}}catch{}v&&g(v),c&&A(c);const U={};v&&(U.executive=v),$&&(U.branch=$),Object.keys(U).length&&a.setFieldsValue(U),$&&L($),v&&ht(v)}}catch{}try{const n=(await wa(ba)).map(Sa).filter(r=>r.company&&r.model&&r.variant);if(!n.length){ge.warning("Sheet loaded but no valid rows. Switching to manual entry."),M(!0),ye(!1);return}x(n),ye(!0),M(!1)}catch{ge.warning("Could not load vehicle sheet. Switched to manual entry."),M(!0),ye(!1)}})()},[ge]);const fn=Dn.useMemo(()=>{const t=new Map;return(Ce||[]).forEach(n=>t.set(String(n.name||"").toLowerCase(),n)),t},[Ce]),yn=t=>{try{const n=String(t||"").toLowerCase(),r=fn.get(n);if(r){qe(r.id),r.code&&Fe(String(r.code).toUpperCase());try{a.setFieldsValue({branch:r.name,branchCode:r.code?String(r.code).toUpperCase():void 0})}catch{}}}catch{}},Ye=l.useMemo(()=>Ue||D||"",[Ue,D]),xt=l.useMemo(()=>!!String(Ye||"").trim(),[Ye]),nt=cn?pt.length:null,xn=t=>{const n=t?.values||t||{},r=t?.payload||n.Payload||n.payload||n.PAYLOAD||t?.Payload||t?.PAYLOAD||"";let s={};try{s=typeof r=="object"?r:JSON.parse(String(r||"{}"))}catch{s={}}const i=s.formValues||s.values||{},v=s.followUp||s.followup||{},c=String(v.status||n.Status||n.status||"pending").toLowerCase(),W=(y,U)=>{for(const z of U){const B=y?.[z];if(B!=null&&String(B).trim()!=="")return String(B).trim()}return""},$=v.at||v.followUpAt||n["Follow-up At"]||n["Follow Up At"]||n["Followup At"]||n["Follow-up Date"]||n["Follow Up Date"]||n["Followup Date"]||"",P=(()=>{if(!$)return"";const y=ce($,["DD-MM-YYYY HH:mm","DD/MM/YYYY HH:mm","DD-MM-YYYY","DD/MM/YYYY",ce.ISO_8601],!0);return y.isValid()?y.format("DD-MM-YYYY HH:mm"):String($)})();return{serial:i.serialNo||W(n,["Quotation No.","Quotation No","Quotation_ID","Quotation ID","Serial"])||"-",name:i.name||W(n,["Customer_Name","Customer Name","Name"])||"-",mobile:String(i.mobile||W(n,["Mobile","Mobile Number","Phone"])||"").replace(/\D/g,"").slice(-10),vehicle:[i.company||s.company||n.Company,i.bikeModel||s.model||n.Model,i.variant||s.variant||n.Variant].filter(Boolean).join(" ")||"-",branch:i.branch||s.branch||n.Branch||n["Branch Name"]||"-",followUpAt:P,followUpNotes:v.notes||n["Follow-up Notes"]||n["Follow Up Notes"]||n["Followup Notes"]||"",status:c,payload:s,values:n}},bt=async({silent:t=!1}={})=>{if(!xt){Oe([]),ze(!1);return}t||Et(!0);try{const s=await dt({webhookUrl:Ke,method:"GET",payload:{...{action:"list",page:1,pageSize:500},...Ye?{branch:Ye}:{}}}),i=s?.data||s,W=(Array.isArray(i?.data)?i.data:Array.isArray(i?.rows)?i.rows:[]).map(xn).filter($=>$&&$.serial!=="-").filter($=>!$.status||$.status==="pending");Oe(W),ze(!0)}catch{Oe([]),ze(!0)}finally{t||Et(!1)}};l.useEffect(()=>{if(!xt){Oe([]),ze(!1);return}Oe([]),ze(!1),bt({silent:!0})},[xt,Ye]),l.useEffect(()=>{o==="NH"&&(a.setFieldsValue({executive:Ia}),a.setFieldsValue({branch:Ma}))},[o,a]),l.useEffect(()=>{je(Me==="scooter"?["Side Stand","Floor Mat","ISI Helmet","Grip Cover"]:["Tank Cover","Gripper","Seat Cover","ISI Helmet"])},[Me]);const Wt=l.useMemo(()=>Ge(d.map(t=>t.company)),[d]),bn=l.useMemo(()=>{const t=F(f),n=t?d.filter(r=>F(r.company)===t):d;return Ge(n.map(r=>r.model))},[d,f]),vn=l.useMemo(()=>{const t=F(f),n=F(u),r=d.filter(s=>!(t&&F(s.company)!==t||n&&F(s.model)!==n));return Ge(r.map(s=>s.variant))},[d,f,u]),wn=t=>{if(T(t),!R){const n=F(f),r=F(u),s=F(t),v=d.find(c=>F(c.company)===n&&F(c.model)===r&&F(c.variant)===s)?.onRoadPrice||0;a.setFieldsValue({onRoadPrice:v}),Z(v),te(0)}},Sn=(t,n)=>(t>0?(n||0)/t:0)>=.3?Ca:Na,_e=(t,n,r)=>{const i=Math.max(Number(t||0)-Number(n||0),0)+ja,v=r/12,c=Sn(t,n),W=i*(c/100)*v,$=i+W;return r>0?$/r:0},jn=t=>t==="12"?[12,18,24,36]:[24,30,36,48],Ht=async()=>{if(xe.current)return null;xe.current=!0,Ie(!0);try{if(Date.now()-Q<6e3)return null;const n=await Nn();return fe(Date.now()),n}finally{xe.current=!1,Ie(!1)}},vt=async()=>{try{if(Date.now()<G)return;Se(6e3),Be(!0),await new Promise(P=>setTimeout(P,0)),await It(a),await Ht(),await Ot("Saved (background sync). Preparing printâ€¦");const t=Bt.current;if(!t){window.print();return}await new Promise(P=>setTimeout(P,0));const n=t.cloneNode(!0);n.querySelectorAll("canvas").forEach(P=>{try{const y=document.createElement("img");y.alt=P.getAttribute("aria-label")||"canvas",y.src=P.toDataURL("image/png"),y.style.maxWidth="100%",y.style.height="auto",P.parentNode&&P.parentNode.replaceChild(y,P)}catch{}}),n.querySelectorAll("img").forEach(P=>{const y=P.getAttribute("src");y&&!y.startsWith("data:")&&P.setAttribute("src",gn(y))});const r=`
        @page { size: A4 portrait; margin: 0; }
        html, body {
          margin: 0 !important; padding: 0 !important; background: #fff !important;
          -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;
          font-family: Arial, sans-serif;
        }
        * { box-sizing: border-box; }
        .print-wrap { margin: 0 auto; }
        .page { width: 210mm; min-height: 297mm; padding: 12mm; background: #fff !important; }
        .sheet { width: 100%; font: 12pt/1.32 Arial, sans-serif; color: #111; page-break-inside: avoid; }
        .row2 { display: grid; grid-template-columns: 0.8fr 1.4fr; gap: 8px 16px; }
        .row3 { display: grid; grid-template-columns: 0.5fr 0.8fr 1fr; gap: 10px 16px; }
        .box { border: 2px solid #000; border-radius: 6px; padding: 8px 10px; background: #fff; }
        .plist { margin: 0; padding-left: 18px; } .plist li { margin: 0 0 2px; }
        .title-knhonda { font-size: 30pt; font-weight: 900; letter-spacing: .2px; }
        .title-kn { font-size: 32pt; font-weight: 500; letter-spacing: .2px; }
        .title-en { font-size: 18pt; font-weight: 600; margin-top: 2px; }
        .big-price { font-size: 16pt; font-weight: 900; }
        .addr-line { font-size: 11pt; } .addr-linehonda { font-size: 12pt; }
        .hdr-line { display:flex; align-items:center; border-bottom:2px solid #000; padding-bottom:6px; margin-bottom:8px; }
        .hdr-title { flex: 1; display: flex; justify-content: center; }
        .quo-box { font-size: 17pt; border: 2px solid #000; padding: 4px 10px; font-weight: 800; display: inline-block; }
        .hdr-right { text-align: right; font-weight: 600; }
        .emibox { border: 2px solid #000; border-radius: 8px; padding: 6px 10px; text-align: center; }
        .section-title { font-size: 14pt; font-weight: 900; margin-bottom: 4px; }
        img { max-width: 100%; height: auto; background: transparent; }
        @media print {
          * { transform: none !important; }
          .fixed, .sticky, [style*="position: sticky"], [style*="position: fixed"] { position: static !important; }
          .no-print { display: none !important; }
        }
      `;if(/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)){const P=window.open("","_blank");if(!P){ge.error("Please allow pop-ups to print.");return}const y=P.document;y.open(),y.write(`
          <!doctype html>
          <html>
          <head>
            <meta charset="utf-8"/>
            <meta name="viewport" content="width=device-width, initial-scale=1"/>
            <base href="${location.origin}${location.pathname}">
            <title>Quotation</title>
            <style>${r}</style>
          </head>
          <body>
            <div class="print-wrap"></div>
          </body>
          </html>
        `),y.close();const U=y.querySelector(".print-wrap"),z=y.importNode(n,!0);U.appendChild(z),await(async()=>{const X=Array.from(y.images||[]);if(await Promise.all(X.map(q=>q.complete&&q.naturalWidth?Promise.resolve():new Promise(b=>{q.onload=q.onerror=()=>b()}))),y.fonts&&y.fonts.ready)try{await y.fonts.ready}catch{}await new Promise(q=>setTimeout(q,200))})();try{P.focus()}catch{}P.print(),setTimeout(wt,1e3);return}const i=document.createElement("iframe");i.style.position="fixed",i.style.right="0",i.style.bottom="0",i.style.width="0",i.style.height="0",i.style.border="0",i.setAttribute("aria-hidden","true"),document.body.appendChild(i);const v=i.contentWindow,c=v.document;c.open(),c.write(`
        <!doctype html>
        <html>
        <head>
          <meta charset="utf-8"/>
          <meta name="viewport" content="width=device-width, initial-scale=1"/>
          <base href="${location.origin}${location.pathname}">
          <title>Quotation</title>
          <style>${r}</style>
        </head>
        <body>
          <div class="print-wrap"></div>
        </body>
        </html>
      `),c.close(),c.querySelector(".print-wrap").appendChild(c.importNode(n,!0));const $=async()=>{const P=Array.from(c.images||[]);if(await Promise.all(P.map(y=>y.complete&&y.naturalWidth?Promise.resolve():new Promise(U=>{y.onload=y.onerror=()=>U()}))),c.fonts&&c.fonts.ready)try{await c.fonts.ready}catch{}await new Promise(y=>setTimeout(y,200))};try{await $();try{v.focus()}catch{}try{v.print()}catch{window.print()}setTimeout(wt,1e3)}finally{setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},800)}}catch(t){ge.warning(t?.message||"Fix the highlighted fields before printing.");try{await a.validateFields(lt)}catch(n){At(a,n)}return}finally{Be(!1)}},qt=l.useRef(vt);l.useEffect(()=>{qt.current=vt}),l.useEffect(()=>{const t=n=>{(n.ctrlKey||n.metaKey)&&(n.key==="p"||n.key==="P")&&(n.preventDefault(),qt.current?.())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]);const Cn=(t,n)=>{if(t&&typeof t=="object"){const r={};Object.keys(t).forEach(s=>{const i=t[s];r[s]=typeof i=="string"?i.toUpperCase():i}),Object.keys(r).length&&a.setFieldsValue(r)}if(typeof n?.onRoadPrice<"u"&&(Z(Number(n.onRoadPrice||0)),oe>Number(n.onRoadPrice||0)&&te(Number(n.onRoadPrice||0))),typeof n?.downPayment<"u"){const r=Number(n.downPayment||0);te(r)}},wt=()=>{a.resetFields(),m("SHANTHA"),C(""),p(""),T(""),Z(0),M(!me),ne("loan"),ee("12"),te(0),We("scooter"),je(["Side Stand","Floor Mat","ISI Helmet","Grip Cover"]),De(kt),w([]),Ve(!0),ve(ce().add(2,"day").hour(10).minute(0).second(0).millisecond(0)),Pe(""),gt({serialNo:"",savedAt:"",createdAt:""});const t={};D&&(t.branch=D),$e&&(t.executive=$e),Object.keys(t).length&&a.setFieldsValue(t),ge.success("Form has been reset for a new quotation.")},zt=j.useWatch("branch",a),Lt=j.useWatch("executive",a),Ut=j.useWatch("name",a),Yt=j.useWatch("mobile",a),_t=j.useWatch("company",a),Qt=j.useWatch("bikeModel",a),Gt=j.useWatch("variant",a),Kt=j.useWatch("onRoadPrice",a),St=l.useMemo(()=>{const t=/^[6-9]\d{9}$/.test(String(Yt||"")),n=Number(Kt||0)>0;return!!(zt&&Lt&&Ut&&t&&_t&&Qt&&Gt&&n)},[zt,Lt,Ut,Yt,_t,Qt,Gt,Kt]),Nn=async()=>{try{await It(a)}catch(b){Ee.error(b?.message||"Please complete all required fields.");try{await a.validateFields(lt)}catch(S){At(a,S)}throw b}const t=await a.validateFields(["name","mobile","address","company","bikeModel","variant","onRoadPrice","executive","remarks","branch",...V==="loan"?["downPayment"]:[]]);for(let b=0;b<se.length;b++){const S=se[b];if(!S.company||!S.model||!S.variant||!S.onRoadPrice)throw new Error(`Please complete Vehicle ${b+2} before saving.`);if(V==="loan"){const Y=Number(S.downPayment||0);if(!(Y>0))throw new Error(`Enter down payment for Vehicle ${b+2} (loan)`);if(Y>Number(S.onRoadPrice||0))throw new Error(`Down payment for Vehicle ${b+2} cannot exceed its on-road price`)}}let n=String(a.getFieldValue("serialNo")||"").trim();if(!n||!/^Q-[A-Z]+-[A-Z0-9]{6}$/.test(n))try{n=await Pa(t.mobile,He||(a.getFieldValue("branchCode")||"").toUpperCase(),Xe),a.setFieldsValue({serialNo:n})}catch{n=ce().format("YYMMDDHHmmss"),a.setFieldsValue({serialNo:n})}t.serialNo=n;const s=(b,S,Y)=>[b,S,Y].filter(Boolean).join(" "),i=[];{const b=t.company||"",S=t.bikeModel||"",Y=t.variant||"",Re=s(b,S,Y);Re&&i.push(`V1: ${Re}`)}se.forEach((b,S)=>{const Y=s(b.company||"",b.model||"",b.variant||"");Y&&i.push(`V${S+2}: ${Y}`)});const v=Array.isArray(ue)&&ue.length?`Fittings: ${Array.from(new Set(ue.filter(Boolean))).join(", ")}`:"",c=[String(t.remarks||"").trim(),...i,v].filter(Boolean).join(" | "),W=new Date().toISOString(),$=String(et?.serialNo||"").trim(),P=String(t.serialNo||"").trim(),y=$&&P&&$===P,U=y?String(et?.savedAt||"").trim():"",z=y?String(et?.createdAt||et?.savedAt||"").trim():"",B={version:2,savedAt:U||W,createdAt:z||U||W,updatedAt:W,brand:o,mode:V,vehicleType:Me,fittings:ue,docsReq:be,emiSet:E,downPayment:oe,onRoadPrice:K,address:t.address||"",followUp:{enabled:!!Ne,at:Ne&&pe&&ce(pe).isValid()?ce(pe).toISOString():null,notes:String(Je||""),updatedAt:W,status:"pending"},formValues:{address:t.address,onRoadPrice:t.onRoadPrice,downPayment:Number(t.downPayment||0)},extraVehicles:se};gt({serialNo:t.serialNo,savedAt:B.savedAt,createdAt:B.createdAt});const X={serialNo:t.serialNo,formValues:{name:t.name,mobile:t.mobile,address:t.address,company:t.company,bikeModel:t.bikeModel,variant:t.variant,executive:t.executive,remarks:c,branch:t.branch||""},payload:B},q=hn({type:"quot",data:X});return setTimeout(async()=>{try{const b=await Ra(X);(b?.data||b)?.success!==!1&&Ft(q)}catch{}},0),{values:t,queued:!0}},Pn=t=>{const n=String(t||"").replace(/\D/g,"").replace(/^0+/,"");return n.length===10?`91${n}`:n.startsWith("91")&&n.length===12?n:""},kn=async()=>{try{if(Date.now()<G)return;Se(6e3),await It(a),await Ht(),await Ot("Saved (background sync). Opening WhatsAppâ€¦");const t=a.getFieldsValue(!0),n=Pn(t.mobile);if(!n){ge.error("Enter a valid 10-digit Indian mobile to open WhatsApp.");return}const r=o==="SHANTHA"?"Shantha Motors":"NH Motors",s=(a.getFieldValue("name")||"-").trim(),i=(f||a.getFieldValue("company")||"-").trim(),v=(u||a.getFieldValue("bikeModel")||"-").trim(),c=(k||a.getFieldValue("variant")||"-").trim(),W=a.getFieldValue("onRoadPrice")??K??0,P=[{title:"Vehicle 1",company:i,model:v,variant:c,price:W,dp:oe||0,emiSet:E},...se.map((O,Ct)=>({title:`Vehicle ${Ct+2}`,company:O.company,model:O.model,variant:O.variant,price:O.onRoadPrice,dp:O.downPayment||0,emiSet:O.emiSet||"12"}))],y=(()=>{try{return JSON.parse(localStorage.getItem("user")||"null")}catch{return null}})(),U=String(yt||"").replace(/\D/g,""),z=t.executive||tt||y?.formDefaults?.staffName||y?.name||"-",B=ce().format("DD-MM-YYYY HH:mm"),X=[`*Hi ${s}, Welcome to ${r}! ðŸï¸*`,"Multi-brand two-wheeler sales, service, spares, exchange, finance & insurance","*Mob No - 9731366921 / 8073283502*","",`â€¢ *Quotation Date:* ${B}`],q=O=>O==="12"?[12,18,24,36]:[24,30,36,48],b=P.map(O=>{const Ct=q(O.emiSet),Rn=V==="loan"?[`   â€“ Down Payment: ${le(O.dp||0)}`,...Ct.map(Jt=>`   â€“ ${Jt} months: ${le(_e(O.price,O.dp||0,Jt))}`)]:[];return["",`*${O.title}:*`,`â€¢ *Vehicle:* ${O.company} ${O.model} ${O.variant}`,`â€¢ *On-Road Price:* ${le(O.price)}`,...V==="loan"?["â€¢ *EMI Options (approx.):*",...Rn]:[]].join(`
`)}),S=Array.isArray(ue)?ue.filter(Boolean):[],Y=Array.isArray(be)?be.filter(Boolean):[],Re=["",...S.length?["*Free Extra Fittings:*",...S.map(O=>`   âœ… ${O}`)]:[],...Y.length?["","*Documents Required:*",...Y.map(O=>`   ðŸ“„ ${O}`)]:[]],jt=["",`â€¢ *Sales Executive:* ${z} (${U||"-"})`,"*Our Locations* ðŸ“","Muddinapalya â€¢ Hegganahalli â€¢ Nelagadrahalli â€¢ Andrahalli","Kadabagere â€¢ Channenahalli â€¢ Tavarekere ","","â€¢ *Note:* Prices are indicative and may change without prior notice.","",`âœ¨ *${r} â€” Ride with Pride, Drive with Confidence.* âœ¨`],at=[...X,...b,...Re,...jt].join(`
`),Qe=`https://wa.me/${n}?text=${encodeURIComponent(at)}`;window.open(Qe,"_blank","noopener,noreferrer")||(window.location.href=Qe),setTimeout(wt,1e3)}catch(t){ge.warning(t?.message||"Please fill all required fields before sending on WhatsApp.");try{await a.validateFields(lt)}catch(n){At(a,n)}}},Xt=({items:t})=>t?.length?e.jsx("ul",{className:"plist",children:t.map((n,r)=>e.jsx("li",{children:n},`${n}-${r}`))}):e.jsx("span",{children:"-"}),An=t=>Ge(d.filter(n=>F(n.company)===F(t)).map(n=>n.model)),In=(t,n)=>Ge(d.filter(r=>F(r.company)===F(t)&&F(r.model)===F(n)).map(r=>r.variant)),we=(t,n)=>{w(r=>{const s=[...r],i={...s[t],...n};if(!R&&n.variant){const v=d.find(c=>F(c.company)===F(i.company||"")&&F(c.model)===F(i.model||"")&&F(c.variant)===F(n.variant));v&&(i.onRoadPrice=v.onRoadPrice||0,i.downPayment=0)}return!R&&n.company&&(i.model="",i.variant="",i.onRoadPrice=0,i.downPayment=0),!R&&n.model&&(i.variant="",i.onRoadPrice=0,i.downPayment=0),s[t]=i,s})},Mn=()=>{w(t=>t.length>=3?t:[...t,Ea()])},$n=t=>{w(n=>n.filter((r,s)=>s!==t))};return e.jsxs(e.Fragment,{children:[un,e.jsx("style",{children:`
        .wrap { max-width: 1000px; margin: 12px auto; padding: 0 12px; }
        .card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 12px; }
        /* Make header actions stack on small screens */
        @media screen and (max-width: 600px) {
          .brand-actions-row { grid-template-columns: 1fr !important; row-gap: 8px; }
          .brand-actions { align-items: flex-start !important; }
        }
        .print-sheet { display: none; }
        @media print { .print-sheet { display: block; } .no-print { display: none !important; } }
      `}),e.jsx("div",{className:"wrap no-print",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8}}),e.jsx(j,{layout:"vertical",form:a,initialValues:{},onValuesChange:Cn,children:e.jsxs(tn,{gutter:[12,8],children:[e.jsx(N,{span:24,children:e.jsxs("div",{className:"brand-actions-row",style:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:12},children:[e.jsx(j.Item,{label:"Brand on Print",style:{marginBottom:0},children:e.jsxs(_.Group,{value:o,onChange:t=>m(t.target.value),children:[e.jsx(_,{value:"SHANTHA",children:"Shantha Motors"}),e.jsx(_,{value:"NH",children:"NH Motors (Honda)"})]})}),e.jsxs("div",{className:"brand-actions",style:{display:"flex",flexDirection:"row",gap:8,alignItems:"center"},children:[e.jsx(ya,{form:a,webhookUrl:Ke,EXECUTIVES:Pt,setBrand:m,setMode:ne,setVehicleType:We,setFittings:je,setDocsReq:De,setEmiSet:ee,setDownPayment:te,setOnRoadPrice:Z,setCompany:C,setModel:p,setVariant:T,setExtraVehicles:w,setFollowUpEnabled:Ve,setFollowUpAt:ve,setFollowUpNotes:Pe,onPayloadApplied:gt,autoApply:dn,buttonText:"Fetch Details",buttonProps:{style:{background:"#2ECC71",borderColor:"#2ECC71",color:"#fff"}}}),e.jsx(ie,{onClick:async()=>{Ze(!0),await bt()},children:nt===null?"PendingCases":`PendingCases (${nt})`})]})]})}),e.jsx(Mt,{title:nt!==null?`PendingCases (${nt})`:"PendingCases",open:sn,onCancel:()=>Ze(!1),width:"min(1200px, 96vw)",footer:[e.jsx(ie,{onClick:()=>bt(),children:"Refresh"},"refresh"),e.jsx(ie,{type:"primary",onClick:()=>Ze(!1),children:"Close"},"close")],children:ln?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:16},children:e.jsx(nn,{})}):pt.length?e.jsx(ct,{size:"small",dataSource:pt,renderItem:t=>{const n=String(t.name||"-").trim(),r=String(t.mobile||"-").trim(),s=String(t.vehicle||"-").trim(),i=String(t.followUpAt||"").trim(),v=String(t.followUpNotes||"").trim(),c=[i,v].filter(Boolean).join(" - "),W=[n,r,s,c].filter(Boolean).join(" | ");return e.jsx(ct.Item,{style:{paddingInline:0},children:e.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,padding:"10px 12px",borderRadius:12,border:"1px solid #dbe3ef",background:"linear-gradient(180deg, #ffffff 0%, #f8fbff 100%)"},children:[e.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:10,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},title:W,children:[e.jsx("span",{style:{fontSize:22,lineHeight:1,color:"#0ea5a8"},children:"â—"}),e.jsx("span",{style:{fontSize:21,lineHeight:1.15,fontWeight:800,color:"#111827",textTransform:"uppercase",flexShrink:0},children:n}),e.jsx("span",{style:{padding:"4px 10px",borderRadius:999,background:"#e6fffb",border:"1px solid #7dd3fc",color:"#0f766e",fontWeight:800,fontSize:17,letterSpacing:.2,flexShrink:0},children:r}),e.jsx("span",{style:{color:"#9ca3af",fontWeight:700,fontSize:18,flexShrink:0},children:"|"}),e.jsx("span",{style:{fontSize:18,fontWeight:700,color:"#1f2937"},children:s}),c?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"#9ca3af",fontWeight:700,fontSize:18,flexShrink:0},children:"|"}),e.jsxs("span",{style:{fontSize:15,fontWeight:600,color:"#4b5563"},children:["Follow-up: ",c]})]}):null]}),e.jsx(ie,{type:"primary",style:{minWidth:74,height:34,borderRadius:8,fontWeight:700},onClick:()=>{t?.payload&&(mn({payload:t.payload,values:t.values||{},token:Date.now()}),Ze(!1),Oe($=>$.filter(P=>P.serial!==t.serial)))},children:"Open"})]})})}}):e.jsx("div",{style:{color:"#666"},children:"No pending quotations."})}),e.jsx(N,{span:24,children:e.jsxs(j.Item,{label:"Type manually (no sheet)",valuePropName:"checked",children:[e.jsx($t,{checked:R,onChange:M}),e.jsx("span",{style:{marginLeft:8,color:"#666"},children:me?"You can still switch to manual if needed.":"Sheet unavailable â€” manual mode enabled."})]})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(j.Item,{label:"Quotation No.",name:"serialNo",children:e.jsx(J,{placeholder:"Auto at save",readOnly:!0})})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(j.Item,{label:"Branch",name:"branch",rules:[{required:!0,message:"Branch is required"}],children:H&&Ce.length?e.jsx(ke,{placeholder:"Select branch",value:Ue,onChange:t=>yn(t),options:Ce.map(t=>({value:t.name,label:t.name}))}):e.jsx(J,{readOnly:!0,placeholder:"Auto-fetched from your profile"})})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(j.Item,{label:"Executive Name",name:"executive",rules:[{required:!0,message:"Executive is required"}],children:H?e.jsx(ke,{showSearch:!0,optionFilterProp:"label",placeholder:"Select executive",options:(Te.length?Te:Pt).map(t=>({value:t.name,label:t.name}))}):e.jsx(J,{readOnly:!0,placeholder:"Auto-fetched from your profile"})})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(j.Item,{label:"Payment Mode",children:e.jsxs(_.Group,{optionType:"button",buttonStyle:"solid",value:V,onChange:t=>ne(t.target.value),children:[e.jsx(_.Button,{value:"loan",children:"Loan"}),e.jsx(_.Button,{value:"cash",children:"Cash"})]})})}),e.jsx(N,{xs:24,sm:12,md:12,children:e.jsx(j.Item,{label:"Customer Name",name:"name",rules:[{required:!0,message:"Enter name"}],getValueFromEvent:t=>{const n=t?.target?.value??t;return typeof n=="string"?n.toUpperCase():n},children:e.jsx(J,{placeholder:"CUSTOMER NAME",style:{textTransform:"uppercase"}})})}),e.jsx(N,{xs:24,sm:12,md:12,children:e.jsx(j.Item,{label:"Mobile Number",name:"mobile",rules:$a,normalize:t=>t&&t.replace(/\D/g,"").slice(0,10),children:e.jsx(J,{placeholder:"10-digit mobile",maxLength:10})})}),e.jsx(N,{xs:24,children:e.jsx(j.Item,{label:"Address",name:"address",rules:[{message:"Enter address"}],children:e.jsx(J.TextArea,{rows:2,placeholder:"House No, Street, Area, City, PIN"})})}),e.jsx(N,{span:24,children:e.jsx(Nt,{orientation:"left",children:"Vehicle 1"})}),e.jsx(N,{xs:24,sm:12,md:8,children:e.jsx(j.Item,{label:"Company",name:"company",rules:[{required:!0,message:"Enter company"}],children:R?e.jsx(J,{placeholder:"Type company",onChange:t=>C(t.target.value)}):e.jsx(ke,{placeholder:"Select Company",options:Wt.map(t=>({value:t,label:t})),onChange:t=>{C(t),p(""),T(""),Z(0),te(0),a.setFieldsValue({bikeModel:void 0,variant:void 0,onRoadPrice:void 0})}})})}),e.jsx(N,{xs:24,sm:12,md:8,children:e.jsx(j.Item,{label:"Model",name:"bikeModel",rules:[{required:!0,message:"Enter model"}],children:R?e.jsx(J,{placeholder:"Type model",onChange:t=>p(t.target.value)}):e.jsx(ke,{placeholder:"Select Model",disabled:!f,options:bn.map(t=>({value:t,label:t})),onChange:t=>{p(t),T(""),Z(0),te(0),a.setFieldsValue({variant:void 0,onRoadPrice:void 0})}})})}),e.jsx(N,{xs:24,sm:12,md:8,children:e.jsx(j.Item,{label:"Variant",name:"variant",rules:[{required:!0,message:"Enter variant"}],children:R?e.jsx(J,{placeholder:"Type variant",onChange:t=>T(t.target.value)}):e.jsx(ke,{placeholder:"Select Variant",disabled:!u,options:vn.map(t=>({value:t,label:t})),onChange:wn})})}),e.jsx(N,{xs:24,sm:12,md:24,children:e.jsx(j.Item,{label:"On-Road Price (â‚¹)",name:"onRoadPrice",rules:[{required:!0,message:"Enter on-road price"},()=>({validator(t,n){return Number(n||0)>0?Promise.resolve():Promise.reject(new Error("On-road price must be greater than 0"))}})],children:e.jsx(ot,{style:{width:"100%"},readOnly:!R,formatter:t=>`â‚¹ ${String(t??"0").replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,parser:t=>String(t||"0").replace(/[â‚¹,\s]/g,"")})})}),V==="loan"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{xs:24,sm:12,md:12,children:e.jsx(j.Item,{label:"Down Payment (â‚¹)",name:"downPayment",rules:[{required:!0,message:"Down payment is required for loan"},()=>({validator(t,n){const r=Number(n||0);return!Number.isFinite(r)||r<=0?Promise.reject(new Error("Enter a positive amount")):r>Number(K||0)?Promise.reject(new Error("Down payment cannot exceed on-road price")):Promise.resolve()}})],children:e.jsx(ot,{style:{width:"100%"},min:0,max:K,step:1e3,value:oe,onChange:t=>{const n=Math.min(Number(t||0),K||0);te(n),a.setFieldsValue({downPayment:n})},formatter:t=>`â‚¹ ${String(t??"0").replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,parser:t=>String(t||"0").replace(/[â‚¹,\s]/g,"")})})}),e.jsx(N,{xs:24,children:e.jsx(j.Item,{label:"EMI Set",children:e.jsxs(_.Group,{value:E,onChange:t=>ee(t.target.value),children:[e.jsx(_,{value:"12",children:"12"}),e.jsx(_,{value:"48",children:"48"})]})})}),e.jsx(N,{xs:24,children:e.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:ae.map(t=>e.jsxs("div",{className:"emibox",style:{minWidth:140},children:[e.jsxs("div",{style:{fontWeight:700},children:[t," months"]}),e.jsx("div",{style:{fontWeight:900,fontSize:16},children:le(_e(K,oe,t))})]},t))})})]}),e.jsx(N,{xs:24,md:12,children:e.jsx(j.Item,{label:"Vehicle Type",name:"vehicleType",children:e.jsxs(_.Group,{optionType:"button",buttonStyle:"solid",value:Me,onChange:t=>We(t.target.value),children:[e.jsx(_.Button,{value:"scooter",children:"Scooter"}),e.jsx(_.Button,{value:"motorcycle",children:"Motorcycle"})]})})}),e.jsx(N,{xs:24,md:12,children:e.jsx(j.Item,{label:"Free Extra Fittings (shown on print)",children:e.jsx(it.Group,{value:ue,onChange:je,children:(Me==="scooter"?ka:Aa).map(t=>e.jsx("div",{style:{marginBottom:6},children:e.jsx(it,{value:t,children:t})},t))})})}),e.jsx(N,{xs:24,children:e.jsx(j.Item,{label:"Documents Required (always printed)",children:e.jsx(it.Group,{value:be,onChange:De,children:kt.map((t,n)=>e.jsx("div",{style:{marginBottom:6},children:e.jsx(it,{value:t,children:t})},`${t}-${n}`))})})}),e.jsx(N,{span:24,children:e.jsx(Nt,{orientation:"left",children:"Follow-up"})}),e.jsx(N,{xs:24,md:8,children:e.jsx(j.Item,{label:"Schedule follow-up?",children:e.jsx($t,{checked:Ne,onChange:Ve})})}),e.jsx(N,{xs:24,md:8,children:e.jsx(j.Item,{label:"Follow-up date & time",children:e.jsx(Bn,{showTime:!0,style:{width:"100%"},value:pe,onChange:ve,disabled:!Ne})})}),e.jsx(N,{xs:24,md:8,children:e.jsx(j.Item,{label:"Follow-up notes",children:e.jsx(J,{placeholder:"e.g., Customer will decide after salary",value:Je,onChange:t=>Pe(t.target.value),disabled:!Ne})})}),e.jsxs(N,{span:24,children:[e.jsx(Nt,{orientation:"left",children:"Additional Vehicles"}),se.map((t,n)=>{const r=n+2,s=R?[]:An(t.company),i=R?[]:In(t.company,t.model),v=jn(t.emiSet||"12");return e.jsx("div",{style:{border:"1px dashed #d4d4d8",borderRadius:8,padding:12,marginBottom:12},children:e.jsxs(tn,{gutter:[12,8],align:"middle",children:[e.jsx(N,{span:24,children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("strong",{children:["Vehicle ",r]}),e.jsx(ie,{danger:!0,type:"text",icon:e.jsx(fa,{}),onClick:()=>$n(n),children:"Remove"})]})}),e.jsx(N,{xs:24,md:8,children:R?e.jsx(J,{placeholder:"Company",value:t.company,onChange:c=>we(n,{company:c.target.value})}):e.jsx(ke,{placeholder:"Select Company",value:t.company||void 0,options:Wt.map(c=>({value:c,label:c})),onChange:c=>we(n,{company:c})})}),e.jsx(N,{xs:24,md:8,children:R?e.jsx(J,{placeholder:"Model",value:t.model,onChange:c=>we(n,{model:c.target.value})}):e.jsx(ke,{placeholder:"Select Model",disabled:!t.company,value:t.model||void 0,options:s.map(c=>({value:c,label:c})),onChange:c=>we(n,{model:c})})}),e.jsx(N,{xs:24,md:8,children:R?e.jsx(J,{placeholder:"Variant",value:t.variant,onChange:c=>we(n,{variant:c.target.value})}):e.jsx(ke,{placeholder:"Select Variant",disabled:!t.model,value:t.variant||void 0,options:i.map(c=>({value:c,label:c})),onChange:c=>we(n,{variant:c})})}),e.jsx(N,{xs:24,md:12,children:e.jsx(ot,{style:{width:"100%"},placeholder:"On-Road Price (â‚¹)",value:t.onRoadPrice,readOnly:!R,onChange:c=>we(n,{onRoadPrice:Number(c||0)}),formatter:c=>`â‚¹ ${String(c??"0").replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,parser:c=>String(c||"0").replace(/[â‚¹,\s]/g,"")})}),V==="loan"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{xs:24,md:12,children:e.jsx(ot,{style:{width:"100%"},placeholder:"Down Payment (â‚¹)",min:0,max:t.onRoadPrice||0,step:1e3,value:t.downPayment||0,onChange:c=>we(n,{downPayment:Math.min(Number(c||0),t.onRoadPrice||0)}),formatter:c=>`â‚¹ ${String(c??"0").replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,parser:c=>String(c||"0").replace(/[â‚¹,\s]/g,"")})}),e.jsxs(N,{xs:24,children:[e.jsxs(_.Group,{value:t.emiSet||"12",onChange:c=>we(n,{emiSet:c.target.value}),style:{marginBottom:8},children:[e.jsx(_,{value:"12",children:"12"}),e.jsx(_,{value:"48",children:"48"})]}),e.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:v.map(c=>e.jsxs("div",{className:"emibox",style:{minWidth:140},children:[e.jsxs("div",{style:{fontWeight:700},children:[c," months"]}),e.jsx("div",{style:{fontWeight:900,fontSize:16},children:le(_e(t.onRoadPrice||0,t.downPayment||0,c))})]},c))})]})]})]})},n)}),e.jsx(ie,{icon:e.jsx(oa,{}),onClick:Mn,disabled:se.length>=3,children:"Add Vehicle"}),se.length>=3&&e.jsx("span",{style:{marginLeft:8,color:"#666"},children:"(Maximum 4 vehicles per quotation)"})]}),e.jsxs(N,{span:24,style:{textAlign:"right"},children:[e.jsx("div",{style:{marginBottom:8,textAlign:"left",color:"#888",fontSize:12},children:!St&&e.jsxs("span",{children:["Fill ",e.jsx("b",{children:"Branch"}),", ",e.jsx("b",{children:"Executive"}),", ",e.jsx("b",{children:"Customer Name"}),", ",e.jsx("b",{children:"Mobile"}),", and ",e.jsx("b",{children:"Vehicle Details"})," to proceed."]})}),e.jsx(ie,{className:"no-print",onClick:kn,disabled:!St||he||G>0,style:{marginRight:8,background:"#25D366",borderColor:"#25D366",color:"#fff"},children:"WhatsApp"}),e.jsx(ie,{className:"no-print",type:"primary",icon:e.jsx(na,{}),onClick:vt,disabled:!St||he||G>0||re,loading:re,children:"Print"})]})]})})]})}),e.jsx("div",{className:"print-sheet",children:e.jsx("div",{className:"page",ref:Bt,children:e.jsxs("div",{className:"sheet",children:[e.jsxs("div",{className:"hdr-line",children:[e.jsxs("div",{style:{textAlign:"center",marginRight:12},children:[e.jsx("img",{src:"/location-qr.png",alt:"Location QR",style:{height:50,objectFit:"contain"}}),e.jsx("div",{style:{fontSize:8,fontWeight:600,marginTop:4},children:"Scan for Location"})]}),e.jsx("div",{className:"hdr-title",children:e.jsx("div",{className:"quo-box",children:"QUOTATION"})}),e.jsxs("div",{className:"hdr-right",children:[e.jsxs("div",{children:["Sl. No.: ",a.getFieldValue("serialNo")||"-"]}),e.jsxs("div",{children:["Date: ",pn]})]})]}),e.jsx("div",{style:{borderBottom:"2px solid #000",paddingBottom:6,marginBottom:8},children:e.jsxs("div",{className:"brand-row2",style:{display:"grid",gridTemplateColumns:"1fr auto",columnGap:16,alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",gap:10,flexWrap:"wrap",marginBottom:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:o==="SHANTHA"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title-kn",style:{fontSize:"25pt",fontWeight:800},children:"à²¶à²¾à²‚à²¤ à²®à³‹à²Ÿà²°à³à²¸à³"}),e.jsx("div",{className:"title-en",style:{fontSize:"20pt",fontWeight:800},children:"Shantha Motors"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title-knhonda",style:{fontSize:"25pt",fontWeight:800},children:"à²Žà²¨à³ à²Žà²šà³ à²®à³‹à²Ÿà²°à³à²¸à³"}),e.jsx("div",{className:"title-en",style:{fontSize:"18pt",fontWeight:700},children:"NH Motors"})]})}),o==="SHANTHA"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"addr-line",style:{fontSize:"13pt"},children:"â€¢ Muddinapalya â€¢ Hegganahalli   â€¢ Nelagadrahalli  â€¢ Andrahalli"}),e.jsx("div",{className:"addr-line",style:{fontSize:"13pt"},children:"â€¢ Kadabagere   â€¢ Channenahali  â€¢ Tavarekere"}),e.jsx("div",{style:{marginTop:6,fontWeight:600},children:"Mob: 9731366921 / 8073283502 / 9035131806"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"addr-linehonda",style:{fontSize:"12pt"},children:"Site No. 116/1, Bydarahalli, Magadi Main Road, Opp. HP Petrol Bunk, Bangalore - 560091"}),e.jsx("div",{style:{marginTop:6,fontWeight:600},children:"Mob: 9731366921 / 8073283502 / 9741609799"})]})]}),e.jsx("div",{className:"brand-right",style:{display:"flex",flexDirection:"row",alignItems:"center",gap:16,justifyContent:"flex-end"},children:e.jsx("img",{src:o==="SHANTHA"?"/shantha-logoprint.jpg":"/honda-logo.png",alt:"Brand Logo",style:{height:130,objectFit:"contain"}})})]})}),e.jsxs("div",{className:"box",style:{marginBottom:8},children:[e.jsx("div",{className:"section-title",children:"Customer Details"}),e.jsxs("div",{className:"row2",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Name:"})," ",a.getFieldValue("name")||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Mobile:"})," ",a.getFieldValue("mobile")||"-"]}),e.jsxs("div",{style:{gridColumn:"1 / span 2"},children:[e.jsx("b",{children:"Address:"})," ",a.getFieldValue("address")||"-"]})]})]}),e.jsxs("div",{className:"box",style:{marginBottom:8},children:[e.jsx("div",{className:"section-title",children:"Vehicle 1 Details"}),e.jsxs("div",{className:"row3",style:{fontSize:"12pt"},children:[e.jsxs("div",{children:[e.jsx("b",{children:"Company:"})," ",f||a.getFieldValue("company")||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Model:"})," ",u||a.getFieldValue("bikeModel")||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Variant:"})," ",k||a.getFieldValue("variant")||"-"]})]}),e.jsx("div",{style:{marginTop:6,textAlign:"center"},children:e.jsxs("span",{className:"big-price",children:[e.jsxs("span",{children:[e.jsx("b",{children:"On-Road Price:"})," "]}),le(a.getFieldValue("onRoadPrice")??K??0)]})})]}),V==="loan"&&e.jsx("div",{className:"box",style:{marginBottom:8},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"0.5fr 2fr",gap:12,alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4,fontSize:"12pt"},children:"Down Payment"}),e.jsx("div",{style:{fontWeight:800,fontSize:"18pt"},children:le(oe||0)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:900,textAlign:"center",marginBottom:4,fontSize:"14pt"},children:"EMI DETAILS"}),e.jsx("div",{style:{display:"flex",gap:8,justifyContent:"space-between",flexWrap:"wrap"},children:ae.map(t=>e.jsxs("div",{className:"emibox",style:{flex:1,minWidth:120},children:[e.jsxs("div",{style:{fontWeight:700},children:[t," months"]}),e.jsx("div",{style:{fontWeight:900},children:le(_e(K,oe,t))})]},t))})]})]})}),se.map((t,n)=>{const r=n+2,s=(t.emiSet||"12")==="12"?[12,18,24,36]:[24,30,36,48];return e.jsxs("div",{children:[e.jsxs("div",{className:"box",style:{marginBottom:8},children:[e.jsxs("div",{className:"section-title",children:["Vehicle ",r," Details"]}),e.jsxs("div",{className:"row3",style:{fontSize:"12pt"},children:[e.jsxs("div",{children:[e.jsx("b",{children:"Company:"})," ",t.company||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Model:"})," ",t.model||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Variant:"})," ",t.variant||"-"]})]}),e.jsx("div",{style:{marginTop:6,textAlign:"center"},children:e.jsxs("span",{className:"big-price",children:[e.jsxs("span",{children:[e.jsx("b",{children:"On-Road Price:"})," "]}),le(t.onRoadPrice||0)]})})]}),V==="loan"&&e.jsx("div",{className:"box",style:{marginBottom:8},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"0.5fr 2fr",gap:12,alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4,fontSize:"12pt"},children:"Down Payment"}),e.jsx("div",{style:{fontWeight:800,fontSize:"18pt"},children:le(t.downPayment||0)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:900,textAlign:"center",marginBottom:4,fontSize:"14pt"},children:"EMI DETAILS"}),e.jsx("div",{style:{display:"flex",gap:8,justifyContent:"space-between",flexWrap:"wrap"},children:s.map(i=>e.jsxs("div",{className:"emibox",style:{minWidth:140},children:[e.jsxs("div",{style:{fontWeight:700},children:[i," months"]}),e.jsx("div",{style:{fontWeight:900},children:le(_e(t.onRoadPrice||0,t.downPayment||0,i))})]},i))})]})]})})]},n)}),e.jsxs("div",{className:"box",style:{marginBottom:8},children:[e.jsxs("div",{style:{marginBottom:6,fontSize:"13pt",fontWeight:700},children:[e.jsx("b",{children:"Executive name:"})," ",tt||"-",yt?` (${yt})`:""]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"0.6fr 1fr 1fr",gap:16,alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4},children:"Free Extra Fittings"}),e.jsx(Xt,{items:ue})]}),e.jsx("div",{style:{minHeight:120,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600},children:e.jsx("img",{src:"/shantha-access.png",alt:"Accessories",style:{height:140,margin:"6px 0"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4},children:"Documents Required"}),e.jsx(Xt,{items:be})]})]})]}),e.jsxs("div",{style:{fontSize:"9.5pt",display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{}),e.jsxs("div",{children:[e.jsx("b",{children:"Note:"})," Prices are indicative and subject to change without prior notice."]})]})]})})})]})}export{co as default};
