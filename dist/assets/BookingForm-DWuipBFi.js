import{r as c,R as ot,v as Vr,w as ka,j as n,u as Pa,G as $a,a as Oa}from"./index-DByWGH7d.js";import{C as Ea,A as Ra,s as rn,D as fr,a as hr,u as Xn,n as ft,l as gr,b as Ta}from"./caseInsensitive-GFj-Zur4.js";import{f as Fa,i as br,h as or,S as Ia,P as Ma}from"./PostServiceSheet-CYx6JQNX.js";import{L as yr,d as He}from"./index-53S8uf0A.js";import{B as ze}from"./button-BmMOSO5i.js";import{M as gn}from"./index-BSIb012r.js";import{S as qt}from"./index-DlPElhKY.js";import{R as yt,a as io,S as nt}from"./index-C2v3hDcT.js";import{S as Ba,I as vt,s as je}from"./index-mc3XMWnF.js";import{G as rr}from"./index-CINaf3Eu.js";import{C as Ht}from"./index-BP3wDuv0.js";import{m as lo,q as co,r as uo,u as Ye,S as Da,C as an,H as La,M as _a,U as za,y as Ur,f as Ne,V as Va,W as Ua,X as Wa,Y as Ha,Z as qa,$ as Ga,a0 as Ka,n as Wr,p as Hr,T as Gt,a1 as Xa,t as no,K as Ja,x as Ya,o as Za,a2 as Qa,j as hn,_ as zo,l as qr,c as Mt,a3 as Vo,a4 as Uo,G as es,O as Gr,a5 as ts,a6 as ns,I as In,a7 as os,a8 as Kt,a9 as Ge,v as $t,a as Kr,aa as Xr,d as Jr,e as _e,ab as qe,b as Yr,ac as Zr,L as Qr,ad as vr,ae as ea,af as rs,ag as as,ah as ss,R as xr,D as is,P as ls,Q as cs,B as Sr,z as Le,A as ge}from"./TextArea-BDVSLBQS.js";import{T as ta}from"./index-CBM7Jb_H.js";import{T as rt}from"./index-DMDeWAJZ.js";import{I as Ot}from"./AntdIcon-DqBt8ItB.js";import{R as ds,a as wr}from"./ThunderboltOutlined-BvFXYw4P.js";import{a as us,g as ms,F as V}from"./index-fiQTrVnU.js";import{R as ps}from"./CheckOutlined-BWW6_Ha2.js";import{F as fs}from"./Table-g31uHPfu.js";import{T as Ue}from"./index-eVJyXskz.js";import{C as hs}from"./index-Bbhzw47L.js";import{p as gs}from"./pickAttrs-DLhOEXIt.js";import{i as bs}from"./index-BQHoEo7h.js";import{D as ys,R as vs}from"./PrinterOutlined-De6aMjcs.js";import{R as xs}from"./EyeOutlined-DF4m-4HC.js";const Wo=c.createContext({}),Ss=e=>{const{antCls:t,componentCls:o,iconCls:r,avatarBg:d,avatarColor:i,containerSize:m,containerSizeLG:u,containerSizeSM:p,textFontSize:h,textFontSizeLG:y,textFontSizeSM:C,iconFontSize:T,iconFontSizeLG:S,iconFontSizeSM:M,borderRadius:w,borderRadiusLG:f,borderRadiusSM:I,lineWidth:E,lineType:j}=e,N=(v,H,$,q)=>({width:v,height:v,borderRadius:"50%",fontSize:H,[`&${o}-square`]:{borderRadius:q},[`&${o}-icon`]:{fontSize:$,[`> ${r}`]:{margin:0}}});return{[o]:Object.assign(Object.assign(Object.assign(Object.assign({},uo(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:i,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:d,border:`${Ye(E)} ${j} transparent`,"&-image":{background:"transparent"},[`${t}-image-img`]:{display:"block"}}),N(m,h,T,w)),{"&-lg":Object.assign({},N(u,y,S,f)),"&-sm":Object.assign({},N(p,C,M,I)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},ws=e=>{const{componentCls:t,groupBorderColor:o,groupOverlapping:r,groupSpace:d}=e;return{[`${t}-group`]:{display:"inline-flex",[t]:{borderColor:o},"> *:not(:first-child)":{marginInlineStart:r}},[`${t}-group-popover`]:{[`${t} + ${t}`]:{marginInlineStart:d}}}},js=e=>{const{controlHeight:t,controlHeightLG:o,controlHeightSM:r,fontSize:d,fontSizeLG:i,fontSizeXL:m,fontSizeHeading3:u,marginXS:p,marginXXS:h,colorBorderBg:y}=e;return{containerSize:t,containerSizeLG:o,containerSizeSM:r,textFontSize:d,textFontSizeLG:d,textFontSizeSM:d,iconFontSize:Math.round((i+m)/2),iconFontSizeLG:u,iconFontSizeSM:d,groupSpace:h,groupOverlapping:-p,groupBorderColor:y}},na=lo("Avatar",e=>{const{colorTextLightSolid:t,colorTextPlaceholder:o}=e,r=co(e,{avatarBg:o,avatarColor:t});return[Ss(r),ws(r)]},js);var Cs=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,r=Object.getOwnPropertySymbols(e);d<r.length;d++)t.indexOf(r[d])<0&&Object.prototype.propertyIsEnumerable.call(e,r[d])&&(o[r[d]]=e[r[d]]);return o};const oa=c.forwardRef((e,t)=>{const{prefixCls:o,shape:r,size:d,src:i,srcSet:m,icon:u,className:p,rootClassName:h,style:y,alt:C,draggable:T,children:S,crossOrigin:M,gap:w=4,onError:f}=e,I=Cs(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","style","alt","draggable","children","crossOrigin","gap","onError"]),[E,j]=c.useState(1),[N,v]=c.useState(!1),[H,$]=c.useState(!0),q=c.useRef(null),se=c.useRef(null),U=Da(t,q),{getPrefixCls:me,avatar:oe}=c.useContext(an),Y=c.useContext(Wo),R=()=>{if(!se.current||!q.current)return;const re=se.current.offsetWidth,le=q.current.offsetWidth;re!==0&&le!==0&&w*2<le&&j(le-w*2<re?(le-w*2)/re:1)};c.useEffect(()=>{v(!0)},[]),c.useEffect(()=>{$(!0),j(1)},[i]),c.useEffect(R,[w]);const k=()=>{f?.()!==!1&&$(!1)},B=La(re=>{var le,Ae;return(Ae=(le=d??Y?.size)!==null&&le!==void 0?le:re)!==null&&Ae!==void 0?Ae:"default"}),ne=Object.keys(typeof B=="object"?B||{}:{}).some(re=>["xs","sm","md","lg","xl","xxl"].includes(re)),ee=_a(ne),W=c.useMemo(()=>{if(typeof B!="object")return{};const re=za.find(Ae=>ee[Ae]),le=B[re];return le?{width:le,height:le,fontSize:le&&(u||S)?le/2:18}:{}},[ee,B]),Z=me("avatar",o),Q=Ur(Z),[te,_,ie]=na(Z,Q),ue=Ne({[`${Z}-lg`]:B==="large",[`${Z}-sm`]:B==="small"}),pe=c.isValidElement(i),ye=r||Y?.shape||"circle",fe=Ne(Z,ue,oe?.className,`${Z}-${ye}`,{[`${Z}-image`]:pe||i&&H,[`${Z}-icon`]:!!u},ie,Q,p,h,_),ve=typeof B=="number"?{width:B,height:B,fontSize:u?B/2:18}:{};let ke;if(typeof i=="string"&&H)ke=c.createElement("img",{src:i,draggable:T,srcSet:m,onError:k,alt:C,crossOrigin:M});else if(pe)ke=i;else if(u)ke=u;else if(N||E!==1){const re=`scale(${E})`,le={msTransform:re,WebkitTransform:re,transform:re};ke=c.createElement(Va,{onResize:R},c.createElement("span",{className:`${Z}-string`,ref:se,style:Object.assign({},le)},S))}else ke=c.createElement("span",{className:`${Z}-string`,style:{opacity:0},ref:se},S);return te(c.createElement("span",Object.assign({},I,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ve),W),oe?.style),y),className:fe,ref:U}),ke))}),oo=e=>e?typeof e=="function"?e():e:null,As=e=>{const{componentCls:t,popoverColor:o,titleMinWidth:r,fontWeightStrong:d,innerPadding:i,boxShadowSecondary:m,colorTextHeading:u,borderRadiusLG:p,zIndexPopup:h,titleMarginBottom:y,colorBgElevated:C,popoverBg:T,titleBorderBottom:S,innerContentPadding:M,titlePadding:w}=e;return[{[t]:Object.assign(Object.assign({},uo(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:h,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"--antd-arrow-background-color":C,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${t}-content`]:{position:"relative"},[`${t}-inner`]:{backgroundColor:T,backgroundClip:"padding-box",borderRadius:p,boxShadow:m,padding:i},[`${t}-title`]:{minWidth:r,marginBottom:y,color:u,fontWeight:d,borderBottom:S,padding:w},[`${t}-inner-content`]:{color:o,padding:M}})},Wa(e,"var(--antd-arrow-background-color)"),{[`${t}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",[`${t}-content`]:{display:"inline-block"}}}]},Ns=e=>{const{componentCls:t}=e;return{[t]:Ha.map(o=>{const r=e[`${o}6`];return{[`&${t}-${o}`]:{"--antd-arrow-background-color":r,[`${t}-inner`]:{backgroundColor:r},[`${t}-arrow`]:{background:"transparent"}}}})}},ks=e=>{const{lineWidth:t,controlHeight:o,fontHeight:r,padding:d,wireframe:i,zIndexPopupBase:m,borderRadiusLG:u,marginXS:p,lineType:h,colorSplit:y,paddingSM:C}=e,T=o-r,S=T/2,M=T/2-t,w=d;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:m+30},qa(e)),Ga({contentRadius:u,limitVerticalRadius:!0})),{innerPadding:i?0:12,titleMarginBottom:i?0:p,titlePadding:i?`${S}px ${w}px ${M}px`:0,titleBorderBottom:i?`${t}px ${h} ${y}`:"none",innerContentPadding:i?`${C}px ${w}px`:0})},ra=lo("Popover",e=>{const{colorBgElevated:t,colorText:o}=e,r=co(e,{popoverBg:t,popoverColor:o});return[As(r),Ns(r),Ua(r,"zoom-big")]},ks,{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var Ps=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,r=Object.getOwnPropertySymbols(e);d<r.length;d++)t.indexOf(r[d])<0&&Object.prototype.propertyIsEnumerable.call(e,r[d])&&(o[r[d]]=e[r[d]]);return o};const aa=({title:e,content:t,prefixCls:o})=>!e&&!t?null:c.createElement(c.Fragment,null,e&&c.createElement("div",{className:`${o}-title`},e),t&&c.createElement("div",{className:`${o}-inner-content`},t)),$s=e=>{const{hashId:t,prefixCls:o,className:r,style:d,placement:i="top",title:m,content:u,children:p}=e,h=oo(m),y=oo(u),C=Ne(t,o,`${o}-pure`,`${o}-placement-${i}`,r);return c.createElement("div",{className:C,style:d},c.createElement("div",{className:`${o}-arrow`}),c.createElement(Ka,Object.assign({},e,{className:t,prefixCls:o}),p||c.createElement(aa,{prefixCls:o,title:h,content:y})))},Os=e=>{const{prefixCls:t,className:o}=e,r=Ps(e,["prefixCls","className"]),{getPrefixCls:d}=c.useContext(an),i=d("popover",t),[m,u,p]=ra(i);return m(c.createElement($s,Object.assign({},r,{prefixCls:i,hashId:u,className:Ne(o,p)})))};var Es=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,r=Object.getOwnPropertySymbols(e);d<r.length;d++)t.indexOf(r[d])<0&&Object.prototype.propertyIsEnumerable.call(e,r[d])&&(o[r[d]]=e[r[d]]);return o};const Rs=c.forwardRef((e,t)=>{var o,r;const{prefixCls:d,title:i,content:m,overlayClassName:u,placement:p="top",trigger:h="hover",children:y,mouseEnterDelay:C=.1,mouseLeaveDelay:T=.1,onOpenChange:S,overlayStyle:M={},styles:w,classNames:f}=e,I=Es(e,["prefixCls","title","content","overlayClassName","placement","trigger","children","mouseEnterDelay","mouseLeaveDelay","onOpenChange","overlayStyle","styles","classNames"]),{getPrefixCls:E,className:j,style:N,classNames:v,styles:H}=Wr("popover"),$=E("popover",d),[q,se,U]=ra($),me=E(),oe=Ne(u,se,U,j,v.root,f?.root),Y=Ne(v.body,f?.body),[R,k]=Hr(!1,{value:(o=e.open)!==null&&o!==void 0?o:e.visible,defaultValue:(r=e.defaultOpen)!==null&&r!==void 0?r:e.defaultVisible}),B=(Q,te)=>{k(Q,!0),S?.(Q,te)},ne=Q=>{Q.keyCode===Ja.ESC&&B(!1,Q)},ee=Q=>{B(Q)},W=oo(i),Z=oo(m);return q(c.createElement(Gt,Object.assign({placement:p,trigger:h,mouseEnterDelay:C,mouseLeaveDelay:T},I,{prefixCls:$,classNames:{root:oe,body:Y},styles:{root:Object.assign(Object.assign(Object.assign(Object.assign({},H.root),N),M),w?.root),body:Object.assign(Object.assign({},H.body),w?.body)},ref:t,open:R,onOpenChange:ee,overlay:W||Z?c.createElement(aa,{prefixCls:$,title:W,content:Z}):null,transitionName:Xa(me,"zoom-big",I.transitionName),"data-popover-inject":!0}),no(y,{onKeyDown:Q=>{var te,_;c.isValidElement(y)&&((_=y==null?void 0:(te=y.props).onKeyDown)===null||_===void 0||_.call(te,Q)),ne(Q)}})))}),Tn=Rs;Tn._InternalPanelDoNotUseOrYouWillBeFired=Os;const jr=e=>{const{size:t,shape:o}=c.useContext(Wo),r=c.useMemo(()=>({size:e.size||t,shape:e.shape||o}),[e.size,e.shape,t,o]);return c.createElement(Wo.Provider,{value:r},e.children)},Ts=e=>{var t,o,r,d;const{getPrefixCls:i,direction:m}=c.useContext(an),{prefixCls:u,className:p,rootClassName:h,style:y,maxCount:C,maxStyle:T,size:S,shape:M,maxPopoverPlacement:w,maxPopoverTrigger:f,children:I,max:E}=e,j=i("avatar",u),N=`${j}-group`,v=Ur(j),[H,$,q]=na(j,v),se=Ne(N,{[`${N}-rtl`]:m==="rtl"},q,v,p,h,$),U=Ya(I).map((Y,R)=>no(Y,{key:`avatar-key-${R}`})),me=E?.count||C,oe=U.length;if(me&&me<oe){const Y=U.slice(0,me),R=U.slice(me,oe),k=E?.style||T,B=((t=E?.popover)===null||t===void 0?void 0:t.trigger)||f||"hover",ne=((o=E?.popover)===null||o===void 0?void 0:o.placement)||w||"top",ee=Object.assign(Object.assign({content:R},E?.popover),{classNames:{root:Ne(`${N}-popover`,(d=(r=E?.popover)===null||r===void 0?void 0:r.classNames)===null||d===void 0?void 0:d.root)},placement:ne,trigger:B});return Y.push(c.createElement(Tn,Object.assign({key:"avatar-popover-key",destroyOnHidden:!0},ee),c.createElement(oa,{style:k},`+${oe-me}`))),H(c.createElement(jr,{shape:M,size:S},c.createElement("div",{className:se,style:y},Y)))}return H(c.createElement(jr,{shape:M,size:S},c.createElement("div",{className:se,style:y},U)))},sa=oa;sa.Group=Ts;var Fs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},Is={percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1,gapPosition:"bottom"},Ms=function(){var t=c.useRef([]),o=c.useRef(null);return c.useEffect(function(){var r=Date.now(),d=!1;t.current.forEach(function(i){if(i){d=!0;var m=i.style;m.transitionDuration=".3s, .3s, .3s, .06s",o.current&&r-o.current<100&&(m.transitionDuration="0s, 0s")}}),d&&(o.current=Date.now())}),t.current},Cr=0,Bs=Qa();function Ds(){var e;return Bs?(e=Cr,Cr+=1):e="TEST_OR_SSR",e}const Ls=function(e){var t=c.useState(),o=Za(t,2),r=o[0],d=o[1];return c.useEffect(function(){d("rc_progress_".concat(Ds()))},[]),e||r};var Ar=function(t){var o=t.bg,r=t.children;return c.createElement("div",{style:{width:"100%",height:"100%",background:o}},r)};function Nr(e,t){return Object.keys(e).map(function(o){var r=parseFloat(o),d="".concat(Math.floor(r*t),"%");return"".concat(e[o]," ").concat(d)})}var _s=c.forwardRef(function(e,t){var o=e.prefixCls,r=e.color,d=e.gradientId,i=e.radius,m=e.style,u=e.ptg,p=e.strokeLinecap,h=e.strokeWidth,y=e.size,C=e.gapDegree,T=r&&hn(r)==="object",S=T?"#FFF":void 0,M=y/2,w=c.createElement("circle",{className:"".concat(o,"-circle-path"),r:i,cx:M,cy:M,stroke:S,strokeLinecap:p,strokeWidth:h,opacity:u===0?0:1,style:m,ref:t});if(!T)return w;var f="".concat(d,"-conic"),I=C?"".concat(180+C/2,"deg"):"0deg",E=Nr(r,(360-C)/360),j=Nr(r,1),N="conic-gradient(from ".concat(I,", ").concat(E.join(", "),")"),v="linear-gradient(to ".concat(C?"bottom":"top",", ").concat(j.join(", "),")");return c.createElement(c.Fragment,null,c.createElement("mask",{id:f},w),c.createElement("foreignObject",{x:0,y:0,width:y,height:y,mask:"url(#".concat(f,")")},c.createElement(Ar,{bg:v},c.createElement(Ar,{bg:N}))))}),En=100,To=function(t,o,r,d,i,m,u,p,h,y){var C=arguments.length>10&&arguments[10]!==void 0?arguments[10]:0,T=r/100*360*((360-m)/360),S=m===0?0:{bottom:0,top:180,left:90,right:-90}[u],M=(100-d)/100*o;h==="round"&&d!==100&&(M+=y/2,M>=o&&(M=o-.01));var w=En/2;return{stroke:typeof p=="string"?p:void 0,strokeDasharray:"".concat(o,"px ").concat(t),strokeDashoffset:M+C,transform:"rotate(".concat(i+T+S,"deg)"),transformOrigin:"".concat(w,"px ").concat(w,"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s",fillOpacity:0}},zs=["id","prefixCls","steps","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"];function kr(e){var t=e??[];return Array.isArray(t)?t:[t]}var Vs=function(t){var o=zo(zo({},Is),t),r=o.id,d=o.prefixCls,i=o.steps,m=o.strokeWidth,u=o.trailWidth,p=o.gapDegree,h=p===void 0?0:p,y=o.gapPosition,C=o.trailColor,T=o.strokeLinecap,S=o.style,M=o.className,w=o.strokeColor,f=o.percent,I=qr(o,zs),E=En/2,j=Ls(r),N="".concat(j,"-gradient"),v=E-m/2,H=Math.PI*2*v,$=h>0?90+h/2:-90,q=H*((360-h)/360),se=hn(i)==="object"?i:{count:i,gap:2},U=se.count,me=se.gap,oe=kr(f),Y=kr(w),R=Y.find(function(Q){return Q&&hn(Q)==="object"}),k=R&&hn(R)==="object",B=k?"butt":T,ne=To(H,q,0,100,$,h,y,C,B,m),ee=Ms(),W=function(){var te=0;return oe.map(function(_,ie){var ue=Y[ie]||Y[Y.length-1],pe=To(H,q,te,_,$,h,y,ue,B,m);return te+=_,c.createElement(_s,{key:ie,color:ue,ptg:_,radius:v,prefixCls:d,gradientId:N,style:pe,strokeLinecap:B,strokeWidth:m,gapDegree:h,ref:function(fe){ee[ie]=fe},size:En})}).reverse()},Z=function(){var te=Math.round(U*(oe[0]/100)),_=100/U,ie=0;return new Array(U).fill(null).map(function(ue,pe){var ye=pe<=te-1?Y[0]:C,fe=ye&&hn(ye)==="object"?"url(#".concat(N,")"):void 0,ve=To(H,q,ie,_,$,h,y,ye,"butt",m,me);return ie+=(q-ve.strokeDashoffset+me)*100/q,c.createElement("circle",{key:pe,className:"".concat(d,"-circle-path"),r:v,cx:E,cy:E,stroke:fe,strokeWidth:m,opacity:1,style:ve,ref:function(re){ee[pe]=re}})})};return c.createElement("svg",Mt({className:Ne("".concat(d,"-circle"),M),viewBox:"0 0 ".concat(En," ").concat(En),style:S,id:r,role:"presentation"},I),!U&&c.createElement("circle",{className:"".concat(d,"-circle-trail"),r:v,cx:E,cy:E,stroke:C,strokeLinecap:B,strokeWidth:u||m,style:ne}),U?Z():W())};function Xt(e){return!e||e<0?0:e>100?100:e}function ro({success:e,successPercent:t}){let o=t;return e&&"progress"in e&&(o=e.progress),e&&"percent"in e&&(o=e.percent),o}const Us=({percent:e,success:t,successPercent:o})=>{const r=Xt(ro({success:t,successPercent:o}));return[r,Xt(Xt(e)-r)]},Ws=({success:e={},strokeColor:t})=>{const{strokeColor:o}=e;return[o||Vo.green,t||null]},mo=(e,t,o)=>{var r,d,i,m;let u=-1,p=-1;if(t==="step"){const h=o.steps,y=o.strokeWidth;typeof e=="string"||typeof e>"u"?(u=e==="small"?2:14,p=y??8):typeof e=="number"?[u,p]=[e,e]:[u=14,p=8]=Array.isArray(e)?e:[e.width,e.height],u*=h}else if(t==="line"){const h=o?.strokeWidth;typeof e=="string"||typeof e>"u"?p=h||(e==="small"?6:8):typeof e=="number"?[u,p]=[e,e]:[u=-1,p=8]=Array.isArray(e)?e:[e.width,e.height]}else(t==="circle"||t==="dashboard")&&(typeof e=="string"||typeof e>"u"?[u,p]=e==="small"?[60,60]:[120,120]:typeof e=="number"?[u,p]=[e,e]:Array.isArray(e)&&(u=(d=(r=e[0])!==null&&r!==void 0?r:e[1])!==null&&d!==void 0?d:120,p=(m=(i=e[0])!==null&&i!==void 0?i:e[1])!==null&&m!==void 0?m:120));return[u,p]},Hs=3,qs=e=>Hs/e*100,Gs=e=>{const{prefixCls:t,trailColor:o=null,strokeLinecap:r="round",gapPosition:d,gapDegree:i,width:m=120,type:u,children:p,success:h,size:y=m,steps:C}=e,[T,S]=mo(y,"circle");let{strokeWidth:M}=e;M===void 0&&(M=Math.max(qs(T),6));const w={width:T,height:S,fontSize:T*.15+6},f=c.useMemo(()=>{if(i||i===0)return i;if(u==="dashboard")return 75},[i,u]),I=Us(e),E=d||u==="dashboard"&&"bottom"||void 0,j=Object.prototype.toString.call(e.strokeColor)==="[object Object]",N=Ws({success:h,strokeColor:e.strokeColor}),v=Ne(`${t}-inner`,{[`${t}-circle-gradient`]:j}),H=c.createElement(Vs,{steps:C,percent:C?I[1]:I,strokeWidth:M,trailWidth:M,strokeColor:C?N[1]:N,strokeLinecap:r,trailColor:o,prefixCls:t,gapDegree:f,gapPosition:E}),$=T<=20,q=c.createElement("div",{className:v,style:w},H,!$&&p);return $?c.createElement(Gt,{title:p},q):q},ao="--progress-line-stroke-color",ia="--progress-percent",Pr=e=>{const t=e?"100%":"-100%";return new Uo(`antProgress${e?"RTL":"LTR"}Active`,{"0%":{transform:`translateX(${t}) scaleX(0)`,opacity:.1},"20%":{transform:`translateX(${t}) scaleX(0)`,opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}})},Ks=e=>{const{componentCls:t,iconCls:o}=e;return{[t]:Object.assign(Object.assign({},uo(e)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:e.fontSize},[`${t}-outer`]:{display:"inline-flex",alignItems:"center",width:"100%"},[`${t}-inner`]:{position:"relative",display:"inline-block",width:"100%",flex:1,overflow:"hidden",verticalAlign:"middle",backgroundColor:e.remainingColor,borderRadius:e.lineBorderRadius},[`${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.defaultColor}},[`${t}-success-bg, ${t}-bg`]:{position:"relative",background:e.defaultColor,borderRadius:e.lineBorderRadius,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`},[`${t}-layout-bottom`]:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",[`${t}-text`]:{width:"max-content",marginInlineStart:0,marginTop:e.marginXXS}},[`${t}-bg`]:{overflow:"hidden","&::after":{content:'""',background:{_multi_value_:!0,value:["inherit",`var(${ao})`]},height:"100%",width:`calc(1 / var(${ia}) * 100%)`,display:"block"},[`&${t}-bg-inner`]:{minWidth:"max-content","&::after":{content:"none"},[`${t}-text-inner`]:{color:e.colorWhite,[`&${t}-text-bright`]:{color:"rgba(0, 0, 0, 0.45)"}}}},[`${t}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:e.colorSuccess},[`${t}-text`]:{display:"inline-block",marginInlineStart:e.marginXS,color:e.colorText,lineHeight:1,width:"2em",whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[o]:{fontSize:e.fontSize},[`&${t}-text-outer`]:{width:"max-content"},[`&${t}-text-outer${t}-text-start`]:{width:"max-content",marginInlineStart:0,marginInlineEnd:e.marginXS}},[`${t}-text-inner`]:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",marginInlineStart:0,padding:`0 ${Ye(e.paddingXXS)}`,[`&${t}-text-start`]:{justifyContent:"start"},[`&${t}-text-end`]:{justifyContent:"end"}},[`&${t}-status-active`]:{[`${t}-bg::before`]:{position:"absolute",inset:0,backgroundColor:e.colorBgContainer,borderRadius:e.lineBorderRadius,opacity:0,animationName:Pr(),animationDuration:e.progressActiveMotionDuration,animationTimingFunction:e.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${t}-rtl${t}-status-active`]:{[`${t}-bg::before`]:{animationName:Pr(!0)}},[`&${t}-status-exception`]:{[`${t}-bg`]:{backgroundColor:e.colorError},[`${t}-text`]:{color:e.colorError}},[`&${t}-status-exception ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorError}},[`&${t}-status-success`]:{[`${t}-bg`]:{backgroundColor:e.colorSuccess},[`${t}-text`]:{color:e.colorSuccess}},[`&${t}-status-success ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorSuccess}}})}},Xs=e=>{const{componentCls:t,iconCls:o}=e;return{[t]:{[`${t}-circle-trail`]:{stroke:e.remainingColor},[`&${t}-circle ${t}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${t}-circle ${t}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:e.circleTextColor,fontSize:e.circleTextFontSize,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[o]:{fontSize:e.circleIconFontSize}},[`${t}-circle&-status-exception`]:{[`${t}-text`]:{color:e.colorError}},[`${t}-circle&-status-success`]:{[`${t}-text`]:{color:e.colorSuccess}}},[`${t}-inline-circle`]:{lineHeight:1,[`${t}-inner`]:{verticalAlign:"bottom"}}}},Js=e=>{const{componentCls:t}=e;return{[t]:{[`${t}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:e.progressStepMinWidth,marginInlineEnd:e.progressStepMarginInlineEnd,backgroundColor:e.remainingColor,transition:`all ${e.motionDurationSlow}`,"&-active":{backgroundColor:e.defaultColor}}}}}},Ys=e=>{const{componentCls:t,iconCls:o}=e;return{[t]:{[`${t}-small&-line, ${t}-small&-line ${t}-text ${o}`]:{fontSize:e.fontSizeSM}}}},Zs=e=>({circleTextColor:e.colorText,defaultColor:e.colorInfo,remainingColor:e.colorFillSecondary,lineBorderRadius:100,circleTextFontSize:"1em",circleIconFontSize:`${e.fontSize/e.fontSizeSM}em`}),Qs=lo("Progress",e=>{const t=e.calc(e.marginXXS).div(2).equal(),o=co(e,{progressStepMarginInlineEnd:t,progressStepMinWidth:t,progressActiveMotionDuration:"2.4s"});return[Ks(o),Xs(o),Js(o),Ys(o)]},Zs);var ei=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,r=Object.getOwnPropertySymbols(e);d<r.length;d++)t.indexOf(r[d])<0&&Object.prototype.propertyIsEnumerable.call(e,r[d])&&(o[r[d]]=e[r[d]]);return o};const ti=e=>{let t=[];return Object.keys(e).forEach(o=>{const r=parseFloat(o.replace(/%/g,""));Number.isNaN(r)||t.push({key:r,value:e[o]})}),t=t.sort((o,r)=>o.key-r.key),t.map(({key:o,value:r})=>`${r} ${o}%`).join(", ")},ni=(e,t)=>{const{from:o=Vo.blue,to:r=Vo.blue,direction:d=t==="rtl"?"to left":"to right"}=e,i=ei(e,["from","to","direction"]);if(Object.keys(i).length!==0){const u=ti(i),p=`linear-gradient(${d}, ${u})`;return{background:p,[ao]:p}}const m=`linear-gradient(${d}, ${o}, ${r})`;return{background:m,[ao]:m}},oi=e=>{const{prefixCls:t,direction:o,percent:r,size:d,strokeWidth:i,strokeColor:m,strokeLinecap:u="round",children:p,trailColor:h=null,percentPosition:y,success:C}=e,{align:T,type:S}=y,M=m&&typeof m!="string"?ni(m,o):{[ao]:m,background:m},w=u==="square"||u==="butt"?0:void 0,f=d??[-1,i||(d==="small"?6:8)],[I,E]=mo(f,"line",{strokeWidth:i}),j={backgroundColor:h||void 0,borderRadius:w},N=Object.assign(Object.assign({width:`${Xt(r)}%`,height:E,borderRadius:w},M),{[ia]:Xt(r)/100}),v=ro(e),H={width:`${Xt(v)}%`,height:E,borderRadius:w,backgroundColor:C?.strokeColor},$={width:I<0?"100%":I},q=c.createElement("div",{className:`${t}-inner`,style:j},c.createElement("div",{className:Ne(`${t}-bg`,`${t}-bg-${S}`),style:N},S==="inner"&&p),v!==void 0&&c.createElement("div",{className:`${t}-success-bg`,style:H})),se=S==="outer"&&T==="start",U=S==="outer"&&T==="end";return S==="outer"&&T==="center"?c.createElement("div",{className:`${t}-layout-bottom`},q,p):c.createElement("div",{className:`${t}-outer`,style:$},se&&p,q,U&&p)},ri=e=>{const{size:t,steps:o,rounding:r=Math.round,percent:d=0,strokeWidth:i=8,strokeColor:m,trailColor:u=null,prefixCls:p,children:h}=e,y=r(o*(d/100)),T=t??[t==="small"?2:14,i],[S,M]=mo(T,"step",{steps:o,strokeWidth:i}),w=S/o,f=Array.from({length:o});for(let I=0;I<o;I++){const E=Array.isArray(m)?m[I]:m;f[I]=c.createElement("div",{key:I,className:Ne(`${p}-steps-item`,{[`${p}-steps-item-active`]:I<=y-1}),style:{backgroundColor:I<=y-1?E:u,width:w,height:M}})}return c.createElement("div",{className:`${p}-steps-outer`},f,h)};var ai=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,r=Object.getOwnPropertySymbols(e);d<r.length;d++)t.indexOf(r[d])<0&&Object.prototype.propertyIsEnumerable.call(e,r[d])&&(o[r[d]]=e[r[d]]);return o};const si=["normal","exception","active","success"],la=c.forwardRef((e,t)=>{const{prefixCls:o,className:r,rootClassName:d,steps:i,strokeColor:m,percent:u=0,size:p="default",showInfo:h=!0,type:y="line",status:C,format:T,style:S,percentPosition:M={}}=e,w=ai(e,["prefixCls","className","rootClassName","steps","strokeColor","percent","size","showInfo","type","status","format","style","percentPosition"]),{align:f="end",type:I="outer"}=M,E=Array.isArray(m)?m[0]:m,j=typeof m=="string"||Array.isArray(m)?m:void 0,N=c.useMemo(()=>{if(E){const W=typeof E=="string"?E:Object.values(E)[0];return new es(W).isLight()}return!1},[m]),v=c.useMemo(()=>{var W,Z;const Q=ro(e);return parseInt(Q!==void 0?(W=Q??0)===null||W===void 0?void 0:W.toString():(Z=u??0)===null||Z===void 0?void 0:Z.toString(),10)},[u,e.success,e.successPercent]),H=c.useMemo(()=>!si.includes(C)&&v>=100?"success":C||"normal",[C,v]),{getPrefixCls:$,direction:q,progress:se}=c.useContext(an),U=$("progress",o),[me,oe,Y]=Qs(U),R=y==="line",k=R&&!i,B=c.useMemo(()=>{if(!h)return null;const W=ro(e);let Z;const Q=T||(_=>`${_}%`),te=R&&N&&I==="inner";return I==="inner"||T||H!=="exception"&&H!=="success"?Z=Q(Xt(u),Xt(W)):H==="exception"?Z=R?c.createElement(ts,null):c.createElement(ns,null):H==="success"&&(Z=R?c.createElement(us,null):c.createElement(ps,null)),c.createElement("span",{className:Ne(`${U}-text`,{[`${U}-text-bright`]:te,[`${U}-text-${f}`]:k,[`${U}-text-${I}`]:k}),title:typeof Z=="string"?Z:void 0},Z)},[h,u,v,H,y,U,T]);let ne;y==="line"?ne=i?c.createElement(ri,Object.assign({},e,{strokeColor:j,prefixCls:U,steps:typeof i=="object"?i.count:i}),B):c.createElement(oi,Object.assign({},e,{strokeColor:E,prefixCls:U,direction:q,percentPosition:{align:f,type:I}}),B):(y==="circle"||y==="dashboard")&&(ne=c.createElement(Gs,Object.assign({},e,{strokeColor:E,prefixCls:U,progressStatus:H}),B));const ee=Ne(U,`${U}-status-${H}`,{[`${U}-${y==="dashboard"&&"circle"||y}`]:y!=="line",[`${U}-inline-circle`]:y==="circle"&&mo(p,"circle")[0]<=20,[`${U}-line`]:k,[`${U}-line-align-${f}`]:k,[`${U}-line-position-${I}`]:k,[`${U}-steps`]:i,[`${U}-show-info`]:h,[`${U}-${p}`]:typeof p=="string",[`${U}-rtl`]:q==="rtl"},se?.className,r,d,oe,Y);return me(c.createElement("div",Object.assign({ref:t,style:Object.assign(Object.assign({},se?.style),S),className:ee,role:"progressbar","aria-valuenow":v,"aria-valuemin":0,"aria-valuemax":100},Gr(w,["trailColor","strokeWidth","width","gapDegree","gapPosition","strokeLinecap","success","successPercent"])),ne))});var ii={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-792 72h752v120H136V232zm752 560H136V440h752v352zm-237-64h165c4.4 0 8-3.6 8-8v-72c0-4.4-3.6-8-8-8H651c-4.4 0-8 3.6-8 8v72c0 4.4 3.6 8 8 8z"}}]},name:"credit-card",theme:"outlined"},li=function(t,o){return c.createElement(In,Mt({},t,{ref:o,icon:ys}))},ci=c.forwardRef(li),di={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},ui=function(t,o){return c.createElement(In,Mt({},t,{ref:o,icon:di}))},mi=c.forwardRef(ui),pi={icon:function(t,o){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M534 352V136H232v752h560V394H576a42 42 0 01-42-42z",fill:o}},{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM602 137.8L790.2 326H602V137.8zM792 888H232V136h302v216a42 42 0 0042 42h216v494z",fill:t}}]}},name:"file",theme:"twotone"},fi=function(t,o){return c.createElement(In,Mt({},t,{ref:o,icon:pi}))},hi=c.forwardRef(fi),gi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"},bi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},yi={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},vi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},xi=function(t,o){return c.createElement(In,Mt({},t,{ref:o,icon:vi}))},Si=c.forwardRef(xi),wi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"},ji={icon:function(t,o){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z",fill:t}},{tag:"path",attrs:{d:"M424.6 765.8l-150.1-178L136 752.1V792h752v-30.4L658.1 489z",fill:o}},{tag:"path",attrs:{d:"M136 652.7l132.4-157c3.2-3.8 9-3.8 12.2 0l144 170.7L652 396.8c3.2-3.8 9-3.8 12.2 0L888 662.2V232H136v420.7zM304 280a88 88 0 110 176 88 88 0 010-176z",fill:o}},{tag:"path",attrs:{d:"M276 368a28 28 0 1056 0 28 28 0 10-56 0z",fill:o}},{tag:"path",attrs:{d:"M304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z",fill:t}}]}},name:"picture",theme:"twotone"},Ci=function(t,o){return c.createElement(In,Mt({},t,{ref:o,icon:ji}))},Ai=c.forwardRef(Ci),Ni={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},ki={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M882 272.1V144c0-17.7-14.3-32-32-32H174c-17.7 0-32 14.3-32 32v128.1c-16.7 1-30 14.9-30 31.9v131.7a177 177 0 0014.4 70.4c4.3 10.2 9.6 19.8 15.6 28.9v345c0 17.6 14.3 32 32 32h676c17.7 0 32-14.3 32-32V535a175 175 0 0015.6-28.9c9.5-22.3 14.4-46 14.4-70.4V304c0-17-13.3-30.9-30-31.9zM214 184h596v88H214v-88zm362 656.1H448V736h128v104.1zm234 0H640V704c0-17.7-14.3-32-32-32H416c-17.7 0-32 14.3-32 32v136.1H214V597.9c2.9 1.4 5.9 2.8 9 4 22.3 9.4 46 14.1 70.4 14.1s48-4.7 70.4-14.1c13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 3-1.3 6-2.6 9-4v242.2zm30-404.4c0 59.8-49 108.3-109.3 108.3-40.8 0-76.4-22.1-95.2-54.9-2.9-5-8.1-8.1-13.9-8.1h-.6c-5.7 0-11 3.1-13.9 8.1A109.24 109.24 0 01512 544c-40.7 0-76.2-22-95-54.7-3-5.1-8.4-8.3-14.3-8.3s-11.4 3.2-14.3 8.3a109.63 109.63 0 01-95.1 54.7C233 544 184 495.5 184 435.7v-91.2c0-.3.2-.5.5-.5h655c.3 0 .5.2.5.5v91.2z"}}]},name:"shop",theme:"outlined"};const Fo=function(e,t){if(e&&t){var o=Array.isArray(t)?t:t.split(","),r=e.name||"",d=e.type||"",i=d.replace(/\/.*$/,"");return o.some(function(m){var u=m.trim();if(/^\*(\/\*)?$/.test(m))return!0;if(u.charAt(0)==="."){var p=r.toLowerCase(),h=u.toLowerCase(),y=[h];return(h===".jpg"||h===".jpeg")&&(y=[".jpg",".jpeg"]),y.some(function(C){return p.endsWith(C)})}return/\/\*$/.test(u)?i===u.replace(/\/.*$/,""):d===u?!0:/^\w+$/.test(u)?(os(!1,"Upload takes an invalidate 'accept' type '".concat(u,"'.Skip for check.")),!0):!1})}return!0};function Pi(e,t){var o="cannot ".concat(e.method," ").concat(e.action," ").concat(t.status,"'"),r=new Error(o);return r.status=t.status,r.method=e.method,r.url=e.action,r}function $r(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}function $i(e){var t=new XMLHttpRequest;e.onProgress&&t.upload&&(t.upload.onprogress=function(i){i.total>0&&(i.percent=i.loaded/i.total*100),e.onProgress(i)});var o=new FormData;e.data&&Object.keys(e.data).forEach(function(d){var i=e.data[d];if(Array.isArray(i)){i.forEach(function(m){o.append("".concat(d,"[]"),m)});return}o.append(d,i)}),e.file instanceof Blob?o.append(e.filename,e.file,e.file.name):o.append(e.filename,e.file),t.onerror=function(i){e.onError(i)},t.onload=function(){return t.status<200||t.status>=300?e.onError(Pi(e,t),$r(t)):e.onSuccess($r(t),t)},t.open(e.method,e.action,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var r=e.headers||{};return r["X-Requested-With"]!==null&&t.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(r).forEach(function(d){r[d]!==null&&t.setRequestHeader(d,r[d])}),t.send(o),{abort:function(){t.abort()}}}var Oi=function(){var e=Kt(Ge().mark(function t(o,r){var d,i,m,u,p,h,y,C;return Ge().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:h=function(){return h=Kt(Ge().mark(function w(f){return Ge().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",new Promise(function(j){f.file(function(N){r(N)?(f.fullPath&&!N.webkitRelativePath&&(Object.defineProperties(N,{webkitRelativePath:{writable:!0}}),N.webkitRelativePath=f.fullPath.replace(/^\//,""),Object.defineProperties(N,{webkitRelativePath:{writable:!1}})),j(N)):j(null)})}));case 1:case"end":return E.stop()}},w)})),h.apply(this,arguments)},p=function(w){return h.apply(this,arguments)},u=function(){return u=Kt(Ge().mark(function w(f){var I,E,j,N,v;return Ge().wrap(function($){for(;;)switch($.prev=$.next){case 0:I=f.createReader(),E=[];case 2:return $.next=5,new Promise(function(q){I.readEntries(q,function(){return q([])})});case 5:if(j=$.sent,N=j.length,N){$.next=9;break}return $.abrupt("break",12);case 9:for(v=0;v<N;v++)E.push(j[v]);$.next=2;break;case 12:return $.abrupt("return",E);case 13:case"end":return $.stop()}},w)})),u.apply(this,arguments)},m=function(w){return u.apply(this,arguments)},d=[],i=[],o.forEach(function(M){return i.push(M.webkitGetAsEntry())}),y=function(){var M=Kt(Ge().mark(function w(f,I){var E,j;return Ge().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(f){v.next=2;break}return v.abrupt("return");case 2:if(f.path=I||"",!f.isFile){v.next=10;break}return v.next=6,p(f);case 6:E=v.sent,E&&d.push(E),v.next=15;break;case 10:if(!f.isDirectory){v.next=15;break}return v.next=13,m(f);case 13:j=v.sent,i.push.apply(i,$t(j));case 15:case"end":return v.stop()}},w)}));return function(f,I){return M.apply(this,arguments)}}(),C=0;case 9:if(!(C<i.length)){S.next=15;break}return S.next=12,y(i[C]);case 12:C++,S.next=9;break;case 15:return S.abrupt("return",d);case 16:case"end":return S.stop()}},t)}));return function(o,r){return e.apply(this,arguments)}}(),Ei=+new Date,Ri=0;function Io(){return"rc-upload-".concat(Ei,"-").concat(++Ri)}var Ti=["component","prefixCls","className","classNames","disabled","id","name","style","styles","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave","hasControlInside"],Fi=function(e){Kr(o,e);var t=Xr(o);function o(){var r;Jr(this,o);for(var d=arguments.length,i=new Array(d),m=0;m<d;m++)i[m]=arguments[m];return r=t.call.apply(t,[this].concat(i)),_e(qe(r),"state",{uid:Io()}),_e(qe(r),"reqs",{}),_e(qe(r),"fileInput",void 0),_e(qe(r),"_isMounted",void 0),_e(qe(r),"onChange",function(u){var p=r.props,h=p.accept,y=p.directory,C=u.target.files,T=$t(C).filter(function(S){return!y||Fo(S,h)});r.uploadFiles(T),r.reset()}),_e(qe(r),"onClick",function(u){var p=r.fileInput;if(p){var h=u.target,y=r.props.onClick;if(h&&h.tagName==="BUTTON"){var C=p.parentNode;C.focus(),h.blur()}p.click(),y&&y(u)}}),_e(qe(r),"onKeyDown",function(u){u.key==="Enter"&&r.onClick(u)}),_e(qe(r),"onDataTransferFiles",function(){var u=Kt(Ge().mark(function p(h,y){var C,T,S,M,w,f,I;return Ge().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(C=r.props,T=C.multiple,S=C.accept,M=C.directory,w=$t(h.items||[]),f=$t(h.files||[]),(f.length>0||w.some(function(N){return N.kind==="file"}))&&y?.(),!M){j.next=11;break}return j.next=7,Oi(Array.prototype.slice.call(w),function(N){return Fo(N,r.props.accept)});case 7:f=j.sent,r.uploadFiles(f),j.next=14;break;case 11:I=$t(f).filter(function(N){return Fo(N,S)}),T===!1&&(I=f.slice(0,1)),r.uploadFiles(I);case 14:case"end":return j.stop()}},p)}));return function(p,h){return u.apply(this,arguments)}}()),_e(qe(r),"onFilePaste",function(){var u=Kt(Ge().mark(function p(h){var y,C;return Ge().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(y=r.props.pastable,y){S.next=3;break}return S.abrupt("return");case 3:if(h.type!=="paste"){S.next=6;break}return C=h.clipboardData,S.abrupt("return",r.onDataTransferFiles(C,function(){h.preventDefault()}));case 6:case"end":return S.stop()}},p)}));return function(p){return u.apply(this,arguments)}}()),_e(qe(r),"onFileDragOver",function(u){u.preventDefault()}),_e(qe(r),"onFileDrop",function(){var u=Kt(Ge().mark(function p(h){var y;return Ge().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(h.preventDefault(),h.type!=="drop"){T.next=4;break}return y=h.dataTransfer,T.abrupt("return",r.onDataTransferFiles(y));case 4:case"end":return T.stop()}},p)}));return function(p){return u.apply(this,arguments)}}()),_e(qe(r),"uploadFiles",function(u){var p=$t(u),h=p.map(function(y){return y.uid=Io(),r.processFile(y,p)});Promise.all(h).then(function(y){var C=r.props.onBatchStart;C?.(y.map(function(T){var S=T.origin,M=T.parsedFile;return{file:S,parsedFile:M}})),y.filter(function(T){return T.parsedFile!==null}).forEach(function(T){r.post(T)})})}),_e(qe(r),"processFile",function(){var u=Kt(Ge().mark(function p(h,y){var C,T,S,M,w,f,I,E,j;return Ge().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(C=r.props.beforeUpload,T=h,!C){v.next=14;break}return v.prev=3,v.next=6,C(h,y);case 6:T=v.sent,v.next=12;break;case 9:v.prev=9,v.t0=v.catch(3),T=!1;case 12:if(T!==!1){v.next=14;break}return v.abrupt("return",{origin:h,parsedFile:null,action:null,data:null});case 14:if(S=r.props.action,typeof S!="function"){v.next=21;break}return v.next=18,S(h);case 18:M=v.sent,v.next=22;break;case 21:M=S;case 22:if(w=r.props.data,typeof w!="function"){v.next=29;break}return v.next=26,w(h);case 26:f=v.sent,v.next=30;break;case 29:f=w;case 30:return I=(hn(T)==="object"||typeof T=="string")&&T?T:h,I instanceof File?E=I:E=new File([I],h.name,{type:h.type}),j=E,j.uid=h.uid,v.abrupt("return",{origin:h,data:f,parsedFile:j,action:M});case 35:case"end":return v.stop()}},p,null,[[3,9]])}));return function(p,h){return u.apply(this,arguments)}}()),_e(qe(r),"saveFileInput",function(u){r.fileInput=u}),r}return Yr(o,[{key:"componentDidMount",value:function(){this._isMounted=!0;var d=this.props.pastable;d&&document.addEventListener("paste",this.onFilePaste)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort(),document.removeEventListener("paste",this.onFilePaste)}},{key:"componentDidUpdate",value:function(d){var i=this.props.pastable;i&&!d.pastable?document.addEventListener("paste",this.onFilePaste):!i&&d.pastable&&document.removeEventListener("paste",this.onFilePaste)}},{key:"post",value:function(d){var i=this,m=d.data,u=d.origin,p=d.action,h=d.parsedFile;if(this._isMounted){var y=this.props,C=y.onStart,T=y.customRequest,S=y.name,M=y.headers,w=y.withCredentials,f=y.method,I=u.uid,E=T||$i,j={action:p,filename:S,data:m,file:h,headers:M,withCredentials:w,method:f||"post",onProgress:function(v){var H=i.props.onProgress;H?.(v,h)},onSuccess:function(v,H){var $=i.props.onSuccess;$?.(v,h,H),delete i.reqs[I]},onError:function(v,H){var $=i.props.onError;$?.(v,H,h),delete i.reqs[I]}};C(u),this.reqs[I]=E(j)}}},{key:"reset",value:function(){this.setState({uid:Io()})}},{key:"abort",value:function(d){var i=this.reqs;if(d){var m=d.uid?d.uid:d;i[m]&&i[m].abort&&i[m].abort(),delete i[m]}else Object.keys(i).forEach(function(u){i[u]&&i[u].abort&&i[u].abort(),delete i[u]})}},{key:"render",value:function(){var d=this.props,i=d.component,m=d.prefixCls,u=d.className,p=d.classNames,h=p===void 0?{}:p,y=d.disabled,C=d.id,T=d.name,S=d.style,M=d.styles,w=M===void 0?{}:M,f=d.multiple,I=d.accept,E=d.capture,j=d.children,N=d.directory,v=d.openFileDialogOnClick,H=d.onMouseEnter,$=d.onMouseLeave,q=d.hasControlInside,se=qr(d,Ti),U=Ne(_e(_e(_e({},m,!0),"".concat(m,"-disabled"),y),u,u)),me=N?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},oe=y?{}:{onClick:v?this.onClick:function(){},onKeyDown:v?this.onKeyDown:function(){},onMouseEnter:H,onMouseLeave:$,onDrop:this.onFileDrop,onDragOver:this.onFileDragOver,tabIndex:q?void 0:"0"};return ot.createElement(i,Mt({},oe,{className:U,role:q?void 0:"button",style:S}),ot.createElement("input",Mt({},gs(se,{aria:!0,data:!0}),{id:C,name:T,disabled:y,type:"file",ref:this.saveFileInput,onClick:function(R){return R.stopPropagation()},key:this.state.uid,style:zo({display:"none"},w.input),className:h.input,accept:I},me,{multiple:f,onChange:this.onChange},E!=null?{capture:E}:{})),j)}}]),o}(c.Component);function Mo(){}var Ho=function(e){Kr(o,e);var t=Xr(o);function o(){var r;Jr(this,o);for(var d=arguments.length,i=new Array(d),m=0;m<d;m++)i[m]=arguments[m];return r=t.call.apply(t,[this].concat(i)),_e(qe(r),"uploader",void 0),_e(qe(r),"saveUploader",function(u){r.uploader=u}),r}return Yr(o,[{key:"abort",value:function(d){this.uploader.abort(d)}},{key:"render",value:function(){return ot.createElement(Fi,Mt({},this.props,{ref:this.saveUploader}))}}]),o}(c.Component);_e(Ho,"defaultProps",{component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:Mo,onError:Mo,onSuccess:Mo,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0,hasControlInside:!1});const Ii=e=>{const{componentCls:t,iconCls:o}=e;return{[`${t}-wrapper`]:{[`${t}-drag`]:{position:"relative",width:"100%",height:"100%",textAlign:"center",background:e.colorFillAlter,border:`${Ye(e.lineWidth)} dashed ${e.colorBorder}`,borderRadius:e.borderRadiusLG,cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,[t]:{padding:e.padding},[`${t}-btn`]:{display:"table",width:"100%",height:"100%",outline:"none",borderRadius:e.borderRadiusLG,"&:focus-visible":{outline:`${Ye(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`}},[`${t}-drag-container`]:{display:"table-cell",verticalAlign:"middle"},[`
          &:not(${t}-disabled):hover,
          &-hover:not(${t}-disabled)
        `]:{borderColor:e.colorPrimaryHover},[`p${t}-drag-icon`]:{marginBottom:e.margin,[o]:{color:e.colorPrimary,fontSize:e.uploadThumbnailSize}},[`p${t}-text`]:{margin:`0 0 ${Ye(e.marginXXS)}`,color:e.colorTextHeading,fontSize:e.fontSizeLG},[`p${t}-hint`]:{color:e.colorTextDescription,fontSize:e.fontSize},[`&${t}-disabled`]:{[`p${t}-drag-icon ${o},
            p${t}-text,
            p${t}-hint
          `]:{color:e.colorTextDisabled}}}}}},Mi=e=>{const{componentCls:t,iconCls:o,fontSize:r,lineHeight:d,calc:i}=e,m=`${t}-list-item`,u=`${m}-actions`,p=`${m}-action`;return{[`${t}-wrapper`]:{[`${t}-list`]:Object.assign(Object.assign({},Zr()),{lineHeight:e.lineHeight,[m]:{position:"relative",height:i(e.lineHeight).mul(r).equal(),marginTop:e.marginXS,fontSize:r,display:"flex",alignItems:"center",transition:`background-color ${e.motionDurationSlow}`,borderRadius:e.borderRadiusSM,"&:hover":{backgroundColor:e.controlItemBgHover},[`${m}-name`]:Object.assign(Object.assign({},Qr),{padding:`0 ${Ye(e.paddingXS)}`,lineHeight:d,flex:"auto",transition:`all ${e.motionDurationSlow}`}),[u]:{whiteSpace:"nowrap",[p]:{opacity:0},[o]:{color:e.actionsColor,transition:`all ${e.motionDurationSlow}`},[`
              ${p}:focus-visible,
              &.picture ${p}
            `]:{opacity:1}},[`${t}-icon ${o}`]:{color:e.colorIcon,fontSize:r},[`${m}-progress`]:{position:"absolute",bottom:e.calc(e.uploadProgressOffset).mul(-1).equal(),width:"100%",paddingInlineStart:i(r).add(e.paddingXS).equal(),fontSize:r,lineHeight:0,pointerEvents:"none","> div":{margin:0}}},[`${m}:hover ${p}`]:{opacity:1},[`${m}-error`]:{color:e.colorError,[`${m}-name, ${t}-icon ${o}`]:{color:e.colorError},[u]:{[`${o}, ${o}:hover`]:{color:e.colorError},[p]:{opacity:1}}},[`${t}-list-item-container`]:{transition:`opacity ${e.motionDurationSlow}, height ${e.motionDurationSlow}`,"&::before":{display:"table",width:0,height:0,content:'""'}}})}}},Bi=e=>{const{componentCls:t}=e,o=new Uo("uploadAnimateInlineIn",{from:{width:0,height:0,padding:0,opacity:0,margin:e.calc(e.marginXS).div(-2).equal()}}),r=new Uo("uploadAnimateInlineOut",{to:{width:0,height:0,padding:0,opacity:0,margin:e.calc(e.marginXS).div(-2).equal()}}),d=`${t}-animate-inline`;return[{[`${t}-wrapper`]:{[`${d}-appear, ${d}-enter, ${d}-leave`]:{animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseInOutCirc,animationFillMode:"forwards"},[`${d}-appear, ${d}-enter`]:{animationName:o},[`${d}-leave`]:{animationName:r}}},{[`${t}-wrapper`]:bs(e)},o,r]},Di=e=>{const{componentCls:t,iconCls:o,uploadThumbnailSize:r,uploadProgressOffset:d,calc:i}=e,m=`${t}-list`,u=`${m}-item`;return{[`${t}-wrapper`]:{[`
        ${m}${m}-picture,
        ${m}${m}-picture-card,
        ${m}${m}-picture-circle
      `]:{[u]:{position:"relative",height:i(r).add(i(e.lineWidth).mul(2)).add(i(e.paddingXS).mul(2)).equal(),padding:e.paddingXS,border:`${Ye(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusLG,"&:hover":{background:"transparent"},[`${u}-thumbnail`]:Object.assign(Object.assign({},Qr),{width:r,height:r,lineHeight:Ye(i(r).add(e.paddingSM).equal()),textAlign:"center",flex:"none",[o]:{fontSize:e.fontSizeHeading2,color:e.colorPrimary},img:{display:"block",width:"100%",height:"100%",overflow:"hidden"}}),[`${u}-progress`]:{bottom:d,width:`calc(100% - ${Ye(i(e.paddingSM).mul(2).equal())})`,marginTop:0,paddingInlineStart:i(r).add(e.paddingXS).equal()}},[`${u}-error`]:{borderColor:e.colorError,[`${u}-thumbnail ${o}`]:{[`svg path[fill='${vr[0]}']`]:{fill:e.colorErrorBg},[`svg path[fill='${vr.primary}']`]:{fill:e.colorError}}},[`${u}-uploading`]:{borderStyle:"dashed",[`${u}-name`]:{marginBottom:d}}},[`${m}${m}-picture-circle ${u}`]:{[`&, &::before, ${u}-thumbnail`]:{borderRadius:"50%"}}}}},Li=e=>{const{componentCls:t,iconCls:o,fontSizeLG:r,colorTextLightSolid:d,calc:i}=e,m=`${t}-list`,u=`${m}-item`,p=e.uploadPicCardSize;return{[`
      ${t}-wrapper${t}-picture-card-wrapper,
      ${t}-wrapper${t}-picture-circle-wrapper
    `]:Object.assign(Object.assign({},Zr()),{display:"block",[`${t}${t}-select`]:{width:p,height:p,textAlign:"center",verticalAlign:"top",backgroundColor:e.colorFillAlter,border:`${Ye(e.lineWidth)} dashed ${e.colorBorder}`,borderRadius:e.borderRadiusLG,cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,[`> ${t}`]:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",textAlign:"center"},[`&:not(${t}-disabled):hover`]:{borderColor:e.colorPrimary}},[`${m}${m}-picture-card, ${m}${m}-picture-circle`]:{display:"flex",flexWrap:"wrap","@supports not (gap: 1px)":{"& > *":{marginBlockEnd:e.marginXS,marginInlineEnd:e.marginXS}},"@supports (gap: 1px)":{gap:e.marginXS},[`${m}-item-container`]:{display:"inline-block",width:p,height:p,verticalAlign:"top"},"&::after":{display:"none"},"&::before":{display:"none"},[u]:{height:"100%",margin:0,"&::before":{position:"absolute",zIndex:1,width:`calc(100% - ${Ye(i(e.paddingXS).mul(2).equal())})`,height:`calc(100% - ${Ye(i(e.paddingXS).mul(2).equal())})`,backgroundColor:e.colorBgMask,opacity:0,transition:`all ${e.motionDurationSlow}`,content:'" "'}},[`${u}:hover`]:{[`&::before, ${u}-actions`]:{opacity:1}},[`${u}-actions`]:{position:"absolute",insetInlineStart:0,zIndex:10,width:"100%",whiteSpace:"nowrap",textAlign:"center",opacity:0,transition:`all ${e.motionDurationSlow}`,[`
            ${o}-eye,
            ${o}-download,
            ${o}-delete
          `]:{zIndex:10,width:r,margin:`0 ${Ye(e.marginXXS)}`,fontSize:r,cursor:"pointer",transition:`all ${e.motionDurationSlow}`,color:d,"&:hover":{color:d},svg:{verticalAlign:"baseline"}}},[`${u}-thumbnail, ${u}-thumbnail img`]:{position:"static",display:"block",width:"100%",height:"100%",objectFit:"contain"},[`${u}-name`]:{display:"none",textAlign:"center"},[`${u}-file + ${u}-name`]:{position:"absolute",bottom:e.margin,display:"block",width:`calc(100% - ${Ye(i(e.paddingXS).mul(2).equal())})`},[`${u}-uploading`]:{[`&${u}`]:{backgroundColor:e.colorFillAlter},[`&::before, ${o}-eye, ${o}-download, ${o}-delete`]:{display:"none"}},[`${u}-progress`]:{bottom:e.marginXL,width:`calc(100% - ${Ye(i(e.paddingXS).mul(2).equal())})`,paddingInlineStart:0}}}),[`${t}-wrapper${t}-picture-circle-wrapper`]:{[`${t}${t}-select`]:{borderRadius:"50%"}}}},_i=e=>{const{componentCls:t}=e;return{[`${t}-rtl`]:{direction:"rtl"}}},zi=e=>{const{componentCls:t,colorTextDisabled:o}=e;return{[`${t}-wrapper`]:Object.assign(Object.assign({},uo(e)),{[t]:{outline:0,"input[type='file']":{cursor:"pointer"}},[`${t}-select`]:{display:"inline-block"},[`${t}-hidden`]:{display:"none"},[`${t}-disabled`]:{color:o,cursor:"not-allowed"}})}},Vi=e=>({actionsColor:e.colorIcon}),Ui=lo("Upload",e=>{const{fontSizeHeading3:t,fontHeight:o,lineWidth:r,controlHeightLG:d,calc:i}=e,m=co(e,{uploadThumbnailSize:i(t).mul(2).equal(),uploadProgressOffset:i(i(o).div(2)).add(r).equal(),uploadPicCardSize:i(d).mul(2.55).equal()});return[zi(m),Ii(m),Di(m),Li(m),Mi(m),Bi(m),_i(m),ms(m)]},Vi);function Jn(e){return Object.assign(Object.assign({},e),{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.name,size:e.size,type:e.type,uid:e.uid,percent:0,originFileObj:e})}function Yn(e,t){const o=$t(t),r=o.findIndex(({uid:d})=>d===e.uid);return r===-1?o.push(e):o[r]=e,o}function Bo(e,t){const o=e.uid!==void 0?"uid":"name";return t.filter(r=>r[o]===e[o])[0]}function Wi(e,t){const o=e.uid!==void 0?"uid":"name",r=t.filter(d=>d[o]!==e[o]);return r.length===t.length?null:r}const Hi=(e="")=>{const t=e.split("/"),r=t[t.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(r)||[""])[0]},ca=e=>e.indexOf("image/")===0,qi=e=>{if(e.type&&!e.thumbUrl)return ca(e.type);const t=e.thumbUrl||e.url||"",o=Hi(t);return/^data:image\//.test(t)||/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(o)?!0:!(/^data:/.test(t)||o)},Ut=200;function Gi(e){return new Promise(t=>{if(!e.type||!ca(e.type)){t("");return}const o=document.createElement("canvas");o.width=Ut,o.height=Ut,o.style.cssText=`position: fixed; left: 0; top: 0; width: ${Ut}px; height: ${Ut}px; z-index: 9999; display: none;`,document.body.appendChild(o);const r=o.getContext("2d"),d=new Image;if(d.onload=()=>{const{width:i,height:m}=d;let u=Ut,p=Ut,h=0,y=0;i>m?(p=m*(Ut/i),y=-(p-u)/2):(u=i*(Ut/m),h=-(u-p)/2),r.drawImage(d,h,y,u,p);const C=o.toDataURL();document.body.removeChild(o),window.URL.revokeObjectURL(d.src),t(C)},d.crossOrigin="anonymous",e.type.startsWith("image/svg+xml")){const i=new FileReader;i.onload=()=>{i.result&&typeof i.result=="string"&&(d.src=i.result)},i.readAsDataURL(e)}else if(e.type.startsWith("image/gif")){const i=new FileReader;i.onload=()=>{i.result&&t(i.result)},i.readAsDataURL(e)}else d.src=window.URL.createObjectURL(e)})}const Ki=c.forwardRef(({prefixCls:e,className:t,style:o,locale:r,listType:d,file:i,items:m,progress:u,iconRender:p,actionIconRender:h,itemRender:y,isImgUrl:C,showPreviewIcon:T,showRemoveIcon:S,showDownloadIcon:M,previewIcon:w,removeIcon:f,downloadIcon:I,extra:E,onPreview:j,onDownload:N,onClose:v},H)=>{var $,q;const{status:se}=i,[U,me]=c.useState(se);c.useEffect(()=>{se!=="removed"&&me(se)},[se]);const[oe,Y]=c.useState(!1);c.useEffect(()=>{const le=setTimeout(()=>{Y(!0)},300);return()=>{clearTimeout(le)}},[]);const R=p(i);let k=c.createElement("div",{className:`${e}-icon`},R);if(d==="picture"||d==="picture-card"||d==="picture-circle")if(U==="uploading"||!i.thumbUrl&&!i.url){const le=Ne(`${e}-list-item-thumbnail`,{[`${e}-list-item-file`]:U!=="uploading"});k=c.createElement("div",{className:le},R)}else{const le=C?.(i)?c.createElement("img",{src:i.thumbUrl||i.url,alt:i.name,className:`${e}-list-item-image`,crossOrigin:i.crossOrigin}):R,Ae=Ne(`${e}-list-item-thumbnail`,{[`${e}-list-item-file`]:C&&!C(i)});k=c.createElement("a",{className:Ae,onClick:Ke=>j(i,Ke),href:i.url||i.thumbUrl,target:"_blank",rel:"noopener noreferrer"},le)}const B=Ne(`${e}-list-item`,`${e}-list-item-${U}`),ne=typeof i.linkProps=="string"?JSON.parse(i.linkProps):i.linkProps,ee=(typeof S=="function"?S(i):S)?h((typeof f=="function"?f(i):f)||c.createElement(ci,null),()=>v(i),e,r.removeFile,!0):null,W=(typeof M=="function"?M(i):M)&&U==="done"?h((typeof I=="function"?I(i):I)||c.createElement(mi,null),()=>N(i),e,r.downloadFile):null,Z=d!=="picture-card"&&d!=="picture-circle"&&c.createElement("span",{key:"download-delete",className:Ne(`${e}-list-item-actions`,{picture:d==="picture"})},W,ee),Q=typeof E=="function"?E(i):E,te=Q&&c.createElement("span",{className:`${e}-list-item-extra`},Q),_=Ne(`${e}-list-item-name`),ie=i.url?c.createElement("a",Object.assign({key:"view",target:"_blank",rel:"noopener noreferrer",className:_,title:i.name},ne,{href:i.url,onClick:le=>j(i,le)}),i.name,te):c.createElement("span",{key:"view",className:_,onClick:le=>j(i,le),title:i.name},i.name,te),ue=(typeof T=="function"?T(i):T)&&(i.url||i.thumbUrl)?c.createElement("a",{href:i.url||i.thumbUrl,target:"_blank",rel:"noopener noreferrer",onClick:le=>j(i,le),title:r.previewFile},typeof w=="function"?w(i):w||c.createElement(xs,null)):null,pe=(d==="picture-card"||d==="picture-circle")&&U!=="uploading"&&c.createElement("span",{className:`${e}-list-item-actions`},ue,U==="done"&&W,ee),{getPrefixCls:ye}=c.useContext(an),fe=ye(),ve=c.createElement("div",{className:B},k,ie,Z,pe,oe&&c.createElement(ea,{motionName:`${fe}-fade`,visible:U==="uploading",motionDeadline:2e3},({className:le})=>{const Ae="percent"in i?c.createElement(la,Object.assign({type:"line",percent:i.percent,"aria-label":i["aria-label"],"aria-labelledby":i["aria-labelledby"]},u)):null;return c.createElement("div",{className:Ne(`${e}-list-item-progress`,le)},Ae)})),ke=i.response&&typeof i.response=="string"?i.response:(($=i.error)===null||$===void 0?void 0:$.statusText)||((q=i.error)===null||q===void 0?void 0:q.message)||r.uploadError,re=U==="error"?c.createElement(Gt,{title:ke,getPopupContainer:le=>le.parentNode},ve):ve;return c.createElement("div",{className:Ne(`${e}-list-item-container`,t),style:o,ref:H},y?y(re,i,m,{download:N.bind(null,i),preview:j.bind(null,i),remove:v.bind(null,i)}):re)}),Xi=(e,t)=>{const{listType:o="text",previewFile:r=Gi,onPreview:d,onDownload:i,onRemove:m,locale:u,iconRender:p,isImageUrl:h=qi,prefixCls:y,items:C=[],showPreviewIcon:T=!0,showRemoveIcon:S=!0,showDownloadIcon:M=!1,removeIcon:w,previewIcon:f,downloadIcon:I,extra:E,progress:j={size:[-1,2],showInfo:!1},appendAction:N,appendActionVisible:v=!0,itemRender:H,disabled:$}=e,q=rs(),[se,U]=c.useState(!1),me=["picture-card","picture-circle"].includes(o);c.useEffect(()=>{o.startsWith("picture")&&(C||[]).forEach(_=>{!(_.originFileObj instanceof File||_.originFileObj instanceof Blob)||_.thumbUrl!==void 0||(_.thumbUrl="",r?.(_.originFileObj).then(ie=>{_.thumbUrl=ie||"",q()}))})},[o,C,r]),c.useEffect(()=>{U(!0)},[]);const oe=(_,ie)=>{if(d)return ie?.preventDefault(),d(_)},Y=_=>{typeof i=="function"?i(_):_.url&&window.open(_.url)},R=_=>{m?.(_)},k=_=>{if(p)return p(_,o);const ie=_.status==="uploading";if(o.startsWith("picture")){const ue=o==="picture"?c.createElement(xr,null):u.uploading,pe=h?.(_)?c.createElement(Ai,null):c.createElement(hi,null);return ie?ue:pe}return ie?c.createElement(xr,null):c.createElement(Si,null)},B=(_,ie,ue,pe,ye)=>{const fe={type:"text",size:"small",title:pe,onClick:ve=>{var ke,re;ie(),c.isValidElement(_)&&((re=(ke=_.props).onClick)===null||re===void 0||re.call(ke,ve))},className:`${ue}-list-item-action`,disabled:ye?$:!1};return c.isValidElement(_)?c.createElement(ze,Object.assign({},fe,{icon:no(_,Object.assign(Object.assign({},_.props),{onClick:()=>{}}))})):c.createElement(ze,Object.assign({},fe),c.createElement("span",null,_))};c.useImperativeHandle(t,()=>({handlePreview:oe,handleDownload:Y}));const{getPrefixCls:ne}=c.useContext(an),ee=ne("upload",y),W=ne(),Z=Ne(`${ee}-list`,`${ee}-list-${o}`),Q=c.useMemo(()=>Gr(as(W),["onAppearEnd","onEnterEnd","onLeaveEnd"]),[W]),te=Object.assign(Object.assign({},me?{}:Q),{motionDeadline:2e3,motionName:`${ee}-${me?"animate-inline":"animate"}`,keys:$t(C.map(_=>({key:_.uid,file:_}))),motionAppear:se});return c.createElement("div",{className:Z},c.createElement(ss,Object.assign({},te,{component:!1}),({key:_,file:ie,className:ue,style:pe})=>c.createElement(Ki,{key:_,locale:u,prefixCls:ee,className:ue,style:pe,file:ie,items:C,progress:j,listType:o,isImgUrl:h,showPreviewIcon:T,showRemoveIcon:S,showDownloadIcon:M,removeIcon:w,previewIcon:f,downloadIcon:I,extra:E,iconRender:k,actionIconRender:B,itemRender:H,onPreview:oe,onDownload:Y,onClose:R})),N&&c.createElement(ea,Object.assign({},te,{visible:v,forceRender:!0}),({className:_,style:ie})=>no(N,ue=>({className:Ne(ue.className,_),style:Object.assign(Object.assign(Object.assign({},ie),{pointerEvents:_?"none":void 0}),ue.style)}))))},Ji=c.forwardRef(Xi);var Yi=function(e,t,o,r){function d(i){return i instanceof o?i:new o(function(m){m(i)})}return new(o||(o=Promise))(function(i,m){function u(y){try{h(r.next(y))}catch(C){m(C)}}function p(y){try{h(r.throw(y))}catch(C){m(C)}}function h(y){y.done?i(y.value):d(y.value).then(u,p)}h((r=r.apply(e,[])).next())})};const Rn=`__LIST_IGNORE_${Date.now()}__`,Zi=(e,t)=>{const o=Wr("upload"),{fileList:r,defaultFileList:d,onRemove:i,showUploadList:m=!0,listType:u="text",onPreview:p,onDownload:h,onChange:y,onDrop:C,previewFile:T,disabled:S,locale:M,iconRender:w,isImageUrl:f,progress:I,prefixCls:E,className:j,type:N="select",children:v,style:H,itemRender:$,maxCount:q,data:se={},multiple:U=!1,hasControlInside:me=!0,action:oe="",accept:Y="",supportServerRender:R=!0,rootClassName:k}=e,B=c.useContext(is),ne=S??B,ee=e.customRequest||o.customRequest,[W,Z]=Hr(d||[],{value:r,postState:de=>de??[]}),[Q,te]=c.useState("drop"),_=c.useRef(null),ie=c.useRef(null);c.useMemo(()=>{const de=Date.now();(r||[]).forEach((Se,$e)=>{!Se.uid&&!Object.isFrozen(Se)&&(Se.uid=`__AUTO__${de}_${$e}__`)})},[r]);const ue=(de,Se,$e)=>{let he=$t(Se),Ce=!1;q===1?he=he.slice(-1):q&&(Ce=he.length>q,he=he.slice(0,q)),Sr.flushSync(()=>{Z(he)});const ae={file:de,fileList:he};$e&&(ae.event=$e),(!Ce||de.status==="removed"||he.some(Ze=>Ze.uid===de.uid))&&Sr.flushSync(()=>{y?.(ae)})},pe=(de,Se)=>Yi(void 0,void 0,void 0,function*(){const{beforeUpload:$e,transformFile:he}=e;let Ce=de;if($e){const ae=yield $e(de,Se);if(ae===!1)return!1;if(delete de[Rn],ae===Rn)return Object.defineProperty(de,Rn,{value:!0,configurable:!0}),!1;typeof ae=="object"&&ae&&(Ce=ae)}return he&&(Ce=yield he(Ce)),Ce}),ye=de=>{const Se=de.filter(Ce=>!Ce.file[Rn]);if(!Se.length)return;const $e=Se.map(Ce=>Jn(Ce.file));let he=$t(W);$e.forEach(Ce=>{he=Yn(Ce,he)}),$e.forEach((Ce,ae)=>{let Ze=Ce;if(Se[ae].parsedFile)Ce.status="uploading";else{const{originFileObj:ht}=Ce;let st;try{st=new File([ht],ht.name,{type:ht.type})}catch{st=new Blob([ht],{type:ht.type}),st.name=ht.name,st.lastModifiedDate=new Date,st.lastModified=new Date().getTime()}st.uid=Ce.uid,Ze=st}ue(Ze,he)})},fe=(de,Se,$e)=>{try{typeof de=="string"&&(de=JSON.parse(de))}catch{}if(!Bo(Se,W))return;const he=Jn(Se);he.status="done",he.percent=100,he.response=de,he.xhr=$e;const Ce=Yn(he,W);ue(he,Ce)},ve=(de,Se)=>{if(!Bo(Se,W))return;const $e=Jn(Se);$e.status="uploading",$e.percent=de.percent;const he=Yn($e,W);ue($e,he,de)},ke=(de,Se,$e)=>{if(!Bo($e,W))return;const he=Jn($e);he.error=de,he.response=Se,he.status="error";const Ce=Yn(he,W);ue(he,Ce)},re=de=>{let Se;Promise.resolve(typeof i=="function"?i(de):i).then($e=>{var he;if($e===!1)return;const Ce=Wi(de,W);Ce&&(Se=Object.assign(Object.assign({},de),{status:"removed"}),W?.forEach(ae=>{const Ze=Se.uid!==void 0?"uid":"name";ae[Ze]===Se[Ze]&&!Object.isFrozen(ae)&&(ae.status="removed")}),(he=_.current)===null||he===void 0||he.abort(Se),ue(Se,Ce))})},le=de=>{te(de.type),de.type==="drop"&&C?.(de)};c.useImperativeHandle(t,()=>({onBatchStart:ye,onSuccess:fe,onProgress:ve,onError:ke,fileList:W,upload:_.current,nativeElement:ie.current}));const{getPrefixCls:Ae,direction:Ke,upload:Pe}=c.useContext(an),xe=Ae("upload",E),Et=Object.assign(Object.assign({onBatchStart:ye,onError:ke,onProgress:ve,onSuccess:fe},e),{customRequest:ee,data:se,multiple:U,action:oe,accept:Y,supportServerRender:R,prefixCls:xe,disabled:ne,beforeUpload:pe,onChange:void 0,hasControlInside:me});delete Et.className,delete Et.style,(!v||ne)&&delete Et.id;const xt=`${xe}-wrapper`,[St,Xe,We]=Ui(xe,xt),[at]=ls("Upload",cs.Upload),{showRemoveIcon:wt,showPreviewIcon:Rt,showDownloadIcon:Bt,removeIcon:Jt,previewIcon:Yt,downloadIcon:jt,extra:Ve}=typeof m=="boolean"?{}:m,Re=typeof wt>"u"?!ne:wt,Tt=(de,Se)=>m?c.createElement(Ji,{prefixCls:xe,listType:u,items:W,previewFile:T,onPreview:p,onDownload:h,onRemove:re,showRemoveIcon:Re,showPreviewIcon:Rt,showDownloadIcon:Bt,removeIcon:Jt,previewIcon:Yt,downloadIcon:jt,iconRender:w,extra:Ve,locale:Object.assign(Object.assign({},at),M),isImageUrl:f,progress:I,appendAction:de,appendActionVisible:Se,itemRender:$,disabled:ne}):de,Ft=Ne(xt,j,k,Xe,We,Pe?.className,{[`${xe}-rtl`]:Ke==="rtl",[`${xe}-picture-card-wrapper`]:u==="picture-card",[`${xe}-picture-circle-wrapper`]:u==="picture-circle"}),It=Object.assign(Object.assign({},Pe?.style),H);if(N==="drag"){const de=Ne(Xe,xe,`${xe}-drag`,{[`${xe}-drag-uploading`]:W.some(Se=>Se.status==="uploading"),[`${xe}-drag-hover`]:Q==="dragover",[`${xe}-disabled`]:ne,[`${xe}-rtl`]:Ke==="rtl"});return St(c.createElement("span",{className:Ft,ref:ie},c.createElement("div",{className:de,style:It,onDrop:le,onDragOver:le,onDragLeave:le},c.createElement(Ho,Object.assign({},Et,{ref:_,className:`${xe}-btn`}),c.createElement("div",{className:`${xe}-drag-container`},v))),Tt()))}const Dt=Ne(xe,`${xe}-select`,{[`${xe}-disabled`]:ne,[`${xe}-hidden`]:!v}),Lt=c.createElement("div",{className:Dt,style:It},c.createElement(Ho,Object.assign({},Et,{ref:_})));return St(u==="picture-card"||u==="picture-circle"?c.createElement("span",{className:Ft,ref:ie},Tt(Lt,!!v)):c.createElement("span",{className:Ft,ref:ie},Lt,Tt()))},da=c.forwardRef(Zi);var Qi=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,r=Object.getOwnPropertySymbols(e);d<r.length;d++)t.indexOf(r[d])<0&&Object.prototype.propertyIsEnumerable.call(e,r[d])&&(o[r[d]]=e[r[d]]);return o};const el=c.forwardRef((e,t)=>{var{style:o,height:r,hasControlInside:d=!1}=e,i=Qi(e,["style","height","hasControlInside"]);return c.createElement(da,Object.assign({ref:t,hasControlInside:d},i,{type:"drag",style:Object.assign(Object.assign({},o),{height:r})}))}),Fn=da;Fn.Dragger=el;Fn.LIST_IGNORE=Rn;function qo(){return qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},qo.apply(this,arguments)}const tl=(e,t)=>c.createElement(Ot,qo({},e,{ref:t,icon:Ea})),nl=c.forwardRef(tl);function Go(){return Go=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Go.apply(this,arguments)}const ol=(e,t)=>c.createElement(Ot,Go({},e,{ref:t,icon:ii})),Pt=c.forwardRef(ol);function Ko(){return Ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Ko.apply(this,arguments)}const rl=(e,t)=>c.createElement(Ot,Ko({},e,{ref:t,icon:Fs})),Or=c.forwardRef(rl);function Xo(){return Xo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Xo.apply(this,arguments)}const al=(e,t)=>c.createElement(Ot,Xo({},e,{ref:t,icon:gi})),sl=c.forwardRef(al);function Jo(){return Jo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Jo.apply(this,arguments)}const il=(e,t)=>c.createElement(Ot,Jo({},e,{ref:t,icon:bi})),ll=c.forwardRef(il);function Yo(){return Yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Yo.apply(this,arguments)}const cl=(e,t)=>c.createElement(Ot,Yo({},e,{ref:t,icon:yi})),dl=c.forwardRef(cl);function Zo(){return Zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Zo.apply(this,arguments)}const ul=(e,t)=>c.createElement(Ot,Zo({},e,{ref:t,icon:wi})),ml=c.forwardRef(ul);function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},Qo.apply(this,arguments)}const pl=(e,t)=>c.createElement(Ot,Qo({},e,{ref:t,icon:Ni})),fl=c.forwardRef(pl);function er(){return er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},er.apply(this,arguments)}const hl=(e,t)=>c.createElement(Ot,er({},e,{ref:t,icon:Ba})),gl=c.forwardRef(hl);function tr(){return tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},tr.apply(this,arguments)}const bl=(e,t)=>c.createElement(Ot,tr({},e,{ref:t,icon:ki})),yl=c.forwardRef(bl),ua="https://script.google.com/macros/s/AKfycbzWT7aSLTZl-qW2peDaHMcsW_aA55ttVfheZThFfYpj7sMm09Mg_6Gp2xjc7Z0XNHmwpw/exec",ma=e=>e&&typeof e=="object"&&!Array.isArray(e),vl=(e={})=>{const t=(i,m)=>e[i]!==void 0?e[i]:e[m],o=t("action","Action"),r=t("chassisNo","Chassis_No");return{movementId:t("movementId","MovementId"),chassisNo:r?String(r).toUpperCase():void 0,company:t("company","Company"),model:t("model","Model"),variant:t("variant","Variant"),color:t("color","Color"),action:o?String(o).toLowerCase():void 0,sourceBranch:t("sourceBranch","Source_Branch"),targetBranch:t("targetBranch","Target_Branch"),returnTo:t("returnTo","Return_To"),customerName:t("customerName","Customer_Name"),transferStatus:t("transferStatus","Transfer_Status"),notes:t("notes","Notes"),createdByName:t("createdByName","CreatedByName"),createdById:t("createdById","CreatedById"),resolvedByName:t("resolvedByName","ResolvedByName"),resolvedById:t("resolvedById","ResolvedById"),resolvedAt:t("resolvedAt","ResolvedAt"),deleted:t("deleted","Deleted"),timestamp:t("timestamp","Timestamp")}},po=async e=>{try{const o=await Vr.get("/stocks/gas",{params:e,validateStatus:()=>!0});if(ma(o?.data))return o.data}catch{}const t=ua;try{return(await ka.get(t,{params:e,validateStatus:()=>!0}))?.data||{}}catch{return{}}},fo=async e=>{try{const o=await Vr.post("/stocks/gas",e||{},{validateStatus:()=>!0});if(ma(o?.data))return o.data}catch{}const t=ua;try{const o=await fetch(t,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(e||{})});try{return await o.json()}catch{return{}}}catch{return{}}},Cc=async({branch:e,mode:t,limit:o=1e3,page:r=1}={})=>{const d=await po({action:"list",branch:e,mode:t,limit:o,page:r});return{success:!!d.ok,data:d.data||[],total:d.total||0,count:d.count||(d.data?d.data.length:0)}},Ac=async({branch:e,limit:t=5e3,page:o=1}={})=>{const r=await po({action:"current",branch:e,limit:t,page:o});return{success:!!r.ok,data:r.data||[],total:r.total||0,count:r.count||(r.data?r.data.length:0)}},Er=async({branch:e,limit:t=5e3,page:o=1}={})=>{const r=await po({action:"current",branch:e,limit:t,page:o});return{success:!!r.ok,data:r.data||[],total:r.total||0,count:r.count||(r.data?r.data.length:0)}},Nc=async({branch:e,limit:t=5e3}={})=>{const o={action:"pending",limit:t};e&&(o.branch=e);const r=await po(o);return{success:!!r.ok,data:r.data||[],message:r.message}},kc=async({data:e,createdBy:t})=>{const r=await fo({action:"create",data:e,createdBy:t});return{success:!!r.ok,data:r.data,message:r.message}},Pc=async(e,t)=>{const o=vl(t||{}),d=await fo({action:"update",movementId:e,data:o});return{success:!!d.ok,data:d.data,message:d.message}},$c=async(e,t)=>{const o=await fo({action:"admit",movementId:e,notes:t});return{success:!!o.ok,data:o.data,message:o.message}},Oc=async(e,t)=>{const o=await fo({action:"reject",movementId:e,reason:t,notes:t});return{success:!!o.ok,data:o.data,message:o.message}},pa=c.forwardRef(function({active:t=!0,vals:o={}},r){const d=String(o?.branch||"").trim(),i=d,u=d.toLowerCase()==="byadarahalli",p=o?.customerName||o?.name||`${o?.firstName||""} ${o?.lastName||""}`.trim()||"-",h=o?.mobileNumber||o?.mobile||o?.phone||"-",y=o?.address||o?.addressLine||[o?.addressLine1,o?.addressLine2,o?.city,o?.pincode].filter(Boolean).join(", ")||"-",C=o?.vehicle||{},T=C?.company||o?.company||o?.make||"",S=C?.model||o?.bikeModel||o?.modelName||"",M=C?.variant||o?.variantName||o?.trim||"",w=C?.color||o?.vehicleColor||"",f=C?.availability||o?.availability||o?.chassisStatus||"",I=C?.chassisNo||o?.chassisNo||(f==="allot"?"To be allotted":"-"),E=o?.purchaseMode||o?.purchaseType||o?.paymentType||"-",j=String(E).toLowerCase(),N=o?.financierName||o?.financier||o?.hpFinancier||o?.nohpFinancier||o?.selectedFinancier||"",v=o?.rtoOffice||o?.rto||o?.rtoOfficeName||o?.rtoCode||"",H=Y=>{const R=Number(String(Y??"").replace(/[^\d.-]/g,""));return Number.isFinite(R)?R:0},$=(()=>{const Y=[],R=(k,B,ne,ee)=>{const W=H(ne);W&&Y.push({part:k?`Part ${k}`:"",mode:String(B||"").toLowerCase()==="online"?"Online":"Cash",amount:W,reference:ee||""})};return Array.isArray(o?.payments)&&o.payments.length?o.payments.forEach((k,B)=>R(k?.part||B+1,k?.mode||k?.paymentMode,k?.amount??k?.total??k?.value,k?.reference||k?.ref||k?.utr||k?.refNo)):Array.isArray(o?.paymentSplit)&&o.paymentSplit.length?o.paymentSplit.forEach(k=>{R(k?.part,"Cash",k?.cash),R(k?.part,"Online",k?.online,k?.reference||k?.ref||k?.utr)}):[1,2,3].forEach(k=>{const B=H(o?.[`bookingAmount${k}Cash`]),ne=H(o?.[`bookingAmount${k}Online`]),ee=H(o?.[`bookingAmount${k}`]),W=String(o?.[`paymentMode${k}`]||"").toLowerCase(),Z=o?.[`paymentReference${k}`]||o?.[`paymentRef${k}`]||o?.[`utr${k}`]||o?.utr;!B&&!ne&&ee?W==="online"?R(k,"Online",ee,Z):R(k,"Cash",ee):(B&&R(k,"Cash",B),ne&&R(k,"Online",ne,Z))}),Y})(),q=$.reduce((Y,R)=>Y+R.amount,0),se=o?.executive||o?.salesExecutive||o?.salesperson||"-",U=o?.createdAt||o?.ts||new Date,me=["hp","loan"].includes(j)?"HP (Loan)":["nohp","self","self-funded","selffunded"].includes(j)?"No Hypothecation":j==="cash"?"Cash":String(E).toUpperCase(),oe=["loan","hp","nohp"].includes(j);return n.jsxs("div",{ref:r,className:`print-sheet ${t?"active":""}`,children:[n.jsx("style",{children:`
/* =========================
   PRINT BASELINE (A4)
   ========================= */
@page { size: A4 portrait; margin: 0; }
html, body {
  margin: 0 !important;
  padding: 0 !important;
  background: #fff !important;
  -webkit-print-color-adjust: exact !important; /* helps keep intended colors */
  print-color-adjust: exact !important;
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, Helvetica, sans-serif;
}
img { max-width: 100%; height: auto; background: transparent; }

/* Hide inside main app screens; visible in dedicated print doc or when printing */
@media screen {
  body:not(.print-host) .print-sheet { display: none !important; }
}

/* Scope print to only the active sheet and avoid blank extra pages */
@media print {
  body * { visibility: hidden !important; }
  .print-sheet { display: block; }
  .print-sheet.active,
  .print-sheet.active * { visibility: visible !important; }
  .print-sheet:not(.active) { display: none !important; }
  .print-sheet.active { position: absolute; inset: 0; width: 100%; }

  /* Keep large blocks together on one page */
  .bk-a4, .wrap, .box, .hdr, .grid, .grid-3, .sign-row { break-inside: avoid; page-break-inside: avoid; }
}

/* =========================
   COMPONENT STYLES
   ========================= */
.bk-a4 { display: block; }
.wrap { padding: 7mm; color: #000; }
.box { border: 1px solid #111; border-radius: 1mm; padding: 3mm; }

.title { text-align: center; font-size: 16.5pt; font-weight: 800; margin: 1.5mm 0 2.5mm; letter-spacing: 0.4px; }
.hdr { display: grid; grid-template-columns: 26mm 1fr 26mm; align-items: center; gap: 3mm; }
.shop { text-align: center; }
.shop .en { font-size: 14.5pt; font-weight: 600; line-height: 1.08; }
.shop .sub { font-size: 9.5pt; margin-top: 1mm; }
.tiny { font-size: 9px; }
.label { font-weight: 600; }

/* Labelvalue INLINE layout (no stacking) */
.kv {
  display: grid;
  grid-template-columns: 38mm 1fr; /* label width | flexible value */
  align-items: center;
  column-gap: 2mm;
  padding: 1mm 0;
  border: none;
  border-bottom: 1px solid #e5e7eb; /* light divider */
}
.kv .name { color: #111; }
.kv .val { font-weight: 600; white-space: pre-line; }

.grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2mm; margin-top: 2mm; }
.grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 2mm; margin-top: 2mm; }
.full { grid-column: 1 / -1; }
.pay-table { width: 100%; border-collapse: collapse; margin-top: 2mm; font-size: 11pt; }
.pay-table th, .pay-table td { border: 1px solid #d1d5db; padding: 2mm 2.5mm; text-align: left; }
.pay-table th { background: #f3f4f6; }

.sign-row { display: grid; grid-template-columns: 1fr 1fr; gap: 6mm; margin-top: 6mm; }
.sign { border-top: 1px dashed #777; padding-top: 2mm; text-align: center; }

.note { margin-top: 3mm; font-size: 10.5pt; }
.note-title { font-weight: 700; margin-bottom: 2mm; }
.note ol { margin: 0; padding-left: 4mm; }
      `}),n.jsx("div",{className:"bk-a4",children:n.jsx("div",{className:"wrap",children:n.jsxs("div",{className:"box",children:[n.jsxs("div",{className:"hdr",children:[n.jsx("img",{src:u?"/honda-logo.png":"/shantha-logoprint.jpg",alt:u?"NH Motors":"Shantha Motors",style:{width:"100%",maxHeight:92}}),n.jsx("div",{className:"shop",children:u?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"en",children:"NH MOTORS |   "}),n.jsxs("div",{className:"sub",style:{marginTop:4},children:["Site No. 116/1, Bydarahalli, Magadi Main Road, Opp.",n.jsx("br",{}),"HP Petrol Bunk, Bangalore - 560091"]}),n.jsx("div",{className:"sub",children:"Mob: 9731366921 / 8073283502 / 9741609799"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"en",children:"SHANTHA MOTORS |  "}),n.jsx("div",{className:"sub",children:"Multi Brand Two Wheeler Sales & Service"}),n.jsx("div",{className:"sub",children:"Mob No : 9731366921 / 8073283502"}),n.jsx("div",{className:"tiny",children:"Kadabagere  Muddinapalya   Andrahalli  Tavarekere  Hegganahalli  Channenahalli  Nelagadrahalli"})]})}),n.jsxs("div",{children:[n.jsx("img",{src:"/location-qr.png",alt:"Location QR",style:{width:"100%",maxHeight:92}}),n.jsx("div",{style:{fontSize:12.5,fontWeight:600,marginTop:4},children:"Scan for Location"})]})]}),n.jsx("div",{className:"title",children:"Vehicle Booking Form"}),n.jsxs("div",{className:"grid-3",children:[n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Date:"})}),n.jsx("div",{className:"val",children:Fa(U)})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Branch:"})}),n.jsx("div",{className:"val",children:i||"-"})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Executive:"})}),n.jsx("div",{className:"val",children:se})]})]}),n.jsxs("div",{className:"grid",children:[n.jsxs("div",{className:"kv full",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Customer Name:"})}),n.jsx("div",{className:"val",children:p})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Mobile:"})}),n.jsx("div",{className:"val",children:h})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"RTO Office:"})}),n.jsx("div",{className:"val",children:v||"-"})]}),n.jsxs("div",{className:"kv full",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Address:"})}),n.jsx("div",{className:"val",children:y})]})]}),n.jsxs("div",{className:"grid",children:[n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Company:"})}),n.jsx("div",{className:"val",children:T||"-"})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Model:"})}),n.jsx("div",{className:"val",children:S||"-"})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Variant:"})}),n.jsx("div",{className:"val",children:M||"-"})]}),n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Color:"})}),n.jsx("div",{className:"val",children:w||"-"})]}),n.jsxs("div",{className:"kv full",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Chassis No:"})}),n.jsx("div",{className:"val",children:I})]})]}),n.jsxs("div",{className:"grid",children:[n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Purchase Mode:"})}),n.jsx("div",{className:"val",children:me})]}),oe&&n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Financier:"})}),n.jsx("div",{className:"val",children:N||"-"})]})]}),n.jsx("div",{className:"grid",children:n.jsxs("div",{className:"kv",children:[n.jsx("div",{className:"name",children:n.jsx("span",{className:"label",children:"Booking Amount Paid:"})}),n.jsx("div",{className:"val",children:q?br(q):"-"})]})}),n.jsxs("table",{className:"pay-table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:"28%"},children:"Payment Part"}),n.jsx("th",{style:{width:"22%"},children:"Mode"}),n.jsx("th",{style:{width:"25%"},children:"Amount"}),n.jsx("th",{children:"UTR / Ref"})]})}),n.jsx("tbody",{children:$.length?$.map((Y,R)=>n.jsxs("tr",{children:[n.jsx("td",{children:Y.part||`Part ${R+1}`}),n.jsx("td",{children:Y.mode}),n.jsx("td",{children:br(Y.amount)}),n.jsx("td",{children:Y.reference||"-"})]},`${Y.part||"p"}-${R}`)):n.jsx("tr",{children:n.jsx("td",{colSpan:4,style:{textAlign:"center"},children:"No payment recorded"})})})]}),n.jsxs("div",{className:"note",children:[n.jsx("div",{className:"note-title",children:"Notes / Terms"}),n.jsxs("ol",{children:[n.jsx("li",{children:"This slip acknowledges booking toward the above vehicle."}),n.jsx("li",{children:"Prices, delivery timelines and availability are subject to change by manufacturer/RTO."}),n.jsx("li",{children:"This is not a tax invoice."})]})]}),n.jsxs("div",{className:"sign-row",children:[n.jsx("div",{className:"sign tiny",children:"Customer Signature"}),n.jsxs("div",{className:"sign tiny",children:[u?"For NH Motors":"For Shantha Motors","  Authorised Signatory"]})]})]})})})]})}),Rr=e=>String(e||"").replace(/\D/g,"").slice(-10),tt=e=>{if(e==null||e==="")return 0;const t=String(e).replace(/[,\s]/g,""),o=Number(t);return Number.isFinite(o)?o:0},xl=(e=[])=>{const t=[{cash:0,online:0,ref:void 0},{cash:0,online:0,ref:void 0},{cash:0,online:0,ref:void 0}],o=(r,d=0)=>{if(!r)return;const i=tt(r.amount);if(!i)return;const m=String(r.mode||"").toLowerCase(),u=Number(r.part)&&Number(r.part)>=1&&Number(r.part)<=3?Number(r.part)-1:Math.min(Math.max(d,0),2);m==="online"?(t[u].online+=i,t[u].ref||(t[u].ref=r.reference||r.utr||r.ref||"")):t[u].cash+=i};return e.forEach((r,d)=>o(r,d)),t},fa=(e={})=>{const t=e||{},o=t.vehicle||{},r=String(t.purchaseMode||t.purchaseType||"").toLowerCase()||"cash",d=Array.isArray(t.addressProofTypes)?t.addressProofTypes:String(t.addressProofTypes||"").split(",").map(h=>h.trim()).filter(Boolean);let i=Array.isArray(t.payments)?t.payments:[];const m=Array.isArray(i)&&i.some(h=>tt(h?.amount)>0),u=xl(i);if(!m){for(let h=0;h<3;h++){const y=`bookingAmount${h+1}Cash`,C=`bookingAmount${h+1}Online`;u[h].cash=u[h].cash||tt(t[y]),u[h].online=u[h].online||tt(t[C]),u[h].ref||(u[h].ref=t[`paymentReference${h+1}`]||t[`paymentRef${h+1}`]||t[`utr${h+1}`]||t.utr||void 0)}u[0].cash=u[0].cash||tt(t.bookingAmount1Cash)||tt(t.bookingAmount)||0,u[0].online=u[0].online||tt(t.bookingAmount1Online)||(String(t.paymentMode||"").toLowerCase()==="online"?tt(t.bookingAmount):0)}return{patch:{executive:t.executive||void 0,branch:t.branch||void 0,customerName:t.customerName||t.name||"",mobileNumber:Rr(t.mobileNumber||t.mobile||""),address:t.address||"",company:o.company||"",bikeModel:o.model||"",variant:o.variant||"",color:o.color||void 0,chassisNo:String(o.availability||"").toLowerCase()==="allot"?"__ALLOT__":o.chassisNo||void 0,rtoOffice:t.rtoOffice||"KA",purchaseType:r,financier:r==="loan"&&t.financier||void 0,nohpFinancier:r==="nohp"&&(t.financier||t.nohpFinancier)||void 0,disbursementAmount:(r==="loan"||r==="nohp")&&tt(t.disbursementAmount)||void 0,emiAmount:(r==="loan"||r==="nohp")&&tt(t.emiAmount)||void 0,tenure:(r==="loan"||r==="nohp")&&tt(t.tenure)||void 0,addressProofMode:t.addressProofMode||t.addressProof||"aadhaar",addressProofTypes:d,bookingAmount1Cash:u[0].cash||void 0,bookingAmount1Online:u[0].online||void 0,paymentReference1:u[0].ref||void 0,bookingAmount2Cash:u[1].cash||void 0,bookingAmount2Online:u[1].online||void 0,paymentReference2:u[1].ref||void 0,bookingAmount3Cash:u[2].cash||void 0,bookingAmount3Online:u[2].online||void 0,paymentReference3:u[2].ref||void 0,downPayment:tt((t.dp&&t.dp.downPayment)??t.downPayment),extraFittingAmount:tt((t.dp&&t.dp.extraFittingAmount)??t.extraFittingAmount),affidavitCharges:tt((t.dp&&t.dp.affidavitCharges)??t.affidavitCharges)},metadata:{bookingId:t.bookingId||t.serialNo||void 0,mobile:Rr(t.mobileNumber||t.mobile||""),vehicle:o}}};function Sl({form:e,webhookUrl:t,setSelectedCompany:o,setSelectedModel:r,onApplied:d,autoSearch:i}){const[m,u]=c.useState(!1),[p,h]=c.useState("mobile"),[y,C]=c.useState(""),[T,S]=c.useState(!1),[M,w]=c.useState([]),[f,I]=c.useState(""),E=c.useRef(null),j=R=>String(R||"").replace(/\D/g,"").slice(-10),N=R=>String(R||"").toUpperCase().replace(/\s+/g,""),v=R=>String(R||"").toUpperCase().replace(/[^A-Z0-9]/g,""),H=/^[A-Z]{2}\d{2}[A-Z]{2}\d{4}$/,$=R=>{const k=v(R);return k.length>10||!/^[A-Z0-9]*$/.test(k)?!1:[/^[A-Z]{0,2}$/,/^[A-Z]{2}\d{0,2}$/,/^[A-Z]{2}\d{2}[A-Z]{0,2}$/,/^[A-Z]{2}\d{2}[A-Z]{2}\d{0,4}$/].some(ne=>ne.test(k))},q=R=>{const k=R,B=k==="mobile"&&j(y)||String(y||"").trim(),ne=B?`The ${k==="mobile"?"mobile number":k==="vehicle"?"vehicle number":"booking ID"} "${B}" is not in our records.`:"No matching booking found in our records.";I(ne),gn.warning({centered:!0,title:"No booking found",content:ne,okText:"Got it"})},se=async(R,k)=>{if(!t)throw new Error("Booking webhook URL not configured");const B=k,ne=String(R??y??"").trim(),ee={action:"search",mode:B,query:ne},W=await rn({webhookUrl:t,method:"GET",payload:ee});let Z=Array.isArray((W?.data||W)?.rows)?(W?.data||W).rows:[];if(!Z.length&&B==="vehicle"){const Q=await rn({webhookUrl:t,method:"GET",payload:{...ee,mode:"reg"}}).catch(()=>null);Z=Array.isArray((Q?.data||Q)?.rows)?(Q?.data||Q).rows:[]}if(!Z.length&&B==="vehicle")try{const Q=await rn({webhookUrl:t,method:"GET",payload:{action:"list"}}),te=Q?.data||Q,_=Array.isArray(te?.rows)?te.rows:Array.isArray(te?.data)?te.data:[],ie=v(ne);Z=_.filter(pe=>{const ye=pe?.values||{},fe=pe?.payload||pe||{},ve=v(ye["Vehicle No"]||ye.Vehicle_No||ye.RegNo||ye["Reg No"]||ye["Registration Number"]||ye["Vehicle Number"]||""),ke=v(fe.vehicle?.regNo||fe.vehicle?.registrationNumber||fe.vehicleNo||fe.regNo||fe.registrationNumber||""),re=v(typeof fe.rawPayload=="string"?fe.rawPayload:"");return ie&&ve===ie||ie&&ke===ie||ie&&re.includes(ie)})}catch{}return Z},U=R=>{const k=R&&R.payload?R.payload:R;return k&&typeof k=="object"?k:{}},me=R=>{try{const k=U(R),{patch:B,metadata:ne}=fa(k);e.setFieldsValue(B),B.company&&o?.(B.company),B.bikeModel&&r?.(B.bikeModel),je.success("Booking details filled."),u(!1),w([]),C("");try{d?.(ne)}catch{}window.dispatchEvent(new CustomEvent("bookingPrefillComplete"))}catch(k){console.warn("applyToForm error:",k),je.error("Could not apply booking details."),window.dispatchEvent(new CustomEvent("bookingPrefillComplete"))}},oe=async({modeOverride:R,queryOverride:k,silent:B,autoSearch:ne=!1}={})=>{const ee=String(k??y??"").trim(),W=R||p||"mobile",Z=()=>{ne&&typeof window<"u"&&window.dispatchEvent(new CustomEvent("bookingPrefillComplete"))};if(!ee){B||je.warning(W==="mobile"?"Enter 10-digit Mobile":W==="vehicle"?"Enter vehicle no. (KA03AB1234)":"Enter Booking ID"),Z();return}let Q=ee;if(W==="mobile"){const te=j(ee);if(te.length!==10){B||je.error("Enter a valid 10-digit mobile number."),Z();return}Q=te,C(te)}else if(W==="vehicle"){const te=v(ee);if(!H.test(te)){B||je.error("Enter vehicle as KA03AB1234."),Z();return}Q=te,C(te)}else Q=N(ee),C(Q);h(W),I(""),S(!0);try{const _=(await se(Q,W)).map(ie=>({payload:U(ie)}));if(!_.length){B||q(W),w([]);return}if(_.length===1){me(_[0].payload);return}w(_.slice(0,10)),B||je.info(`Found ${_.length} matches. Pick one.`)}catch(te){console.warn("Booking search error:",te),B||je.error("Could not fetch bookings. Check webhook.")}finally{S(!1),ne&&typeof window<"u"&&window.dispatchEvent(new CustomEvent("bookingPrefillComplete"))}};c.useEffect(()=>{const R=String(i?.query||"").trim();if(!R)return;const k=i?.mode||"mobile",B=`${k}:${R}`;E.current!==B&&(E.current=B,oe({modeOverride:k,queryOverride:R,silent:!0,autoSearch:!0}))},[i?.mode,i?.query]);const Y=R=>{const k=U(R.payload),B=k.vehicle||{},ne=[B.company,B.model,B.variant].filter(Boolean).join(" "),ee=j(k.mobileNumber||k.mobile||""),W=k.branch||"-",Z=k.ts?He(k.ts).format("DD-MM-YYYY HH:mm"):"-";return n.jsx(yr.Item,{actions:[n.jsx(ze,{type:"link",onClick:()=>me(R.payload),children:"Use"})],children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:"100%"},children:[n.jsxs("div",{children:[n.jsx("b",{children:"Name:"})," ",k.customerName||k.name||"-"," ",n.jsx("b",{children:"Mobile:"})," ",ee||"-"]}),n.jsxs("div",{children:[n.jsx("b",{children:"Vehicle:"})," ",ne||"-"," ",n.jsx("b",{children:"Branch:"})," ",W]}),n.jsxs("div",{style:{gridColumn:"1 / span 2",color:"#999"},children:[n.jsx("b",{children:"Mode:"})," ",String(k.purchaseMode||k.purchaseType||"cash").toUpperCase()," "," ",n.jsx("b",{children:"Date:"})," ",Z]})]})})};return n.jsxs(n.Fragment,{children:[n.jsx(ze,{onClick:()=>{I(""),u(!0)},style:{background:"#2ECC71",borderColor:"#2ECC71",color:"#fff"},children:"Fetch Details"}),n.jsx(gn,{title:"Fetch Booking",open:m,onCancel:()=>{u(!1),w([]),I("")},footer:[n.jsx(ze,{onClick:()=>{u(!1),w([]),I("")},children:"Close"},"close"),n.jsx(ze,{type:"primary",loading:T,onClick:()=>oe(),children:"Search"},"search")],children:n.jsxs(qt,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(yt.Group,{value:p,onChange:R=>{h(R.target.value),C("")},children:[n.jsx(yt.Button,{value:"mobile",children:"By Mobile"}),n.jsx(yt.Button,{value:"booking",children:"By Booking ID"}),n.jsx(yt.Button,{value:"vehicle",children:"By Vehicle"})]}),n.jsx(vt,{placeholder:p==="mobile"?"Enter 10-digit Mobile":p==="vehicle"?"Enter Vehicle No (KA03AB1234)":"Enter Booking ID",value:y,inputMode:p==="mobile"?"numeric":"text",onChange:R=>{const k=R.target.value||"";if(p==="mobile"){const B=k.replace(/\D/g,"").slice(0,10);C(B)}else if(p==="vehicle"){const B=k.toUpperCase().replace(/[^A-Z0-9]/g,"");if(!$(B))return;C(B)}else C(N(k))},onPressEnter:()=>oe(),allowClear:!0}),f&&n.jsx(Ra,{type:"warning",showIcon:!0,message:f}),T&&n.jsx(io,{}),M.length>1&&n.jsx(yr,{size:"small",bordered:!0,dataSource:M,renderItem:Y})]})})]})}function wl({open:e,onClose:t,row:o,webhookUrl:r,secret:d}){const[i,m]=c.useState(!1),[u,p]=c.useState(!1),[h,y]=c.useState(null),C=c.useRef(null),T=c.useRef(!1),S=(j,N)=>String((N||[]).map(v=>j?.[v]??"").find(v=>v!=="")||"").trim(),M=j=>String(j||"").replace(/\D/g,"").slice(-10),w=j=>{if(!j)return null;if(typeof j=="object")return j;if(typeof j=="string")try{const N=JSON.parse(j);return N&&typeof N=="object"?N:null}catch{return null}return null},f=j=>{if(!j||typeof j!="object")return null;const N=j.values||j,v=w(j.payload)||w(j.Payload)||w(j.PAYLOAD)||w(N.payload)||w(N.Payload)||w(N.PAYLOAD)||{},H=w(j.rawPayload)||w(j["Raw Payload"])||w(N["Raw Payload"])||w(N.rawPayload)||w(v.rawPayload)||{},$={...H,...v},q={...H?.vehicle||{},...v?.vehicle||{}},se=$.customerName||$.name||S(N,["Customer Name","Customer_Name","Customer","Name"])||j.name||"",U=M($.mobileNumber||$.mobile||S(N,["Mobile Number","Mobile","Phone"])||j.mobile||""),me=$.address||S(N,["Address","Address Line","AddressLine"])||"",oe=$.branch||S(N,["Branch","Branch Name"])||j.branch||"",Y=$.executive||S(N,["Executive","Sales Executive"])||j.executive||"",R=$.rtoOffice||S(N,["RTO Office","RTO","RTO Code"])||"",k=$.purchaseMode||$.purchaseType||S(N,["Purchase Mode","Purchase Type","Payment Type","Mode"])||"",B=$.financier||S(N,["Financier","Financier Name","HP Financier","NOHP Financier"])||"",ne=$.addressProofMode||S(N,["Address Proof","Address Proof Mode"])||"",ee=q.company||$.company||S(N,["Company","company"])||"",W=q.model||$.model||S(N,["Model","model"])||"",Z=q.variant||$.variant||S(N,["Variant","variant"])||"",Q=q.color||$.color||S(N,["Color","Colour","Vehicle Color","Vehicle Colour"])||"",te=q.chassisNo||$.chassisNo||S(N,["Chassis No","Chassis Number","Chassis"])||"";let _=$.addressProofTypes||N?.["Address Proof Types"]||N?.["Proof Types"]||"";typeof _=="string"&&(_=_.split(",").map(pe=>pe.trim()).filter(Boolean));const ie=$.createdAt||$.savedAt||$.ts||S(N,["Submitted At","Timestamp","Created At","Date"])||new Date,ue={bookingAmount1Cash:S(N,["Booking Amount 1 Cash","bookingAmount1Cash"]),bookingAmount1Online:S(N,["Booking Amount 1 Online","bookingAmount1Online"]),bookingAmount2Cash:S(N,["Booking Amount 2 Cash","bookingAmount2Cash"]),bookingAmount2Online:S(N,["Booking Amount 2 Online","bookingAmount2Online"]),bookingAmount3Cash:S(N,["Booking Amount 3 Cash","bookingAmount3Cash"]),bookingAmount3Online:S(N,["Booking Amount 3 Online","bookingAmount3Online"]),paymentReference1:S(N,["Payment Reference 1","paymentReference1","UTR 1","Ref 1"]),paymentReference2:S(N,["Payment Reference 2","paymentReference2","UTR 2","Ref 2"]),paymentReference3:S(N,["Payment Reference 3","paymentReference3","UTR 3","Ref 3"]),bookingAmount:S(N,["Booking Amount","bookingAmount"])};return{...$,customerName:se,mobileNumber:U,address:me,branch:oe,executive:Y,rtoOffice:R,purchaseMode:k,financier:B,addressProofMode:ne,addressProofTypes:Array.isArray(_)?_:[],createdAt:ie,vehicle:{company:ee,model:W,variant:Z,color:Q,chassisNo:te,availability:te?"found":q.availability||$.availability||"allot"},bookingAmount1Cash:$.bookingAmount1Cash??ue.bookingAmount1Cash,bookingAmount1Online:$.bookingAmount1Online??ue.bookingAmount1Online,bookingAmount2Cash:$.bookingAmount2Cash??ue.bookingAmount2Cash,bookingAmount2Online:$.bookingAmount2Online??ue.bookingAmount2Online,bookingAmount3Cash:$.bookingAmount3Cash??ue.bookingAmount3Cash,bookingAmount3Online:$.bookingAmount3Online??ue.bookingAmount3Online,paymentReference1:$.paymentReference1??ue.paymentReference1,paymentReference2:$.paymentReference2??ue.paymentReference2,paymentReference3:$.paymentReference3??ue.paymentReference3,bookingAmount:$.bookingAmount??ue.bookingAmount}};c.useEffect(()=>{let j=!0;if(e)try{document.body.classList.add("print-host")}catch{}const N=()=>{try{document.body.classList.remove("print-host")}catch{}};return(async()=>{if(!(!e||!o)){m(!0);try{if(r&&o.bookingId){const H={action:"search",mode:"booking",query:o.bookingId};d&&(H.secret=d);const $=await rn({webhookUrl:r,method:"GET",payload:H}),q=$?.data||$,se=(Array.isArray(q?.rows)&&q.rows.length?q.rows[0]:null)||(Array.isArray(q?.data)&&q.data.length?q.data[0]:null),U=se?f(se):null;if(j&&U)y(U);else{const me=await rn({webhookUrl:r,method:"GET",payload:d?{action:"list",secret:d}:{action:"list"}}),oe=me?.data||me,R=(Array.isArray(oe?.data)?oe.data:Array.isArray(oe?.rows)?oe.rows:[]).find(B=>String(B["Booking ID"]||"").trim()===String(o.bookingId).trim()),k=R?f(R):null;j&&k&&y(k),j&&!k&&je.error("Booking not found in Sheet by Booking ID")}}else j&&(je.error("Missing Booking ID or webhook URL for print"),y(null))}catch{j&&(je.error("Failed to fetch booking from Sheet"),y(null))}finally{j&&m(!1)}}})(),()=>{j=!1,N()}},[e,o,r]);const I=async()=>{p(!0);try{await new Promise(j=>setTimeout(j,0)),await or(C.current)}catch{}finally{p(!1)}};c.useEffect(()=>{if(!e){T.current=!1;return}!i&&h&&!u&&!T.current&&(T.current=!0,I())},[e,i,h,u]);const E=n.jsx("div",{style:{display:e?"block":"none"},children:n.jsx(pa,{ref:C,active:!0,vals:h||{}})});return n.jsxs(gn,{open:e,title:"Print Booking",onCancel:t,footer:null,width:980,destroyOnClose:!0,children:[i?n.jsx("div",{style:{display:"grid",placeItems:"center",height:120},children:n.jsx(io,{})}):n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[n.jsx(ze,{onClick:t,disabled:u,children:"Close"}),n.jsx(ze,{type:"primary",onClick:I,disabled:!h||u,loading:u,children:"Print"})]}),E]})}const nr="FollowUps:BookingFormPrefill",ha=()=>typeof window<"u"&&typeof window.sessionStorage<"u",jl=e=>{if(!e||typeof e!="object")return e;const{rawPayload:t,files:o,documents:r,attachments:d,file:i,...m}=e,u={...m};return e.vehicle&&typeof e.vehicle=="object"&&(u.vehicle={...e.vehicle}),Array.isArray(e.payments)&&(u.payments=e.payments.map(p=>({amount:p?.amount,mode:p?.mode,reference:p?.reference||p?.utr||p?.ref||void 0,part:p?.part}))),u},Cl=e=>{if(!e||typeof e!="object")return{};const t=o=>o.map(r=>e?.[r]).find(r=>r!=null);return{bookingAmount:t(["Booking Amount","Booking_Amount","bookingAmount"]),collectedAmount:t(["Collected Amount","Collected_Amount","CollectedAmount","Amount"])}},Al=e=>{if(ha())try{const t=jl(e?.payload),o=Cl(e?.values),r={payload:t,values:o,metadata:{bookingId:e?.bookingId,mobile:e?.mobile,serialNo:e?.serialNo}};window.sessionStorage.setItem(nr,JSON.stringify(r))}catch{}},Nl=()=>{if(!ha())return null;try{const e=window.sessionStorage.getItem(nr);return e?(window.sessionStorage.removeItem(nr),JSON.parse(e)):null}catch{return null}},Zn={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};class kl extends ot.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,o){typeof window<"u"&&window.console&&console.error("FollowUps crashed",t,o)}render(){return this.state.hasError?n.jsxs("div",{style:{padding:16},children:[n.jsx("h3",{children:"Something went wrong in Follow-Ups."}),n.jsxs(qt,{children:[n.jsx(ze,{size:"small",type:"primary",onClick:()=>this.setState({hasError:!1,error:null}),children:"Try Again"}),n.jsx(ze,{size:"small",onClick:()=>window.location.reload(),children:"Reload"})]}),this.state.error&&n.jsx("pre",{style:{marginTop:12,whiteSpace:"pre-wrap",color:"#a00"},children:String(this.state.error)})]}):this.props.children}}const Do={pending:"orange",cancelled:"red",completed:"green",converted:"green",booked:"green",not_interested:"default",unreachable:"volcano",wrong_number:"magenta",purchased_elsewhere:"geekblue",no_response:"gold",seen:"blue",approved:"green",allotted:"purple"},Lo={pending:"Pending",cancelled:"Cancelled",completed:"Completed",converted:"Booked",booked:"Booked",not_interested:"Not Interested",unreachable:"Unreachable",wrong_number:"Wrong Number",purchased_elsewhere:"Purchased Elsewhere",no_response:"No Response",seen:"Seen",approved:"Approved",allotted:"Allotted"},{Title:Pl,Text:Tr}=ta,Fr={height:32,padding:"0 14px",borderRadius:999,fontSize:12,fontWeight:600},$l={borderRadius:18,border:"1px solid #eef2f7",boxShadow:"0 10px 34px rgba(15, 23, 42, 0.08)",background:"linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.92))"},Ol={borderRadius:16,border:"1px solid #eef2f7",background:"rgba(255,255,255,0.9)",boxShadow:"0 10px 26px rgba(15, 23, 42, 0.06)"},Qn={borderRadius:16,border:"1px solid #eef2f7",background:"rgba(255,255,255,0.92)",boxShadow:"0 8px 22px rgba(15, 23, 42, 0.05)"},Ir={fontSize:22,fontWeight:800,lineHeight:1},Mr={fontSize:11,color:"#64748b",marginTop:6},Br=typeof Intl<"u"?new Intl.NumberFormat("en-IN",{minimumFractionDigits:0,maximumFractionDigits:2}):null,so=e=>{if(e==null||Number.isNaN(Number(e)))return"";const t=Number(e),o=Br?Br.format(Math.abs(t)):String(Math.abs(t));return`${t<0?"-":""}${o}`},El=9,Rl=11,Tl=8e3,Fl=(e,t)=>{const o=Number(e||0),r=Number(t||0);return(o>0?r/o:0)>=.3?El:Rl},Il=(e,t,o)=>{const d=Math.max(Number(e||0)-Number(t||0),0)+Tl,i=o/12,m=Fl(e,t),u=d*(m/100)*i,p=d+u;return o>0?p/o:0},Ml=e=>String(e)==="12"?[12,18,24,36]:[24,30,36,48],Bl=(e,t,o)=>{const r=Ml(o);if(!Number(e||0))return"";const d=r.map(i=>`${i}:${so(Il(e,t,i))}`);return d.length?`EMI(${o}): ${d.join(" | ")}`:""},Dr=(e=[])=>Array.from(new Set((Array.isArray(e)?e:[]).map(t=>String(t||"").trim()).filter(Boolean))),Lr=e=>{if(!e)return{remarks:"",vehicles:[]};const t=e.payload||{},o=t.formValues||{},r=Dr(t.fittings),d=String(e.remarks||o.remarks||t.remarks||"").trim(),i=[],m=({label:p,company:h,model:y,variant:C,priceRaw:T,dpRaw:S,emiSetRaw:M,fittingsRaw:w})=>{const f=String(h||"").trim(),I=String(y||"").trim(),E=String(C||"").trim(),j=Number(T||0),N=Number(S||0),v=Dr(w||r),H=[f,I,E].filter(Boolean).join(" ");(H||v.length||j||N)&&i.push({label:p,title:H||"Vehicle details not available",fittings:v,priceText:j?so(j):"",dpText:N?so(N):"",emiText:j?Bl(j,N,M||t.emiSet||"12"):""})};return m({label:"Vehicle 1",company:o.company??t.company,model:o.bikeModel??o.model??t.model??e.model,variant:o.variant??t.variant??e.variant,priceRaw:o.onRoadPrice??t.onRoadPrice??e.price,dpRaw:o.downPayment??t.downPayment,emiSetRaw:t.emiSet,fittingsRaw:t.fittings}),(Array.isArray(t.extraVehicles)?t.extraVehicles:[]).forEach((p,h)=>{m({label:`Vehicle ${h+2}`,company:p.company,model:p.model,variant:p.variant,priceRaw:p.onRoadPrice,dpRaw:p.downPayment,emiSetRaw:p.emiSet||t.emiSet,fittingsRaw:p.fittings})}),{remarks:d,vehicles:i}};function Dl({mode:e="quotation",webhookUrl:t,onClose:o}){const r=Pa(),i=!rr.useBreakpoint().md,[m,u]=c.useState(!1),[p,h]=c.useState(null),[y,C]=c.useState([]),[T,S]=c.useState(!1),[M,w]=c.useState("all"),[f]=c.useState(!1),[I,E]=c.useState("all"),j=1e4,[N,v]=c.useState("all"),[H,$]=c.useState({name:"",branch:""}),[q,se]=c.useState(""),[U,me]=c.useState([]),[oe,Y]=c.useState({open:!1,serial:null,at:null,notes:""}),[R,k]=c.useState({open:!1,serial:null,status:"converted",details:"",boughtFrom:"",offer:""}),[B,ne]=c.useState(!1),[ee,W]=c.useState(!1),[Z,Q]=c.useState({open:!1,row:null}),te=ot.useRef(null),[_,ie]=c.useState(!1),[ue,pe]=c.useState(null),[ye,fe]=c.useState(null),[ve,ke]=c.useState(""),[re,le]=c.useState(null),[Ae,Ke]=c.useState(1),[Pe,xe]=c.useState(50),[Et,xt]=c.useState(!1),St=String(q||"").toLowerCase(),Xe=["owner","admin"].includes(St),We=String(H.branch||U[0]||"").trim(),at=Xe?I&&I!=="all"?I:"":We,wt=Xe?I||"all":We||"all",Rt=Xe?at:We,Bt=!Xe||!!at,Jt=ot.useMemo(()=>{const a=new Set,l=[],b=g=>{const A=String(g||"").trim();!A||a.has(A)||(a.add(A),l.push(A))};return U.forEach(b),b(We),[{value:"all",label:"All Branches"},...l.map(g=>({value:g,label:g===We?`${g} (My Branch)`:g}))]},[U,We]),Yt=Zn?.VITE_BOOKING_GAS_SECRET||"";c.useEffect(()=>{(async()=>{let l=(()=>{try{const J=localStorage.getItem("user");return J?JSON.parse(J):null}catch{return null}})();if(!l||!l.formDefaults){const J=await $a().catch(()=>null);if(J?.success&&J.data){l=J.data;try{localStorage.setItem("user",JSON.stringify(l))}catch{}}}const b=l?.formDefaults?.staffName||l?.name||"",g=l?.formDefaults?.branchName||l?.primaryBranch?.name||"",A=[];g&&A.push(g),Array.isArray(l?.branches)&&l.branches.forEach(J=>{const ce=typeof J=="string"?J:J?.name||J?.label||J?.title||"";ce&&A.push(ce)});const F=Array.from(new Set(A.filter(Boolean)));me(F),se(String(l?.role||"").toLowerCase()),$({name:b,branch:F[0]||g||""})})()},[]);const jt=String(e||"").toLowerCase(),Ve=jt==="jobcard",Re=jt==="booking",Tt=!Ve&&!Re,Ft=a=>{if(Re){const l=ho(a);if(l)return l;if(a.bookingPayment?.hasTarget)return a.bookingPayment.isPending?"pending":"completed"}return String(a.status||"").toLowerCase()},It=a=>Ft(a)==="pending";ot.useEffect(()=>{Ve&&M!=="all"&&w("all")},[Ve]),ot.useEffect(()=>{Re&&M!=="all"&&w("all")},[Re]),ot.useEffect(()=>{Tt&&M==="overdue"&&w("all")},[Tt]);const Dt=async({method:a="GET",payload:l})=>Ve?await hr({webhookUrl:t,method:a,payload:l}):await rn({webhookUrl:t,method:a,payload:l}),Lt=ot.useMemo(()=>`FollowUps:${JSON.stringify({mode:jt,filter:M,branch:wt,jobStatus:N})}`,[jt,M,wt,N]),de=a=>{if(!a)return null;if(He.isDayjs(a))return a;const l=He(a);return l.isValid()?l:null},Se=(a=[])=>a.map(l=>{const b=de(l.followUpAt),g=de(l.dateAt);return{...l,followUpAt:b,dateAt:g,sortAtMs:l.sortAtMs||(g?g.valueOf():0)}});c.useEffect(()=>{try{const a=localStorage.getItem(Lt);if(!a){S(!1);return}const l=JSON.parse(a);l&&Array.isArray(l.rows)?(C(Se(l.rows)),l.at&&h(He(l.at)),S(!0)):S(!1)}catch{S(!1)}},[Lt]);const $e=a=>{try{const b=new URL(a);if(b.hostname.includes("drive.google.com")){const g=b.pathname.split("/"),A=g.indexOf("d");if(A>=0&&g[A+1])return g[A+1];const F=b.searchParams.get("id");if(F)return F}}catch{}const l=String(a||"").match(/[?&]id=([^&]+)/);return l?l[1]:null},he=a=>{if(!a)return{view:"",download:"",embed:""};const l=$e(a);return l?{view:`https://drive.google.com/uc?export=view&id=${l}`,download:`https://drive.google.com/uc?export=download&id=${l}`,embed:`https://drive.google.com/file/d/${l}/preview`}:{view:a,download:a,embed:a}},Ce=({url:a})=>{if(!a)return n.jsx("span",{style:{color:"#999"},children:""});const{view:l,download:b,embed:g}=he(a),A=n.jsxs("div",{style:{width:320},children:[n.jsx("div",{style:{height:220,border:"1px solid #e5e7eb",borderRadius:8,overflow:"hidden",marginBottom:8},children:n.jsx("iframe",{src:g,title:"preview",width:"100%",height:"100%",style:{display:"block",border:0},allow:"fullscreen"})}),n.jsxs(qt,{children:[n.jsx("a",{href:l,target:"_blank",rel:"noopener",children:"Open"}),n.jsx("a",{href:b,children:"Download"})]})]});return n.jsxs(qt,{size:6,children:[n.jsx(Tn,{content:A,title:"Preview",trigger:"click",children:n.jsx(ze,{size:"small",title:"Preview","aria-label":"Preview",children:""})}),n.jsx("a",{href:b,title:"Download","aria-label":"Download",children:""})]})},ae=a=>{if(a==null||a==="")return 0;const l=String(a).replace(/[^0-9.-]/g,""),b=Number(l);return Number.isFinite(b)?b:0},Ze=(a={},l=[])=>l.reduce((b,g)=>b+ae(a?.[g]),0),ht=a=>(Array.isArray(a)?a:[]).reduce((l,b)=>l+ae(b?.amount),0),st=({payload:a={},values:l={},collected:b=0})=>{const g=[a.bookingAmount,a.bookingTarget,l["Booking Amount"],l.Booking_Amount,l.bookingAmount,l["Total Booking Amount"]].map(ae).find(De=>De>0),A=Ze(a,["bookingAmount1","bookingAmount2","bookingAmount3"])||Ze(l,["Booking Amount 1","Booking Amount 2","Booking Amount 3"]),F=g||A||0,J=[ae(a.totalCollected),ae(a.cashCollected)+ae(a.onlineCollected),ht(a.payments),Ze(a,["bookingAmount1Cash","bookingAmount1Online","bookingAmount2Cash","bookingAmount2Online","bookingAmount3Cash","bookingAmount3Online"]),Ze(l,["Booking Amount 1 Cash","Booking Amount 1 Online","Booking Amount 2 Cash","Booking Amount 2 Online","Booking Amount 3 Cash","Booking Amount 3 Online"]),ae(l["Collected Amount"]),ae(l.Amount),ae(b)],ce=Math.max(...J,0),X=F>0,Fe=X?ce+.01<F:null;return{target:F,paid:ce,hasTarget:X,isPending:Fe}},sn=.01,Mn=/balance/i,it=a=>{if(a==null)return null;if(typeof a=="object")return a;if(typeof a!="string")return null;try{return JSON.parse(a)}catch{return null}},lt=a=>{const l=Number(a);return Number.isFinite(l)&&l>=0?l:null},Zt=(...a)=>{for(const l of a){if(!l&&l!==0)continue;if(typeof l=="object")return l;const b=it(l);if(b)return b}return null},_t=a=>{if(a==null)return{found:!1};const l=typeof a;if(l==="object"||l==="boolean")return{found:!1};if((l==="string"?a.trim():String(a).trim())==="")return{found:!1};const g=ae(a);return Number.isFinite(g)?{found:!0,value:g}:{found:!1}},ct=a=>{const l=_t(a);return l.found?l.value:null},Qt=(a,l,b=3,g=new WeakSet)=>{if(!a||typeof a!="object"||b<0)return[];if(g.has(a))return[];g.add(a);const A=Array.isArray(a)?a.map((J,ce)=>[String(ce),J]):Object.entries(a),F=[];for(const[J,ce]of A){if(l.test(String(J||""))){const X=_t(ce);X.found&&F.push(X.value)}if(ce&&typeof ce=="object")F.push(...Qt(ce,l,b-1,g));else if(typeof ce=="string"){const X=it(ce);X&&typeof X=="object"&&F.push(...Qt(X,l,b-1,g))}}return F};function ho(a){if(!Re)return null;const l=typeof a?.balanceValue=="number"?a.balanceValue:null;if(l!==null)return l>sn?"pending":"completed";const b=Qt(a.payload,Mn,3),g=Qt(a.values,Mn,2),A=[...b,...g];return A.length?A.some(J=>J>sn)?"pending":"completed":null}const go=({payload:a,values:l,rawPayload:b,fallback:g})=>{const A=[];if(a&&typeof a=="object"&&A.push(a),l&&typeof l=="object"&&A.push(l),b){const F=it(b);F&&typeof F=="object"&&A.push(F)}return g&&typeof g=="object"&&A.push(g),A},bn=(a,l=[])=>{if(!Array.isArray(a))return[];const b=[];for(const g of a)if(!(!g||typeof g!="object"))for(const A of l){const F=Bn(g,A);if(F==null)continue;const J=_t(F);J.found&&b.push(J.value)}return b},Bn=(a,l=[])=>{if(!(!a||!l.length))return l.reduce((b,g)=>{if(!(!b||typeof b!="object"))return b[g]},a)},Ct=a=>{const l=a?.payload||{},b=a?.values||{},g=["purchaseMode","purchase_mode","purchase type","Purchase Mode","Purchase_Mode","Purchase Type","paymentMode","payment_mode","Payment Mode","Payment Type","paymentType","payment_type"],F=[l.purchaseMode,l.purchaseType,l.paymentType,...g.map(J=>b[J])].find(J=>typeof J=="string"&&J.trim());return String(F||"cash").trim().toLowerCase()},yn=a=>{if(!a)return!1;const l=String(a).trim().toLowerCase();return["loan","nohp","hp","finance"].includes(l)},bo=({payload:a={},values:l={},rawPayload:b=null,purchaseType:g}={})=>{if(!a||typeof a!="object")return{pendingAmount:null,pendingLabel:""};const A=Zt(b,l?.rawPayload,l?.["Raw Payload"],a?.rawPayload,a?.["Raw Payload"])||{},F=[ae(a?.bookingAmount),ae(l?.["Booking Amount"]),ae(l?.bookingAmount),ae(l?.Booking_Amount),ae(A?.bookingAmount)].find(L=>L>0)??0,J=[ae(A?.totalVehicleCost),ae(A?.cash?.totalVehicleCost),ae(A?.cash?.onRoadPrice),ae(a?.totalVehicleCost),ae(a?.onRoadPrice),ae(l?.["Total Vehicle Cost"]),ae(l?.["On Road Price"])].find(L=>L>0)??0,ce=[ae(A?.totalDp),ae(A?.dp?.totalDp),ae(a?.totalDp),ae(a?.dp?.totalDp),ae(l?.["Total DP"])].find(L=>L>0)??0,X=ae(A?.downPayment||a?.downPayment||l?.["Down Payment"])+ae(A?.extraFittingAmount||a?.extraFittingAmount||l?.["Extra Fitting Amount"])+ae(A?.affidavitCharges||a?.affidavitCharges||l?.["Affidavit Charges"]),Be=ce||X||0,Fe=String(g||a?.purchaseMode||l?.["Purchase Mode"]||A?.purchaseMode||"cash").trim().toLowerCase(),De=["loan","nohp","hp","finance"].includes(Fe),et=De?"Balanced DP":"Balance Amount",ut=De?Be-F:J-F,mt=Math.max(0,Number.isFinite(ut)?ut:0);return a.pendingBalance=mt,a.pendingType=et,{pendingAmount:mt,pendingLabel:et}},ln=(...a)=>{const l=[],b=g=>{if(!(!g||typeof g!="object")){if(Array.isArray(g)){g.forEach(b);return}"payments"in g&&Array.isArray(g.payments)&&b(g.payments),"paymentSplit"in g&&Array.isArray(g.paymentSplit)&&g.paymentSplit.forEach(A=>{A&&typeof A=="object"&&l.push(A)}),"paymentDetails"in g&&Array.isArray(g.paymentDetails)&&b(g.paymentDetails),!("payments"in g)&&!("paymentSplit"in g)&&!("paymentDetails"in g)&&l.push(g)}};return a.forEach(g=>{if(g){if(Array.isArray(g)){g.forEach(b);return}if(typeof g=="string"){try{const A=JSON.parse(g);b(A)}catch{return}return}b(g)}}),l},Dn=({payload:a,values:l,rawPayload:b})=>{const g=l||{},A=ln(a?.payments,g.payments,g.paymentDetails,a?.paymentSplit,g.paymentSplit,b?.payments,b?.paymentSplit,b?.paymentDetails),F={cash:0,online:0,total:0};A.forEach(Fe=>{const De=lt(Fe?.amount);if(De===null)return;const et=String(Fe?.mode||"").trim().toLowerCase();et==="cash"?F.cash+=De:et==="online"&&(F.online+=De),F.total+=De});const J=lt(a?.dp?.totalDp)??lt(a?.totalDp)??lt(a?.downPayment)??lt(g.totalDp)??lt(g.downPayment)??lt(b?.dp?.totalDp)??lt(b?.totalDp)??lt(b?.downPayment),ce=J!==null,X=ce?J:0,Be=Math.max(0,X-F.total);return{cashCollected:F.cash,onlineCollected:F.online,totalCollected:F.total,totalDp:X,balancedDp:Be,hasTotals:ce,hasPayments:A.length>0}},yo=[["dp","balancedDp"],["dp","balanceTP"],["dp","balanceTPIC"],["balanceTP"],["balancedDp"],["balance"]],vn=[["balancedAmount"],["balanceAmount"],["cash","balancedAmount"],["balance"],["dp","balancedDp"]],Ln=[["cash","totalVehicleCost"],["cash","onRoadPrice"],["cash","price"],["vehicle","totalVehicleCost"],["vehicle","onRoadPrice"],["vehicle","price"],["totalVehicleCost"],["onRoadPrice"],["price"]],_n=a=>{const l=a?.target;return!l||typeof l.closest!="function"?!1:!!l.closest("button, a, input, textarea, [role='button']")},zn=a=>String(a||"").replace(/\D/g,"").slice(-10),Vn=a=>{if(!a)return;xt(!0),Al({payload:a.payload,values:a.values,bookingId:a.bookingId,mobile:a.mobile,serialNo:a.serialNo});const l=zn(a.mobile||a.values?.Mobile||a.values?.mobile);typeof o=="function"&&o(),r("/bookingform",{state:l?{autoFetch:{mode:"mobile",query:l}}:void 0}),xt(!1)};c.useEffect(()=>()=>{xt(!1)},[]);const vo=(a,l)=>{const b=l||{},g=a||{},A=["File URL","File","Document URL","Document","Doc URL","Doc","Drive URL","Drive","fileUrl","file","documentUrl","document","driveUrl"];for(const ce of A){const X=b[ce]??g[ce];if(typeof X=="string"&&X.trim())return X.trim()}const F=[g.files,g.documents,g.attachments,g.docs];for(const ce of F)if(Array.isArray(ce)){const X=ce.find(Fe=>typeof Fe=="string"&&Fe.trim());if(X)return X.trim();const Be=ce.find(Fe=>Fe&&typeof Fe.url=="string"&&Fe.url.trim());if(Be)return Be.url.trim()}const J=ce=>{try{for(const X of Object.keys(ce||{})){const Be=ce[X];if(typeof Be=="string"&&/^https?:\/\//i.test(Be))return Be}}catch{}return""};return J(b)||J(g)||""},zt=a=>String(a||"").trim().toLowerCase(),xn=async()=>{u(!0);try{if(!t){C([]),u(!1),je.info("Follow-ups webhook not configured.");return}const a=Zn?.VITE_BOOKING_GAS_SECRET||"",l=Zn?.VITE_JOBCARD_GAS_SECRET||"",b=Rt,g=Re?(()=>{const L=a?{action:"list",page:1,pageSize:j,secret:a}:{action:"list",page:1,pageSize:j};return b?{...L,branch:b}:L})():{action:"list",branch:b||"",page:1,pageSize:j};let A=await Dt({method:"GET",payload:g}).catch(()=>null),F=A?.data||A||{},J=Array.isArray(F?.rows)?F.rows:Array.isArray(F?.data)?F.data:[];const ce=L=>{if(!L)return null;if(L.payload&&typeof L.payload=="object")return L.payload;if(typeof L.payload=="string")try{return JSON.parse(L.payload)}catch{}const K=L.values&&(L.values.Payload||L.values.payload||L.values.PAYLOAD)||L.Payload||L.PAYLOAD;if(typeof K=="string")try{return JSON.parse(K)}catch{}return L.formValues&&(L.followUp||L.savedAt||L.postServiceAt)?L:null},X=L=>{if(L==null||L==="")return null;try{if(He.isDayjs(L))return L.isValid()?L:null;if(L instanceof Date){const Ie=He(L);return Ie.isValid()?Ie:null}if(typeof L=="number"){const Ie=He(L);return Ie.isValid()?Ie:null}const K=String(L).trim();if(!K)return null;const z=Number(K);if(!Number.isNaN(z)&&K.length>=10){const Ie=He(z);if(Ie.isValid())return Ie}const be=new Date(K);if(!Number.isNaN(be.getTime()))return He(be);const x=K.match(/^(\d{1,2})([/-])(\d{1,2})\2(\d{2,4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(x){const Ie=x[2];let gt=parseInt(x[1],10),kn=parseInt(x[3],10),un=parseInt(x[4],10);un<100&&(un+=2e3);let nn,mn;Ie==="-"||gt>12?(mn=gt,nn=kn-1):(nn=gt-1,mn=kn);let on=x[5]?parseInt(x[5],10):0;const No=x[6]?parseInt(x[6],10):0,Gn=x[7]?parseInt(x[7],10):0,Je=(x[8]||"").toUpperCase();Je==="PM"&&on<12&&(on+=12),Je==="AM"&&on===12&&(on=0);const Pn=new Date(un,nn,mn,on,No,Gn);if(!Number.isNaN(Pn.getTime()))return He(Pn)}const kt=He(K);return kt.isValid()?kt:null}catch{return null}},Be=(...L)=>L.find(K=>typeof K=="string"?K.trim():K)||null,Fe=J.map((L,K)=>{const z=ce(L)||{},be=z.formValues||{},x=L&&L.values?L.values:L||{},kt=Zt(z.rawPayload,x?.["Raw Payload"],x?.rawPayload,x?.RawPayload,x?.rawpayload,L.rawPayload,L.payload?.rawPayload),Ie=z.followUp||z.followup||z.follow_up||{},gt=Ve?be.jcNo||be.JCNo||z.jcNo||z.JCNo||be.serialNo||z.serialNo||"-":Re?be.bookingId||z.bookingId||x["Booking ID"]||x.Booking_Id||x["Booking Id"]||"-":be.serialNo||z.serialNo||x["Quotation No."]||x["Quotation No"]||x.Serial||"-",kn=z.company||be.company||x.Company||"",un=z.model||z.vehicle?.model||be.bikeModel||be.model||x.Model||"",nn=z.variant||z.vehicle?.variant||be.variant||x.Variant||"",mn=z.color||z.vehicle?.color||be.color||x.Color||x.Colour||x["Vehicle Color"]||x["Vehicle Colour"]||"",on=[kn,un,nn].filter(Boolean).join(" "),No=be.branch||z.branch||x.Branch||x["Branch Name"]||"-",Gn=(()=>{if(z.postServiceAt||Array.isArray(z.payments)&&z.payments.some(Ro=>Number(Ro?.amount||0)>0)||x["Post Service At"]||x.PostServiceAt||x.Post_Service_At)return!0;const Kn=Ro=>String(x[Ro]||"").trim().toLowerCase();return!!["yes","done","completed","true"].includes(Kn("Post Service"))})();let Je=Be(z.postServiceAt,z.savedAt,z.ts,z.tsMs,z.createdAt,kt?.ts,kt?.createdAt,x["Post Service At"],x.PostServiceAt,x.Post_Service_At,x["Saved At"],x.savedAt,x.Timestamp,x.timestamp,x.TS,x.DateTime,x["Date Time"],x.Date_Time,x["Submitted At"],x.SubmittedAt,x.submittedAt,x["Created At"],x.CreatedAt,x.createdAt,x.Time,x.Date,L?.tsMs,L?.ts,L?.dateTimeIso);(Je==null||Je==="")&&x.Date&&x.Time&&(Je=`${x.Date} ${x.Time}`);const Pn=(()=>{if(Je==null||Je==="")return null;if(typeof Je=="number")return X(Je);const bt=Number(Je);return!Number.isNaN(bt)&&String(Je).trim()!==""&&bt>1e7?X(bt):X(Je)})();let ko=Ie.at??Ie.followUpAt??Ie.followupAt??Ie.date??Ie.datetime??z.followUpAt??z.followupAt??z.followUpDate??z.followupDate??x["Follow-up At"]??x["Follow Up At"]??x["Followup At"]??x["Follow-up Date"]??x["Follow Up Date"]??x["Followup Date"]??x["Next Follow-up"]??x["Next Follow Up"]??x["Next Followup"]??x["Follow-up"]??x["Follow Up"]??x.Followup;if(!ko){const bt=x["Follow-up Date"]||x["Follow Up Date"]||x["Followup Date"]||"",Kn=x["Follow-up Time"]||x["Follow Up Time"]||x["Followup Time"]||"";bt&&Kn&&(ko=`${bt} ${Kn}`)}const Po=X(ko),$o=Pn||Po,ga=$o&&typeof $o.valueOf=="function"?$o.valueOf():0,ba=Pn||null,ya=be.amount||x["Collected Amount"]||x.Amount||0,va=Re?st({payload:z,values:x,collected:ya}):null,xa=kt||z.rawPayload||x?.rawPayload||x?.["Raw Payload"]||x?.RawPayload||L.rawPayload,pn={payload:z,values:x,rawPayload:xa},Oo=go({payload:z,values:x,rawPayload:pn.rawPayload,fallback:kt||it(pn.rawPayload)}),ar=yn(Ct(pn)),pt=Dn({payload:z,values:x,rawPayload:kt||pn.rawPayload}),Sa=Ct(pn),Eo=bo({payload:z,values:x,rawPayload:pn.rawPayload,purchaseType:Sa}),wa=Re&&pt.hasTotals?pt.balancedDp>sn?"pending":"completed":null,sr=bn(Oo,vn),ir=bn(Oo,yo),lr=bn(Oo,Ln),ja=Number.isFinite(pt.totalCollected)?pt.totalCollected:0,cr=lr.length?Math.max(...lr):null,dr=cr!==null?Math.max(0,cr-ja):null,Ca=ct(z?.cash?.balancedAmount)??ct(z?.balancedAmount)??ct(x?.balancedAmount)??ct(x?.balanceAmount)??(sr.length?Math.max(...sr):null)??(dr!==null?dr:null),ur=ct(z?.dp?.balancedDp)??ct(z?.balancedDp)??ct(x?.balancedDp)??(ir.length?Math.max(...ir):null)??(pt.hasTotals?pt.balancedDp:null),mr=Number.isFinite(Eo?.pendingAmount)?Eo.pendingAmount:null,Aa=Eo?.pendingLabel||"",pr=mr!==null?mr:ar&&ur!==null?ur:Ca,Na=Aa||(ar&&pr!==null?"Balanced DP":"Balanced Amount");return{key:gt||K,serialNo:gt||"-",bookingId:Re&&gt&&gt!=="-"?gt:"",name:be.custName||be.name||x.Customer_Name||x["Customer Name"]||x.Customer||x.Name||"-",mobile:be.custMobile||be.mobile||x.Mobile||x["Mobile Number"]||x.Phone||"-",vehicle:on,branch:String(No||"-").trim(),executive:be.executive||Ie.assignedTo||x.Executive||"-",followUpAt:Po,dateAt:ba||Po||null,sortAtMs:ga,followUpNotes:Ie.notes??z.followupNotes??z.followUpNotes??x["Follow-up Notes"]??x["Follow Up Notes"]??x["Followup Notes"]??"",closeReason:Ie.closeReason||z.closeReason||be.closeReason||"",status:Ve?Gn?"completed":"pending":Re?wa||(()=>{const bt=Ie.status||z.status||be.status||x.Status||x["Booking Status"]||"";return String(bt||"pending").toLowerCase()})():(()=>{const bt=Ie.status||z.status||be.status||x.Status||x["Booking Status"]||"";return String(bt||"pending").toLowerCase()})(),price:Number((be.onRoadPrice??z.onRoadPrice??be.price??z.price)||0),brand:(z.brand||"").toUpperCase()||"SHANTHA",remarks:be.remarks||z.remarks||x.Remarks||x.remarks||"",jcNo:be.jcNo||z.jcNo||x["JC No"]||x["JC No."]||x["Job Card No"]||gt||"-",regNo:be.regNo||x["Vehicle No"]||x.Vehicle_No||"",model:un,variant:nn,color:mn,amount:be.amount||x["Collected Amount"]||x.Amount||0,availability:x["Chassis Availability"]||x.Availability||x.Stock||x["Stock Status"]||z?.vehicle?.availability||be?.vehicle?.availability||"",fileUrl:vo(z,x),postServiced:Gn,payload:z,values:x,bookingPayment:va,balanceValue:pr,balanceLabel:Na,cashCollected:pt.cashCollected,onlineCollected:pt.onlineCollected,totalCollected:pt.totalCollected,totalDp:pt.hasTotals?pt.totalDp:void 0,balancedDp:pt.balancedDp}}),De=He().startOf("day"),et=He().endOf("day"),ut=Ve?(()=>{let L=Fe;if(N!=="all"){const K=String(N).toLowerCase();L=L.filter(z=>String(z.status||"").toLowerCase()===K)}return L})():Fe.filter(L=>{const K=zt(L.branch),z=zt(We),be=at?zt(at):"";if(Xe){if(be&&K!==be)return!1}else if(!z||K!==z)return!1;if(M==="all")return!0;const x=L.followUpAt&&L.followUpAt.isValid&&L.followUpAt.isValid()?L.followUpAt:L.dateAt;return!x||!x.isValid()?!1:M==="today"?!x.isBefore(De)&&!x.isAfter(et):M==="overdue"?x.isBefore(De):M==="upcoming"?x.isAfter(et):!0}),mt=L=>It(L)?0:1;ut.sort((L,K)=>{const z=mt(L),be=mt(K);if(z!==be)return z-be;const x=Number(K.sortAtMs||0),kt=Number(L.sortAtMs||0);return x-kt}),C(ut),h(He());try{localStorage.setItem(Lt,JSON.stringify({at:Date.now(),rows:ut}))}catch{}}catch(a){console.warn("followups fetch failed",a),je.error("Could not fetch follow-ups. Check the Apps Script.")}finally{u(!1)}};c.useEffect(()=>{!t||Bt&&!Rt||xn()},[t,M,f,I,We,e,St,U.length,N,Bt,Rt,Xe]);const cn=async(a,l)=>{try{const g={branch:Xe?at||l?.branch||We:We||l?.branch||U[0]||"",...l};if(g?.followUp?.notes){const J=g.followUp.notes;g.notes=g.notes??J,g.followupNotes=g.followupNotes??J}if(g?.closeNotes){const J=g.closeNotes;g.notes=g.notes??J,g.followupNotes=g.followupNotes??J}const A=await Dt({method:"POST",payload:{action:"updateFollowup",serialNo:a,patch:g}});if(!(A?.data||A)?.success)throw new Error("Failed");return je.success("Updated"),await xn(),!0}catch{return je.error("Update failed"),!1}},Sn=a=>{const l=He().format("DD-MM-YYYY HH:mm"),b=String(a||"").trim();return b?`${l} - ${b}`:l},Vt=a=>a&&a.isValid&&a.isValid()?a.format("DD-MM-YYYY HH:mm"):"",Oe={display:"flex",flexDirection:"column",gap:2,lineHeight:1.2},Ee={whiteSpace:i?"normal":"nowrap",overflow:"hidden",textOverflow:i?"clip":"ellipsis"},Te={...Ee,fontSize:i?12:11},Qe={display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:i?4:3,overflow:"hidden",whiteSpace:"normal",fontSize:i?11:10,lineHeight:1.25},Un={...Qe,WebkitLineClamp:2,fontSize:i?11:10.5,fontWeight:600,color:"#1f2937"},At=ot.useMemo(()=>{let a=Array.isArray(y)?y.slice():[];if(re&&re[0]&&re[1]){const b=re[0].startOf("day"),g=re[1].endOf("day");a=a.filter(A=>{const F=A.followUpAt||A.dateAt;return!F||!F.isValid||!F.isValid()?!1:!F.isBefore(b)&&!F.isAfter(g)})}const l=String(ve||"").trim().toLowerCase();return l&&(a=a.filter(b=>[b.serialNo,b.bookingId,b.jcNo,b.name,b.mobile,b.branch,b.executive,b.vehicle,b.model,b.variant,b.color,b.regNo,b.status,b.remarks,b.followUpNotes,b.closeReason].filter(Boolean).join(" ").toLowerCase().includes(l))),a},[y,re,ve]),dt=ot.useMemo(()=>{const a=Array.isArray(At)?At:[],l=a.length,b=a.filter(A=>Ft(A)==="pending").length,g=a.filter(A=>Ft(A)!=="pending").length;return{total:l,pending:b,completed:g,other:0}},[At,Re]);c.useEffect(()=>{Ke(1)},[ve,re,M,N,I,e]),c.useEffect(()=>{const a=Math.max(1,Math.ceil(At.length/Pe));Ae>a&&Ke(1)},[At.length,Ae,Pe]);const en=i?"100%":void 0,tn=i?10:12,Nt=i?110:120,Wn=i?160:180,wn=i?{...Ir,fontSize:18}:Ir,jn=i?{...Mr,fontSize:10}:Mr,xo=a=>{const l=String(a?.mobile||"").replace(/\D/g,"").slice(-10),b=String(a?.jcNo||a?.serialNo||"").trim(),g=new URLSearchParams;g.set("autoFetch","1"),l?(g.set("mode","mobile"),g.set("query",l)):b&&(g.set("mode","jc"),g.set("query",b)),b&&g.set("jcNo",b);const A=g.toString();r(A?`/jobcard?${A}`:"/jobcard")},Cn=a=>{if(!a)return null;if(a.payload&&typeof a.payload=="object")return a.payload;const l=a.payload||a.Payload||a.PAYLOAD||a?.values?.Payload||a?.values?.payload||a?.values?.PAYLOAD||a?._raw?.payload||a?._raw?.Payload||a?._raw?.PAYLOAD||a?._raw?.values?.Payload||a?._raw?.values?.payload||a?._raw?.values?.PAYLOAD||"";if(l&&typeof l=="object")return l;if(l&&typeof l=="string")try{return JSON.parse(l)}catch{return null}return a.formValues||a.values?a:null},dn=(a,l)=>{if(!a)return null;const b=a.formValues||a.values||{},g=Array.isArray(a.labourRows)?a.labourRows:Array.isArray(b.labourRows)?b.labourRows:[],A=a.totals||b.totals||{},F=g.reduce((X,Be)=>X+Number(Be?.qty||0)*Number(Be?.rate||0),0),J={labourSub:A.labourSub??F,labourGST:A.labourGST??0,labourDisc:A.labourDisc??0,grand:A.grand??F},ce=a.postServiceAt||a.createdAt||a.savedAt||l?.postAt||l?.ts||new Date;return{vals:{jcNo:l?.jcNo||b.jcNo||"",regNo:l?.regNo||b.regNo||"",custName:l?.name||b.custName||b.name||"",custMobile:l?.mobile||b.custMobile||b.mobile||"",km:b.km||"",model:l?.model||b.model||"",colour:b.colour||l?.colour||"",branch:l?.branch||b.branch||"",executive:l?.executive||b.executive||"",createdAt:ce,labourRows:g,gstLabour:A.gstLabour||A.labourGST||0},totals:J}},So=async a=>{if(!a)return;if(String(a.status||"").toLowerCase()!=="completed"){je.warning("Complete post-service to generate the service invoice.");return}if(!t){je.error("Jobcard webhook is not configured.");return}const b=a.jcNo||a.key||a.mobile||"";fe(b);try{let g=Cn(a),A=g?dn(g,a):null;const F=Array.isArray(A?.vals?.labourRows)&&A.vals.labourRows.length>0;if(!A||!F){const J=String(a.mobile||"").replace(/\D/g,"").slice(-10);if(J.length===10){const ce=Zn?.VITE_JOBCARD_GAS_SECRET||"",X={action:"search",mode:"mobile",query:J},Be=ce?{...X,secret:ce}:X,Fe=await hr({webhookUrl:t,method:"GET",payload:Be}),De=Fe?.data||Fe,et=Array.isArray(De?.rows)?De.rows:Array.isArray(De?.data)?De.data:[];if(et.length){let ut=et[0];if(a.jcNo){const L=et.find(K=>{const z=Cn(K),x=(z?.formValues||z?.values||{}).jcNo||K?.jcNo||K?.values?.["JC No"]||K?.values?.["JC No."]||K?.values?.["Job Card No"]||"";return String(x||"").trim()===String(a.jcNo||"").trim()});L&&(ut=L)}const mt=Cn(ut);A=mt?dn(mt,a):A}}}if(!A){je.error("Could not load service invoice data.");return}pe(A),ie(!0),setTimeout(()=>{try{or(te.current)}catch{}setTimeout(()=>ie(!1),500)},50)}catch{je.error("Could not generate service invoice.")}finally{fe(null)}},An={fontSize:i?9:10,lineHeight:"1.1",marginRight:0},wo={height:i?22:26,padding:i?"0 8px":"0 10px",borderRadius:999,fontSize:i?11:12,fontWeight:700},jo={height:i?22:26,padding:i?"0 8px":"0 10px",borderRadius:999,fontSize:i?11:12},Co={height:i?20:22,padding:i?"0 6px":"0 8px",borderRadius:999,fontSize:i?10:11,fontWeight:600},Ao={height:i?20:22,padding:i?"0 6px":"0 8px",borderRadius:999,fontSize:i?10:11},Hn={height:i?20:18,padding:"0 6px",fontSize:i?11:10},qn=a=>{const l=String(a.status||"").toLowerCase(),b=l==="pending",g=l==="completed",A=ye===(a.jcNo||a.key||a.mobile||""),F={display:"flex",flexDirection:"column",gap:2,lineHeight:1.1};return n.jsxs("div",{style:F,children:[n.jsx(Gt,{title:a.closeReason||a.followUpNotes||"",children:n.jsx(rt,{color:Do[a.status]||"default",style:An,children:Lo[a.status]||a.status})}),b?n.jsx(ze,{size:"small",type:"primary",icon:n.jsx(ml,{}),style:wo,onClick:()=>xo(a),children:"Post Service"}):g?n.jsx(ze,{size:"small",type:"default",icon:n.jsx(Or,{}),loading:A,style:jo,onClick:()=>So(a),children:"Service Invoice"}):n.jsx("span",{style:{fontSize:10,color:"#999"},children:""})]})},Nn=a=>n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,lineHeight:1.1},children:[n.jsx(Gt,{title:a.closeReason||a.followUpNotes||"",children:n.jsx(rt,{color:Do[a.status]||"default",style:An,children:Lo[a.status]||a.status})}),n.jsxs("div",{style:{display:"flex",gap:4},children:[n.jsx(Gt,{title:"Mark done/booked with reason",children:n.jsx(ze,{size:"small",type:"primary",icon:n.jsx(wr,{}),style:Co,onClick:()=>k({open:!0,serial:a.serialNo,status:"converted",reason:"",notes:""}),children:"Done"})}),n.jsx(ze,{size:"small",style:Ao,onClick:()=>Y({open:!0,serial:a.serialNo,at:a.followUpAt||He(),notes:a.followUpNotes||""}),children:"Reschedule"})]})]}),s=a=>{const l=a.values||{},b=l["Invoice Status"]||l.Invoice_Status||l.invoiceStatus||a.payload?.invoiceStatus||"",g=l["Invoice File URL"]||l.Invoice_File_URL||l.invoiceFileUrl||a.payload?.invoiceFileUrl||"",A=l["Insurance Status"]||l.Insurance_Status||l.insuranceStatus||a.payload?.insuranceStatus||"",F=l["Insurance File URL"]||l.Insurance_File_URL||l.insuranceFileUrl||a.payload?.insuranceFileUrl||"";return n.jsxs("div",{style:Oe,children:[n.jsxs("div",{style:Ee,children:[n.jsx(rt,{color:"geekblue",children:String(b||"-").replace(/_/g," ")}),g?n.jsx("a",{href:g,target:"_blank",rel:"noopener noreferrer",children:""}):null]}),n.jsxs("div",{style:Ee,children:[n.jsx(rt,{color:"cyan",children:String(A||"-").replace(/_/g," ")}),F?n.jsx("a",{href:F,target:"_blank",rel:"noopener noreferrer",children:""}):null]})]})},O=a=>{const l=a.values||{},b=l["RTO Status"]||l.RTO_Status||l.rtoStatus||a.payload?.rtoStatus||"",g=a.regNo||l["Vehicle No"]||l.Vehicle_No||l.vehicleNo||a.payload?.vehicleNo||"";return n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:n.jsx(rt,{children:String(b||"-").replace(/_/g," ")})}),n.jsx("div",{style:Ee,children:n.jsx(rt,{children:g||"-"})})]})},P=a=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:n.jsx(Gt,{title:a.followUpNotes||"",children:n.jsx(rt,{color:Do[a.status]||"default",style:An,children:Lo[a.status]||a.status})})}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,flexWrap:"wrap"},children:[n.jsx(Ce,{url:a.fileUrl}),n.jsx(ze,{size:"small",style:Hn,title:"Print booking","aria-label":"Print booking",onClick:l=>{if(l.stopPropagation(),!a.bookingId){je.warning("Booking ID missing for print");return}Q({open:!0,row:a})},children:""})]})]}),D=a=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:so(a.balanceValue)}),n.jsx("div",{style:Te,children:a.balanceLabel||"Balance"})]}),Me=i?Ve?[{title:"Details",key:"details",render:(a,l)=>{const b=[Vt(l.dateAt),l.branch||""].filter(Boolean).join(" | "),g=[l.name||"",l.mobile||""].filter(Boolean).join(" | "),A=[l.model||"",l.regNo||""].filter(Boolean).join(" || ");return n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:b||""}),n.jsx("div",{style:Te,children:g||""}),n.jsx("div",{style:Te,children:A||""})]})}},{title:"Status",key:"statusActions",render:(a,l)=>qn(l)}]:Re?[{title:"Details",key:"details",render:(a,l)=>{const b=[Vt(l.dateAt),l.branch||""].filter(Boolean).join(" | "),g=[l.name||"",l.mobile||""].filter(Boolean).join(" | "),A=String(l.model||"").trim(),F=String(l.variant||"").trim(),J=String(l.color||"").trim();return n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:b||""}),n.jsx("div",{style:Te,children:g||""}),n.jsx("div",{style:Te,children:[A,F].filter(Boolean).join(" || ")||""}),n.jsx("div",{style:Te,children:J||""})]})}},{title:"Docs / Status",key:"docsStatus",render:(a,l)=>n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[s(l),O(l),P(l),D(l)]})}]:[{title:"Details",key:"details",render:(a,l)=>{const b=[Vt(l.dateAt),l.branch||""].filter(Boolean).join(" | "),g=[l.name||"",l.mobile||""].filter(Boolean).join(" | "),A=Lr(l),F=A.vehicles.length,J=String(l.followUpNotes||"").trim(),ce=n.jsxs("div",{className:"fu-offering-pop",children:[n.jsx("div",{className:"fu-offering-head",children:n.jsx("span",{children:F?`${F} Vehicle Offer${F>1?"s":""}`:"Offer Details"})}),A.vehicles.length?A.vehicles.map(X=>n.jsxs("div",{className:"fu-offering-vehicle",children:[n.jsx("div",{className:"fu-offering-vehicle-title",children:X.label}),n.jsx("div",{className:"fu-offering-vehicle-model",children:X.title}),n.jsxs("div",{className:"fu-offering-metrics",children:[n.jsxs("span",{children:[n.jsx("b",{children:"Price"}),": ",X.priceText]}),n.jsxs("span",{children:[n.jsx("b",{children:"DP"}),": ",X.dpText]})]}),X.emiText?n.jsx("div",{className:"fu-offering-emi",children:X.emiText}):null,X.fittings.length?n.jsxs("div",{className:"fu-offering-fit",children:[n.jsx("b",{children:"Fittings"}),": ",X.fittings.join(", ")]}):null]},X.label)):n.jsx("div",{className:"fu-offering-empty",children:"No vehicle-wise offer added."})]});return n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:b||""}),n.jsx("div",{style:Te,children:g||""}),F?n.jsx(Tn,{content:ce,trigger:["click"],placement:"topLeft",overlayClassName:"fu-offering-popover",children:n.jsx("div",{className:"fu-offering-list",children:A.vehicles.map(X=>n.jsxs("div",{className:"fu-offering-list-item",children:[n.jsxs("span",{className:"fu-offering-list-label",children:[X.label,":"]})," ",X.title]},X.label))})}):n.jsx("div",{style:Un,children:"No offering details"}),J?n.jsxs("div",{style:Qe,children:[n.jsx("span",{style:{color:"#64748b"},children:"Notes: "}),J]}):n.jsx("div",{style:Qe})]})}},{title:"Status",key:"statusActions",render:(a,l)=>Nn(l)}]:Ve?[{title:"Date / Branch",key:"dateBranch",width:130,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:Vt(l.dateAt)}),n.jsx("div",{style:Te,children:l.branch||""})]})},{title:"Customer / Mobile",key:"customerMobile",width:140,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:l.name||""}),n.jsx("div",{style:Te,children:l.mobile||""})]})},{title:"Model / Vehicle No",key:"modelVehicle",width:140,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:l.model||""}),n.jsx("div",{style:Te,children:l.regNo||""})]})},{title:"Status + Actions",key:"statusActions",width:150,render:(a,l)=>qn(l)}]:Re?[{title:"Date / Branch",key:"dateBranch",width:130,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:Vt(l.dateAt)}),n.jsx("div",{style:Te,children:l.branch||""})]})},{title:"Customer / Mobile",key:"customerMobile",width:140,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Ee,children:l.name||""}),n.jsx("div",{style:Te,children:l.mobile||""})]})},{title:"Model / Variant || Color",key:"modelVariantColor",width:160,render:(a,l)=>{const b=String(l.model||"").trim(),g=String(l.variant||"").trim(),F=[String(l.color||"").trim()].filter(Boolean),J=F.length?F.join(" | "):"";return n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:Te,children:[b,g].filter(Boolean).join(" || ")||""}),n.jsx("div",{style:Te,children:J})]})}},{title:"Invoice + Insurance",key:"invoiceInsurance",width:140,render:(a,l)=>s(l)},{title:"RTO + Vehicle No",key:"rtoVehicle",width:140,render:(a,l)=>O(l)},{title:"Status + File",key:"statusFile",width:170,render:(a,l)=>P(l)},{title:"Balance",key:"balance",width:140,render:(a,l)=>D(l)}]:[{title:"Date / Branch",key:"dateBranch",width:145,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:{...Te,fontWeight:700},children:Vt(l.dateAt)}),n.jsx("div",{style:{...Te,color:"#475569"},children:l.branch||""})]})},{title:"Customer / Mobile",key:"customerMobile",width:165,render:(a,l)=>n.jsxs("div",{style:Oe,children:[n.jsx("div",{style:{...Te,fontWeight:700},children:l.name||""}),n.jsx("div",{style:{...Te,color:"#334155"},children:l.mobile||""})]})},{title:"Offerings",key:"remarks",width:265,render:(a,l)=>{const b=Lr(l),g=b.vehicles.length,A=n.jsxs("div",{className:"fu-offering-pop",children:[n.jsx("div",{className:"fu-offering-head",children:n.jsx("span",{children:g?`${g} Vehicle Offer${g>1?"s":""}`:"Offer Details"})}),b.vehicles.length?b.vehicles.map(F=>n.jsxs("div",{className:"fu-offering-vehicle",children:[n.jsx("div",{className:"fu-offering-vehicle-title",children:F.label}),n.jsx("div",{className:"fu-offering-vehicle-model",children:F.title}),n.jsxs("div",{className:"fu-offering-metrics",children:[n.jsxs("span",{children:[n.jsx("b",{children:"Price"}),": ",F.priceText]}),n.jsxs("span",{children:[n.jsx("b",{children:"DP"}),": ",F.dpText]})]}),F.emiText?n.jsx("div",{className:"fu-offering-emi",children:F.emiText}):null,F.fittings.length?n.jsxs("div",{className:"fu-offering-fit",children:[n.jsx("b",{children:"Fittings"}),": ",F.fittings.join(", ")]}):null]},F.label)):n.jsx("div",{className:"fu-offering-empty",children:"No vehicle-wise offer added."})]});return n.jsx(Tn,{content:A,trigger:["hover","click"],placement:"topLeft",overlayClassName:"fu-offering-popover",children:n.jsx("div",{className:"fu-offering-list",children:g?b.vehicles.map(F=>n.jsxs("div",{className:"fu-offering-list-item",children:[n.jsxs("span",{className:"fu-offering-list-label",children:[F.label,":"]})," ",F.title]},F.label)):n.jsx("div",{style:Un,children:"No offering details"})})})}},{title:"Status + Actions",key:"statusActions",width:160,render:(a,l)=>Nn(l)},{title:"Follow-up Notes",key:"followUpNotes",width:190,render:(a,l)=>{const b=String(l.followUpNotes||"").trim();return b?n.jsx(Gt,{title:b,children:n.jsx("div",{style:Qe,children:b})}):n.jsx("div",{style:Qe})}}];return n.jsx(kl,{children:n.jsxs("div",{className:"fu-bg",children:[n.jsx("style",{children:`
          .fu-bg {
            background:
              radial-gradient(1200px 600px at 10% 0%, rgba(99, 102, 241, 0.14), transparent 55%),
              radial-gradient(1000px 520px at 90% 5%, rgba(34, 197, 94, 0.12), transparent 55%),
              radial-gradient(900px 480px at 50% 100%, rgba(250, 140, 22, 0.10), transparent 60%),
              linear-gradient(180deg, rgba(248,250,252,0.95), rgba(255,255,255,0.86));
            border-radius: 18px;
            padding: 14px;
          }
          .row-pending td { background: rgba(250, 140, 22, 0.09) !important; }
          .compact-table { border-radius: 16px; overflow: hidden; }
          .compact-table .ant-table { border-radius: 16px; }
          .compact-table .ant-table-thead > tr > th {
            background: rgba(255,255,255,0.92);
            backdrop-filter: blur(8px);
            position: sticky;
            top: 0;
            z-index: 2;
            font-weight: 700;
            color: #0f172a;
            border-bottom: 1px solid #eef2f7;
          }
          .compact-table .ant-table-tbody > tr:hover > td {
            background: rgba(99, 102, 241, 0.06) !important;
          }
          .compact-table .ant-pagination {
            padding: 10px 12px;
            margin: 0;
            background: rgba(255,255,255,0.88);
            border-top: 1px solid #eef2f7;
          }
          .fu-pill-input .ant-input-affix-wrapper {
            border-radius: 999px !important;
            box-shadow: 0 6px 16px rgba(15, 23, 42, 0.06);
          }
          .fu-seg .ant-segmented {
            border-radius: 999px;
            padding: 4px;
            background: rgba(255,255,255,0.86);
            box-shadow: 0 6px 16px rgba(15, 23, 42, 0.05);
          }
          .fu-seg .ant-segmented-item {
            border-radius: 999px !important;
            font-weight: 600;
          }
          .fu-offering-popover .ant-popover-inner {
            border-radius: 14px;
            border: 1px solid #dbeafe;
            box-shadow: 0 18px 40px rgba(15, 23, 42, 0.2);
            padding: 10px;
            min-width: 360px;
            max-width: 520px;
            background: linear-gradient(180deg, #f8fbff 0%, #ffffff 100%);
          }
          .fu-offering-pop { display: flex; flex-direction: column; gap: 8px; }
          .fu-offering-head {
            font-size: 13px;
            font-weight: 800;
            color: #1d4ed8;
            letter-spacing: 0.2px;
          }
          .fu-offering-remarks {
            border-left: 3px solid #93c5fd;
            padding-left: 8px;
            color: #0f172a;
            font-size: 12px;
            line-height: 1.35;
          }
          .fu-offering-vehicle {
            border: 1px solid #dbeafe;
            border-radius: 10px;
            padding: 8px;
            background: #f8fbff;
          }
          .fu-offering-vehicle-title {
            font-size: 11px;
            font-weight: 800;
            color: #1e3a8a;
            text-transform: uppercase;
            margin-bottom: 4px;
          }
          .fu-offering-vehicle-model {
            font-size: 12px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 4px;
          }
          .fu-offering-metrics {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            font-size: 12px;
            color: #1f2937;
          }
          .fu-offering-emi {
            margin-top: 4px;
            font-size: 11px;
            color: #334155;
            line-height: 1.3;
          }
          .fu-offering-fit {
            margin-top: 4px;
            font-size: 11px;
            color: #334155;
            line-height: 1.3;
          }
          .fu-offering-empty {
            font-size: 12px;
            color: #64748b;
          }
          .fu-offering-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
          }
          .fu-offering-list-item {
            font-size: 10.5px;
            line-height: 1.3;
            color: #1f2937;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 1;
            overflow: hidden;
            white-space: normal;
          }
          .fu-offering-list-label {
            font-weight: 800;
            color: #1d4ed8;
          }
          @media (max-width: 640px) {
            .fu-offering-popover .ant-popover-inner {
              min-width: 280px;
              max-width: calc(100vw - 24px);
            }
          }
        `}),n.jsx(Ht,{style:$l,bodyStyle:{padding:i?12:16},children:n.jsxs("div",{style:{display:"flex",alignItems:i?"stretch":"flex-start",justifyContent:i?"flex-start":"space-between",gap:14,flexWrap:"wrap",flexDirection:i?"column":"row"},children:[n.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",minWidth:i?"100%":260,width:i?"100%":void 0},children:[n.jsx(sa,{size:i?36:44,style:{background:"#111827"},children:(String(H?.name||"S").trim()[0]||"S").toUpperCase()}),n.jsxs("div",{children:[n.jsx(Pl,{level:i?5:4,style:{margin:0,lineHeight:1.15},children:Ve?"Job Card Follow-Ups":Re?"Booking Follow-Ups":"Quotation Follow-Ups"}),n.jsxs("div",{style:{marginTop:6,display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[n.jsx(rt,{icon:n.jsx(yl,{}),style:{borderRadius:999,marginRight:0},children:H?.branch||U?.[0]||""}),n.jsxs(Tr,{type:"secondary",style:{fontSize:12},children:[n.jsx(nl,{})," ","Last refresh: ",n.jsx("b",{children:p?p.format("DD-MM-YYYY HH:mm"):""})]})]})]})]}),n.jsxs("div",{style:{display:"flex",gap:10,alignItems:"stretch",flexWrap:"wrap",width:i?"100%":void 0},children:[n.jsxs(Ht,{size:"small",style:Qn,bodyStyle:{padding:tn,minWidth:Nt},children:[n.jsx("div",{style:wn,children:dt.total}),n.jsxs("div",{style:jn,children:[n.jsx(Or,{})," Total"]})]}),n.jsxs(Ht,{size:"small",style:Qn,bodyStyle:{padding:tn,minWidth:Nt},children:[n.jsx("div",{style:{...wn,color:"#fa8c16"},children:dt.pending}),n.jsxs("div",{style:jn,children:[n.jsx(ds,{})," Pending"]})]}),Ve?n.jsxs(Ht,{size:"small",style:Qn,bodyStyle:{padding:tn,minWidth:Nt},children:[n.jsx("div",{style:{...wn,color:"#52c41a"},children:dt.completed}),n.jsxs("div",{style:jn,children:[n.jsx(wr,{})," Completed"]})]}):null,n.jsxs(Ht,{size:"small",style:Qn,bodyStyle:{padding:tn,minWidth:Wn},children:[n.jsx(Tr,{type:"secondary",style:{fontSize:i?10:11},children:"Completion"}),n.jsx(la,{percent:dt.total?Math.round(dt.completed/dt.total*100):0,size:"small",status:"active",showInfo:!0})]})]}),n.jsx("div",{style:{flex:1,minWidth:i?"100%":320},children:n.jsx("div",{style:{display:"flex",justifyContent:i?"flex-start":"flex-end"},children:n.jsxs(qt,{wrap:!i,direction:i?"vertical":"horizontal",style:{width:"100%"},children:[Ve?n.jsx(nt,{value:N,onChange:v,style:{minWidth:i?"100%":180,width:en},options:[{value:"all",label:"All statuses"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"}]}):Re?null:n.jsxs("div",{className:"fu-seg",style:{display:"flex",alignItems:"center",gap:8,width:en,flexWrap:"wrap"},children:[n.jsx(sl,{style:{color:"#64748b"}}),n.jsx(Ia,{value:M,onChange:w,block:i,size:i?"small":"middle",options:Tt?[{label:"All",value:"all"},{label:"Due Today",value:"today"}]:[{label:"All",value:"all"},{label:"Due Today",value:"today"}]})]}),n.jsx(fr.RangePicker,{value:re,onChange:a=>le(a),allowClear:!0,size:i?"small":"middle",style:{width:en}}),n.jsx("div",{className:"fu-pill-input",style:{width:en},children:n.jsx(vt,{allowClear:!0,prefix:n.jsx(gl,{}),placeholder:"Search name / mobile / model / notes",value:ve,onChange:a=>ke(a.target.value),size:i?"small":"middle",style:{width:i?"100%":280}})}),Xe&&n.jsx(nt,{value:I,onChange:a=>E(a),options:Jt,style:{minWidth:i?"100%":150,width:en}}),n.jsx(ze,{onClick:xn,loading:m,icon:n.jsx(fl,{}),type:"primary",style:i?{...Fr,width:"100%"}:Fr,children:"Refresh"})]})})})]})}),n.jsx("div",{style:{height:12}}),n.jsx(Ht,{style:Ol,bodyStyle:{padding:0},children:n.jsx(fs,{rowKey:a=>String(a.key),dataSource:At,columns:Me,loading:m&&!T,size:"small",sticky:!i,tableLayout:i?"auto":"fixed",className:"compact-table",rowClassName:a=>It(a)?"row-pending":"",onRow:a=>({onClick:l=>{Re&&(_n(l)||Vn(a))},style:Re?{cursor:"pointer"}:void 0}),locale:{emptyText:n.jsxs("div",{style:{padding:26,textAlign:"center"},children:[n.jsx("div",{style:{fontSize:18,marginBottom:6},children:"No follow-ups found"}),n.jsx("div",{style:{color:"#64748b"},children:"Try changing filters, date range, or search."})]})},pagination:{current:Ae,pageSize:Pe,total:At.length,showSizeChanger:!i,simple:i,size:i?"small":"default",pageSizeOptions:["10","20","50","100","200"],onChange:(a,l)=>{Ke(a),xe(l)}}})}),n.jsx(gn,{title:`Reschedule ${oe.serial||""}`,open:oe.open,confirmLoading:B,maskClosable:!B,keyboard:!B,closable:!B,onCancel:()=>B?null:Y({open:!1,serial:null,at:null,notes:""}),onOk:async()=>{if(!B){ne(!0);try{const a=Sn(oe.notes);await cn(oe.serial,{followUp:{at:oe.at?.toISOString?.()||null,notes:a},status:"pending"})&&Y({open:!1,serial:null,at:null,notes:""})}finally{ne(!1)}}},children:n.jsxs(qt,{direction:"vertical",style:{width:"100%"},children:[n.jsx(fr,{showTime:!0,style:{width:"100%"},value:oe.at,onChange:a=>Y(l=>({...l,at:a}))}),n.jsx(vt.TextArea,{rows:2,placeholder:"Notes",value:oe.notes,onChange:a=>Y(l=>({...l,notes:a.target.value}))})]})}),n.jsx(gn,{title:`Mark Done  ${R.serial||""}`,open:R.open,confirmLoading:ee,maskClosable:!ee,keyboard:!ee,closable:!ee,cancelButtonProps:{disabled:ee},okButtonProps:{disabled:ee},onCancel:()=>ee?null:k({open:!1,serial:null,status:"converted",details:"",boughtFrom:"",offer:""}),onOk:async()=>{if(!ee){W(!0);try{const a=Sn(R.details),l={status:R.status||"converted",closeReason:R.status||"converted",closeNotes:R.details||"",closedAt:new Date().toISOString(),followUp:{notes:a}};R.status==="purchased_elsewhere"&&(l.purchasedElsewhere={boughtFrom:R.boughtFrom||"",offer:R.offer||""}),await cn(R.serial,l)&&k({open:!1,serial:null,status:"converted",details:"",boughtFrom:"",offer:""})}finally{W(!1)}}},children:n.jsxs(qt,{direction:"vertical",style:{width:"100%"},children:[n.jsx(nt,{style:{width:"100%"},value:R.status,onChange:a=>k(l=>({...l,status:a})),options:[{value:"converted",label:"Booked"},{value:"not_interested",label:"Not Interested"},{value:"unreachable",label:"Unreachable"},{value:"purchased_elsewhere",label:"Purchased SomeWhereElse"}]}),n.jsx(vt.TextArea,{rows:2,placeholder:"Notes",value:R.details,onChange:a=>k(l=>({...l,details:a.target.value}))})]})}),Re&&n.jsx(wl,{open:Z.open,onClose:()=>Q({open:!1,row:null}),row:Z.row,webhookUrl:t,secret:Yt}),Ve&&n.jsx(Ma,{ref:te,active:_,vals:ue?.vals||{},totals:ue?.totals||{}}),Et&&n.jsx("div",{style:{position:"fixed",inset:0,zIndex:1900,background:"rgba(255,255,255,0.9)",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"all"},children:n.jsxs("div",{style:{textAlign:"center",color:"#111"},children:[n.jsx(io,{tip:"Preparing booking form...",size:"large"}),n.jsx("div",{style:{marginTop:12,fontWeight:600},children:"Redirecting to booking form..."})]})})]})})}const Ll=e=>String(e||"").replace(/\D/g,"").slice(-10),_l=e=>String(e||"").toUpperCase().replace(/\s+/g,"");function zl({form:e,webhookUrl:t,bookingId:o,mobile:r}){const i=!rr.useBreakpoint().md,[m,u]=c.useState(!1),p=c.useMemo(()=>{if(!m)return"";const h=_l(o);return h||Ll(r||e?.getFieldValue?.("mobileNumber")||"")||""},[m,o,r,e]);return n.jsxs(n.Fragment,{children:[n.jsx(ze,{icon:n.jsx(ll,{}),onClick:()=>u(!0),children:"Booking History"}),n.jsx(gn,{open:m,title:"",footer:null,onCancel:()=>u(!1),destroyOnClose:!0,width:i?"100%":"92vw",bodyStyle:{padding:0},children:m?n.jsx(Dl,{mode:"booking",webhookUrl:t,prefillQuery:p}):null})]})}const{Title:Vl,Text:_r}=ta,{Dragger:Ul}=Fn,{useBreakpoint:Wl}=rr,{Option:Wt}=nt,fn=e=>String(e||"").trim().toUpperCase(),Hl=!1,ql=["IDFC","L&T FINANCE LIMITED","JANA SMALL FINANCE BANK","SHRIRAM FINANCE","TVS CREDIT","INDUSIND BANK","AXIS BANK","HINDHUJA FINANCE","BAJAJ FINANCE","OTHER"],_o=e=>Number(String(e??0).replace(/[,\s]/g,""))||0,Gl=(e,t)=>{const o=y=>{try{return typeof e=="function"?e(y):e?.[y]}catch{return}};let r=_o(o(`bookingAmount${t}Cash`)),d=_o(o(`bookingAmount${t}Online`));const i=_o(o(`bookingAmount${t}`)),m=String(o(`paymentMode${t}`)||"").toLowerCase(),u=o(`paymentReference${t}`)||o(`paymentRef${t}`)||o(`utr${t}`)||o("utr");!r&&!d&&i&&(m==="online"?d=i:r=i);const p=r+d;return{part:t,cash:r,online:d,total:p,mode:r&&d?"cash+online":d?"online":r?"cash":"",reference:d>0&&u||void 0}},eo=e=>[1,2,3].map(t=>Gl(e,t)),Kl=[{required:!0,message:"Mobile number is required"},{pattern:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit Indian mobile number"}],Xl="https://docs.google.com/spreadsheets/d/e/2PACX-1vQYGuNPY_2ivfS7MTX4bWiu1DWdF2mrHSCnmTznZVEHxNmsrgcGWjVZN4UDUTOzQQdXTnbeM-ylCJbB/pub?gid=408799621&single=true&output=csv",to="https://script.google.com/macros/s/AKfycbwSn5hp1cSWlJMGhe2cYUtid2Ruqh9H13mZbq0PwBpYB0lMLufZbIjZ5zioqtKgE_0sNA/exec",Jl=e=>{const t=[];let o=[],r="",d=!1;for(let i=0;i<e.length;i++){const m=e[i],u=e[i+1];if(m==='"'&&!d){d=!0;continue}if(m==='"'&&d){if(u==='"'){r+='"',i++;continue}d=!1;continue}if(m===","&&!d){o.push(r),r="";continue}if((m===`
`||m==="\r")&&!d){(r!==""||o.length)&&(o.push(r),t.push(o),o=[],r=""),m==="\r"&&u===`
`&&i++;continue}r+=m}return(r!==""||o.length)&&(o.push(r),t.push(o)),t},$n={company:["Company","Company Name"],model:["Model","Model Name"],variant:["Variant"],price:["On-Road Price","On Road Price","OnRoadPrice","Price"],color:["Color","Colours","Colors","Colour","Available Colors"]},On=(e,t)=>String(t.map(o=>e[o]??"").find(o=>o!=="")||"").trim(),Yl=(e={})=>({company:On(e,$n.company),model:On(e,$n.model),variant:On(e,$n.variant),color:On(e,$n.color),onRoadPrice:Number(String(On(e,$n.price)||"0").replace(/[,\s]/g,""))||0}),zr=(e={})=>({company:String(e["Company Name"]||e.company||"").trim(),model:String(e["Model Name"]||e.model||"").trim(),variant:String(e.Variant||e.variant||"").trim(),color:String(e.Color||e.Colours||e.Colors||e.Colour||e["Available Colors"]||e.color||"").trim(),onRoadPrice:Number(String(e["On-Road Price"]||e.onRoadPrice||"0").replace(/[,\s]/g,""))||0});function Zl({asModal:e=!1,initialValues:t=null,onSuccess:o,startPaymentsOnly:r=!1,editRefDefault:d=null,allowBranchSelect:i=!1,allowExecutiveSelect:m=!1,branchOptions:u=[],executiveOptions:p=[],branchOptionsLoading:h=!1,executiveOptionsLoading:y=!1}={}){const C=c.useRef(null),T=Wl(),S=!T.md,M=T.md&&!T.lg,w=S?"middle":"large",[f]=V.useForm(),[I,E]=c.useState([]),[j,N]=c.useState([]),[v,H]=c.useState(!!r),[$,q]=c.useState(()=>d||{bookingId:null,mobile:null}),[se,U]=c.useState(!1),[me,oe]=c.useState([]),[Y,R]=c.useState([]),[k,B]=c.useState(!1),[ne,ee]=c.useState(!1),[W,Z]=c.useState(null),Q=Oa(),te=Q.state?.autoFetch,[_,ie]=c.useState(!!te),ue=c.useRef(!1),pe=c.useMemo(()=>{try{return JSON.parse(localStorage.getItem("user")||"null")}catch{return null}},[]),ye=c.useMemo(()=>{const s=pe?.formDefaults?.staffName||pe?.name||pe?.displayName||pe?.email||"";return fn(s)},[pe]),fe=c.useMemo(()=>{const s=Array.isArray(pe?.branches)?pe.branches[0]?.name||pe.branches[0]:void 0,O=pe?.formDefaults?.branchName||pe?.primaryBranch?.name||s||"";return fn(O)},[pe]),[ve,ke]=c.useState(""),[re,le]=c.useState(""),Ae=V.useWatch("variant",f),Ke=V.useWatch("color",f),Pe=V.useWatch("purchaseType",f),xe=V.useWatch("addressProofMode",f),Et=V.useWatch("paymentMode",f),xt=V.useWatch("bookingAmount1Cash",f),St=V.useWatch("bookingAmount2Cash",f),Xe=V.useWatch("bookingAmount3Cash",f),We=V.useWatch("bookingAmount1Online",f),at=V.useWatch("bookingAmount2Online",f),wt=V.useWatch("bookingAmount3Online",f),Rt=V.useWatch("bookingAmount1",f),Bt=V.useWatch("bookingAmount2",f),Jt=V.useWatch("bookingAmount3",f),Yt=V.useWatch("paymentMode1",f),jt=V.useWatch("paymentMode2",f),Ve=V.useWatch("paymentMode3",f),Re=V.useWatch("paymentReference1",f),Tt=V.useWatch("paymentReference2",f),Ft=V.useWatch("paymentReference3",f),It=V.useWatch("chassisNo",f),Dt=c.useCallback(({bookingId:s,mobile:O,vehicle:P})=>{H(!0),q({bookingId:s||null,mobile:O||null}),U(!0);const D=String(P?.availability||"").toLowerCase(),G=P?.chassisNo||f.getFieldValue("chassisNo"),we=D==="allot"||String(G||"")==="__ALLOT__",Me=!!(G&&String(G)!=="__ALLOT__");ee(!!(Me&&!we)),je.info("Payments-only update mode enabled")},[f]),Lt=V.useWatch("customerName",f),de=V.useWatch("mobileNumber",f),Se=V.useWatch("address",f),$e=V.useWatch("executive",f),he=V.useWatch("branch",f),Ce=V.useWatch("rtoOffice",f),ae=V.useWatch("financier",f),Ze=V.useWatch("nohpFinancier",f),ht=c.useMemo(()=>{const s=[...u,...me],O=new Set,P=D=>{if(!D)return;const G=fn(typeof D=="string"?D:D?.name||D?.label||D?.value);G&&O.add(G)};return fe&&P(fe),(s||[]).forEach(P),Array.from(O).map(D=>({label:D,value:D}))},[u,me,fe]),st=c.useMemo(()=>{const s=[...p,...Y],O=new Set,P=D=>{if(!D)return;const G=fn(typeof D=="string"?D:D?.name||D?.label||D?.value);G&&O.add(G)};return ye&&P(ye),(s||[]).forEach(P),Array.from(O).map(D=>({label:D,value:D}))},[p,Y,ye]),sn=i&&ht.length>0,Mn=m&&st.length>0,it=c.useMemo(()=>eo({bookingAmount1Cash:xt,bookingAmount2Cash:St,bookingAmount3Cash:Xe,bookingAmount1Online:We,bookingAmount2Online:at,bookingAmount3Online:wt,bookingAmount1:Rt,bookingAmount2:Bt,bookingAmount3:Jt,paymentMode1:Yt,paymentMode2:jt,paymentMode3:Ve}).reduce((O,P)=>O+P.total,0),[xt,St,Xe,We,at,wt,Rt,Bt,Jt,Yt,jt,Ve]),lt=V.useWatch("downPayment",f),Zt=V.useWatch("extraFittingAmount",f),_t=V.useWatch("discountAmount",f),ct=V.useWatch("affidavitCharges",f),Qt=c.useMemo(()=>{const s=P=>String(P||"").trim().toLowerCase(),O=j.find(P=>s(P.company)===s(ve)&&s(P.model)===s(re)&&s(P.variant)===s(Ae));return Number(O?.onRoadPrice||0)||0},[j,ve,re,Ae]),[ho,go]=c.useState(!1),[bn,Bn]=c.useState(null);c.useEffect(()=>{go(!1),Bn(null)},[Qt]);const Ct=Number(bn??Qt??0)||0,yn=c.useMemo(()=>{const s=Number(lt||0)||0,O=Number(Zt||0)||0,P=Number(_t||0)||0,D=xe==="additional"&&Number(ct||0)||0;return s+O+D-P},[lt,Zt,_t,ct,xe]),bo=c.useMemo(()=>{const s=Number(it||0)||0;return yn-s},[yn,it]),ln=c.useMemo(()=>{const s=Number(Zt||0)||0,O=Number(_t||0)||0,P=xe==="additional"&&Number(ct||0)||0;return(Number(Ct)||0)+s+P-O},[Ct,Zt,_t,ct,xe]),Dn=c.useMemo(()=>{const s=Number(it||0)||0;return ln-s},[ln,it]),[yo,vn]=c.useState(!1),[Ln,_n]=c.useState(!1),[zn,Vn]=c.useState(0),vo=(s=6e3)=>{const O=Date.now()+s;Vn(O),setTimeout(()=>Vn(0),s+50)},zt=c.useMemo(()=>!!(se||$?.bookingId||$?.mobile),[se,$]),xn=async()=>{if(!zt){je.warning("Save the booking, fetch it, then print.");return}_n(!0);try{await new Promise(s=>setTimeout(s,0)),await or(C.current)}catch{}finally{_n(!1)}},cn="Booking:draft:v1",Sn=(s,O)=>{try{localStorage.setItem(s,JSON.stringify(O))}catch{}};c.useEffect(()=>{{try{localStorage.removeItem(cn)}catch{}f.resetFields();return}},[]);const Vt=async s=>await rn({webhookUrl:to,method:"POST",payload:s}),[Oe,Ee]=c.useState("idle"),[Te,Qe]=c.useState(null),Un=c.useMemo(()=>{const s=f.getFieldsValue(!0),O=eo(G=>s[G]),P=[];return O.forEach(G=>{G.cash>0&&P.push({part:G.part,amount:G.cash,mode:"cash"}),G.online>0&&P.push({part:G.part,amount:G.online,mode:"online",reference:G.reference})}),{customerName:s.customerName,mobileNumber:s.mobileNumber,address:s.address,branch:s.branch||fe||"",executive:s.executive||ye||"",rtoOffice:s.rtoOffice,purchaseMode:s.purchaseType,bookingAmount:it,payments:P,paymentSplit:O,addressProofMode:s.addressProofMode,addressProofTypes:s.addressProofTypes||[],fileName:I&&I[0]?.name||void 0,vehicle:{company:s.company,model:s.bikeModel,variant:s.variant,color:s.color,chassisNo:s.chassisNo==="__ALLOT__"?void 0:s.chassisNo,availability:s.chassisNo==="__ALLOT__"?"allot":Oe},financier:s.financier||s.nohpFinancier,createdAt:new Date}},[f,fe,ye,Oe,Pe,Et,xe,ve,re,Ae,Ke,It,xt,St,Xe,We,at,wt,Re,Tt,Ft,Lt,de,Se,$e,he,Ce,ae,Ze,I,it]),[At,dt]=c.useState([]),[en,tn]=c.useState(!1);c.useEffect(()=>{let s=!1;return(async()=>{try{const P=await gr({status:"active",limit:500});if(s)return;if(P?.success){const D=(P.data?.items||[]).map(G=>String(G?.name||"").trim().toLowerCase()).filter(Boolean);Z(new Set(D))}else Z(new Set)}catch{s||Z(new Set)}})(),()=>{s=!0}},[]);const Nt=c.useCallback(s=>{if(!W||W.size===0)return!0;const O=String(s?.branch||s?.sourceBranch||"").trim().toLowerCase();return O?W.has(O):!1},[W]),Wn=async s=>{const O=String(s||"").trim().toUpperCase();if(O==="__ALLOT__"){Ee("allot"),Qe(null);return}if(!O||O.length<6){Ee("idle"),Qe(null);return}Ee("checking"),Qe(null);try{const P=await Er({limit:1500}),G=(Array.isArray(P?.data)?P.data:[]).find(we=>String(we.chassisNo||we.chassis||"").toUpperCase()===O);if(G&&!Nt(G)){Ee("not_found"),Qe(null);return}G?(Ee("found"),Qe({chassis:G.chassisNo||G.chassis||O,company:G.company||"",model:G.model||"",variant:G.variant||"",branch:G.branch||G.sourceBranch||"",color:G.color||""})):(Ee("not_found"),Qe(null))}catch{Ee("idle"),Qe(null),je.error("Could not verify chassis availability.")}};c.useEffect(()=>{const s=setTimeout(()=>{Wn(It)},600);return()=>clearTimeout(s)},[It,W]),c.useEffect(()=>{if(xe!=="additional"){const s=f.getFieldValue("affidavitCharges");(Number(s)||0)!==0&&f.setFieldsValue({affidavitCharges:0})}},[xe,f]),c.useEffect(()=>{try{if(v||xe!=="additional")return;const s=String(ve||f.getFieldValue("company")||"").trim();if(!s)return;const P=/bajaj/i.test(s)?350:250,D=Number(f.getFieldValue("affidavitCharges"))||0;(D===0||D===250||D===350)&&D!==P&&f.setFieldsValue({affidavitCharges:P})}catch{}},[xe,ve,v,f]),c.useEffect(()=>{const s=i&&!u.length,O=m&&!p.length;if(!s&&!O)return;let P=!1;return(async()=>{B(!0);try{const G=await Promise.allSettled([s?gr({status:"active",limit:500}):Promise.resolve(null),O?Ta({role:"staff",status:"active",limit:1e5}):Promise.resolve(null)]);if(!P){const[we,Me]=G;if(s&&we.status==="fulfilled"&&we.value?.success){const a=(we.value.data?.items||[]).filter(l=>String(l?.status||"").toLowerCase()==="active");oe(a.map(l=>l.name).filter(Boolean))}O&&Me.status==="fulfilled"&&Me.value?.success&&R((Me.value.data?.items||[]).filter(a=>String(a.role||"").toLowerCase()==="staff").map(a=>a.name||a.email||"").filter(Boolean))}}catch{P||je.error("Could not load dropdown options")}finally{P||B(!1)}})(),()=>{P=!0}},[i,m,u.length,p.length]),c.useEffect(()=>{const s={};eo(P=>f.getFieldValue(P)).forEach(P=>{const D=`paymentReference${P.part}`;P.online<=0&&f.getFieldValue(D)&&(s[D]=void 0)}),Object.keys(s).length&&f.setFieldsValue(s)},[We,at,wt,Rt,Bt,Jt,Yt,jt,Ve,f]),c.useEffect(()=>{if(t&&typeof t=="object")try{const s={...t};s.model&&!s.bikeModel&&(s.bikeModel=s.model),s.chassis&&!s.chassisNo&&(s.chassisNo=s.chassis),f.setFieldsValue(s),s.company&&ke(s.company),s.bikeModel&&le(s.bikeModel)}catch{}},[t]),c.useEffect(()=>{const s=f.getFieldsValue(["executive","branch"]),O={};!s.executive&&ye&&(O.executive=ye),!s.branch&&fe&&(O.branch=fe),Object.keys(O).length&&f.setFieldsValue(O)},[f,ye,fe]),c.useEffect(()=>{if(!te)return;const s=()=>ie(!1);return window.addEventListener("bookingPrefillComplete",s),()=>window.removeEventListener("bookingPrefillComplete",s)},[te]),c.useEffect(()=>{te&&(ue.current=!1)},[te?.mode,te?.query]),c.useEffect(()=>{ue.current=!1},[Q.key]),c.useEffect(()=>{if(ue.current)return;ue.current=!0;const s=()=>{typeof window>"u"||window.dispatchEvent(new CustomEvent("bookingPrefillComplete"))},O=Nl();if(!O?.payload){s();return}try{const{patch:P,metadata:D}=fa(O.payload);f.setFieldsValue(P),P.company&&ke?.(P.company),P.bikeModel&&le?.(P.bikeModel),je.success("Booking details filled."),Dt(D)}catch(P){console.warn("Follow-up auto-prefill failed",P)}finally{s()}},[f,Dt,ke,le]),c.useEffect(()=>{let s=!1;return(async()=>{try{const P=await fetch(Xl,{cache:"no-store"});if(!P.ok)throw new Error("sheet fetch failed");const D=await P.text();if(D.trim().startsWith("<"))throw new Error("expected CSV, got HTML");const G=Jl(D);if(!G.length)throw new Error("empty sheet");const we=G[0].map(l=>(l||"").trim()),a=G.slice(1).map(l=>{const b={};return we.forEach((g,A)=>b[g]=l[A]??""),b}).map(Yl).filter(l=>l.company&&l.model&&l.variant);s||N(a)}catch{try{const P=await fetch("/bikeData.json",{cache:"no-store"});if(!P.ok)throw new Error("fallback missing");const D=await P.json(),G=(Array.isArray(D)?D:[]).map(zr).filter(we=>we.company&&we.model&&we.variant);s||N(G),Array.isArray(D)||je.warning("Loaded fallback bikeData.json")}catch{try{const P=["bajaj","honda","tvs","suzuki","yamaha","royalEnfield"],we=(await Promise.all(P.map(async Me=>{try{const a=await fetch(`/${Me}.json`,{cache:"no-store"});if(!a.ok)return[];const l=await a.json();return Array.isArray(l)?l:[]}catch{return[]}}))).flat().map(zr).filter(Me=>Me.company&&Me.model&&Me.variant);if(s||N(we),!we.length)throw new Error("no data")}catch{je.error("Could not load vehicle data. Please try again later.")}}}})(),()=>{s=!0}},[]);const wn=c.useMemo(()=>Xn(j.map(s=>s.company)),[j]),jn=c.useMemo(()=>{const s=ft(ve),O=s?j.filter(P=>ft(P.company)===s):j;return Xn(O.map(P=>P.model))},[j,ve]),xo=c.useMemo(()=>{const s=ft(ve),O=ft(re),P=j.filter(D=>!(s&&ft(D.company)!==s||O&&ft(D.model)!==O));return Xn(P.map(D=>D.variant))},[j,ve,re]),Cn=s=>s?String(s).split(/[|,/;\n]+/).map(O=>O.trim()).filter(Boolean):[],dn=c.useMemo(()=>{const s=ft(ve),O=ft(re),P=ft(Ae);if(!s||!O||!P)return[];const G=j.filter(we=>ft(we.company)===s&&ft(we.model)===O&&ft(we.variant)===P).flatMap(we=>Cn(we.color));return Xn(G)},[j,ve,re,Ae]);c.useEffect(()=>{let s=!1;return(async()=>{if(!ve||!re||!Ae){dt([]);return}tn(!0);try{const P=await Er({limit:2e3}),G=(Array.isArray(P?.data)?P.data:[]).filter(we=>Nt(we));s||dt(G)}catch{s||dt([])}finally{s||tn(!1)}})(),()=>{s=!0}},[ve,re,Ae,Nt]),c.useEffect(()=>{!W||W.size===0||dt(s=>s.filter(O=>Nt(O)))},[W,Nt]);const So=c.useMemo(()=>{const s=P=>String(P||"").trim().toLowerCase(),O=[];return At.forEach(P=>{if(Nt(P)&&s(P.company)===s(ve)&&s(P.model)===s(re)&&s(P.variant)===s(Ae)&&(!Ke||s(P.color)===s(Ke))){const D=String(P.chassisNo||P.chassis||"").trim().toUpperCase();D&&!O.includes(D)&&O.push(D)}}),O},[At,ve,re,Ae,Ke]),An=s=>s.type==="application/pdf"||(s.name||"").toLowerCase().endsWith(".pdf")?s.size<=5*1024*1024?!1:(je.error("Each file must be 5MB or smaller."),Fn.LIST_IGNORE):(je.error("Only PDF files are allowed."),Fn.LIST_IGNORE),wo=async s=>{const O=new FormData;O.append("action","upload");const P=s?.originFileObj||s;O.append("file",P,s?.name||P?.name||"document.pdf");const D=await fetch(to,{method:"POST",body:O,credentials:"omit"});let G=null;try{G=await D.json()}catch{G=null}if(G&&(G.ok||G.success))return G;throw new Error("Upload failed")},jo=s=>new Promise((O,P)=>{try{const D=new FileReader,G=s?.originFileObj||s;D.onload=()=>{const we=String(D.result||""),Me=we.indexOf(",");O(Me>=0?we.slice(Me+1):we)},D.onerror=P,D.readAsDataURL(G)}catch(D){P(D)}}),Co=async(s,O={})=>{const{skipReset:P=!1,silent:D=!1,skipCooldown:G=!1,skipSubmittingState:we=!1,fromPrint:Me=!1}=O;try{if(!G){if(Date.now()<zn)return;vo(6e3)}we||vn(!0);let a;const l=(I||[])[0];if(l){a={name:l.name,mimeType:l.type||"application/pdf",size:l.size};try{const K=await wo(l);K&&(K.url||K.fileId)&&(a={...a,...K})}catch{try{if((l.size||0)<=3*1024*1024){const K=await jo(l);a.base64=K}}catch{}}}const b=s.addressProofMode==="additional"&&Number(s.affidavitCharges)||0,g=(Number(s.downPayment)||0)+(Number(s.extraFittingAmount)||0)+b-(Number(s.discountAmount)||0),A=eo(K=>s[K]),F=A.reduce((K,z)=>K+z.total,0);if(F<=0){je.error("Please enter at least one partial booking payment"),vn(!1);return}const J=g-F,ce=[];A.forEach(K=>{K.cash>0&&ce.push({part:K.part,amount:K.cash,mode:"cash"}),K.online>0&&ce.push({part:K.part,amount:K.online,mode:"online",reference:K.reference||void 0})});const X=A.map(K=>({amount:K.total||void 0,mode:K.mode?K.mode.toUpperCase():void 0,reference:K.reference})),Be={customerName:s.customerName,mobileNumber:s.mobileNumber,vehicle:{company:s.company,model:s.bikeModel,variant:s.variant,color:s.color||void 0,chassisNo:s.chassisNo==="__ALLOT__"?void 0:s.chassisNo},rtoOffice:s.rtoOffice,purchaseMode:s.purchaseType,payments:ce,paymentSplit:A,addressProofMode:s.addressProofMode,addressProofTypes:s.addressProofTypes||[],address:s.address||void 0,bookingAmount:F||void 0,bookingAmount1:X[0]?.amount,bookingAmount2:X[1]?.amount,bookingAmount3:X[2]?.amount,paymentMode1:X[0]?.mode,paymentMode2:X[1]?.mode,paymentMode3:X[2]?.mode,paymentReference1:(A[0]?.online||0)>0&&A[0]?.reference||void 0,paymentReference2:(A[1]?.online||0)>0&&A[1]?.reference||void 0,paymentReference3:(A[2]?.online||0)>0&&A[2]?.reference||void 0,bookingAmount1Cash:s.bookingAmount1Cash??void 0,bookingAmount1Online:s.bookingAmount1Online??void 0,bookingAmount2Cash:s.bookingAmount2Cash??void 0,bookingAmount2Online:s.bookingAmount2Online??void 0,bookingAmount3Cash:s.bookingAmount3Cash??void 0,bookingAmount3Online:s.bookingAmount3Online??void 0,disbursementAmount:s.purchaseType==="loan"||s.purchaseType==="nohp"?s.disbursementAmount??void 0:void 0,emiAmount:s.purchaseType==="loan"||s.purchaseType==="nohp"?s.emiAmount??void 0:void 0,tenure:(s.purchaseType==="loan"||s.purchaseType==="nohp")&&Number(s.tenure)||void 0,dp:{downPayment:s.downPayment??void 0,extraFittingAmount:s.extraFittingAmount??0,discountAmount:s.discountAmount??0,affidavitCharges:s.addressProofMode==="additional"?s.affidavitCharges??0:0,totalDp:g,balancedDp:J},cash:{onRoadPrice:Ct,totalVehicleCost:Pe==="cash"?(Number(Ct)||0)+(Number(s.extraFittingAmount)||0)+-(Number(s.discountAmount)||0)+(s.addressProofMode==="additional"&&Number(s.affidavitCharges)||0):void 0,balancedAmount:Pe==="cash"?(Number(Ct)||0)+(Number(s.extraFittingAmount)||0)+-(Number(s.discountAmount)||0)+(s.addressProofMode==="additional"&&Number(s.affidavitCharges)||0)-F:void 0},executive:s.executive||ye||void 0,branch:s.branch||fe||void 0,file:a?{name:a.name,mimeType:a.mimeType,size:a.size}:void 0,chassis:{status:Oe,info:Te},ts:new Date().toISOString(),v:1},Fe=ce.filter(K=>String(K.mode).toLowerCase()==="cash").reduce((K,z)=>K+(Number(z.amount)||0),0),De=ce.filter(K=>String(K.mode).toLowerCase()==="online").reduce((K,z)=>K+(Number(z.amount)||0),0),et=Fe+De,ut={customerName:s.customerName,mobileNumber:s.mobileNumber,vehicle:{company:s.company,model:s.bikeModel,variant:s.variant,color:s.color||void 0,chassisNo:s.chassisNo==="__ALLOT__"?void 0:s.chassisNo,availability:s.chassisNo==="__ALLOT__"?"allot":Oe,availabilityInfo:Te||void 0},onRoadPrice:Ct,rtoOffice:s.rtoOffice,purchaseMode:s.purchaseType,disbursementAmount:s.purchaseType==="loan"||s.purchaseType==="nohp"?s.disbursementAmount??void 0:void 0,emiAmount:s.purchaseType==="loan"||s.purchaseType==="nohp"?s.emiAmount??void 0:void 0,tenure:(s.purchaseType==="loan"||s.purchaseType==="nohp")&&Number(s.tenure)||void 0,financier:s.financier||s.nohpFinancier||void 0,addressProofMode:s.addressProofMode,addressProofTypes:s.addressProofTypes||[],address:s.address||void 0,payments:ce,paymentSplit:A,discountAmount:s.discountAmount??0,source:"booking",cashCollected:Fe,onlineCollected:De,totalCollected:et,bookingAmount:F||void 0,bookingAmount1:X[0]?.amount,bookingAmount2:X[1]?.amount,bookingAmount3:X[2]?.amount,paymentMode1:X[0]?.mode,paymentMode2:X[1]?.mode,paymentMode3:X[2]?.mode,paymentReference1:(A[0]?.online||0)>0&&A[0]?.reference||void 0,paymentReference2:(A[1]?.online||0)>0&&A[1]?.reference||void 0,paymentReference3:(A[2]?.online||0)>0&&A[2]?.reference||void 0,bookingAmount1Cash:s.bookingAmount1Cash??void 0,bookingAmount1Online:s.bookingAmount1Online??void 0,bookingAmount2Cash:s.bookingAmount2Cash??void 0,bookingAmount2Online:s.bookingAmount2Online??void 0,bookingAmount3Cash:s.bookingAmount3Cash??void 0,bookingAmount3Online:s.bookingAmount3Online??void 0,downPayment:s.downPayment??void 0,extraFittingAmount:s.extraFittingAmount??0,affidavitCharges:s.addressProofMode==="additional"?s.affidavitCharges??0:0,totalDp:g,balancedDp:J,totalVehicleCost:s.purchaseType==="cash"?ln:void 0,balancedAmount:s.purchaseType==="cash"?Dn:void 0,rawPayload:JSON.stringify(Be),executive:s.executive||ye||void 0,branch:s.branch||fe||void 0,...a?{file:a}:{},...$?.bookingId?{bookingId:$.bookingId}:{},...$?.mobile?{editMobile:$.mobile}:{},...v?{action:"update"}:{}};let mt=!1,L;try{L=await Vt(ut),mt=(L?.data||L)?.success!==!1}catch{mt=!1}if(!mt)throw new Error(String((L?.data||L)?.message||"Submission failed"));if(D||je.success("Booking saved successfully"),!Me&&typeof o=="function")try{o({response:L?.data||L,payload:ut})}catch{}if(!P){f.resetFields(),Sn(cn,null),f.setFieldsValue({executive:ye||"",branch:fe||""}),H(!1),q({bookingId:null,mobile:null}),ee(!1),E([]),ke(""),le(""),Ee("idle"),Qe(null),dt([]);try{window.dispatchEvent(new Event("reload-bookings"))}catch{}}}catch(a){if(je.error(String(a?.message||a||"Submission failed")),Me)throw a}finally{we||vn(!1)}},Ao=({errorFields:s})=>{s?.length&&f.scrollToField(s[0].name,{behavior:"smooth",block:"center"})},Hn=s=>typeof s=="string"?s.toUpperCase():s&&typeof s=="object"&&typeof s.target?.value=="string"?s.target.value.toUpperCase():s,qn=n.jsx("div",{style:{height:S?40:44,width:S?40:44,borderRadius:12,display:"grid",placeItems:"center",color:"white",background:"linear-gradient(135deg, #2563eb 0%, #4f46e5 100%)",boxShadow:"0 8px 20px rgba(37, 99, 235, 0.35)",fontSize:S?20:22},children:""}),Nn=n.jsxs(V,{layout:"vertical",form:f,onFinish:Co,onFinishFailed:Ao,onValuesChange:(s,O)=>{try{if(!Hl)return;const P={...O};[1,2,3].forEach(D=>{(Number(P[`bookingAmount${D}Online`]||0)||0)<=0&&delete P[`paymentReference${D}`]}),Sn(cn,P)}catch{}},requiredMark:"optional",encType:"multipart/form-data",children:[n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Executive",name:"executive",rules:[{required:!0,message:"Executive is required"}],getValueFromEvent:Hn,children:Mn?n.jsx(nt,{size:w,showSearch:!0,optionFilterProp:"label",placeholder:"Select executive",disabled:v,loading:y||k,options:st,allowClear:!ye,style:{textTransform:"uppercase"}}):n.jsx(vt,{size:w,placeholder:"Executive name",readOnly:!!ye,disabled:v,style:{textTransform:"uppercase"}})})}),n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Branch",name:"branch",rules:[{required:!0,message:"Branch is required"}],getValueFromEvent:Hn,children:sn?n.jsx(nt,{size:w,showSearch:!0,optionFilterProp:"label",placeholder:"Select branch",disabled:v,loading:h||k,options:ht,allowClear:!fe,style:{textTransform:"uppercase"}}):n.jsx(vt,{size:w,placeholder:"Branch name",readOnly:!!fe,disabled:v,style:{textTransform:"uppercase"}})})})]}),n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Customer Name",name:"customerName",rules:[{required:!0,message:"Please enter customer name"}],getValueFromEvent:s=>{const O=s?.target?.value??s;return typeof O=="string"?O.toUpperCase():O},children:n.jsx(vt,{size:w,placeholder:"e.g., RAHUL SHARMA",allowClear:!0,style:{textTransform:"uppercase"},disabled:v})})}),n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Mobile Number",name:"mobileNumber",rules:Kl,normalize:s=>s&&s.replace(/\D/g,"").slice(0,10),getValueFromEvent:s=>s?.target?.value?.toUpperCase?.(),children:n.jsx(vt,{size:w,placeholder:"10-digit number",maxLength:10,inputMode:"numeric",allowClear:!0,disabled:v,style:{textTransform:"uppercase"}})})})]}),n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Company",name:"company",rules:[{required:!0,message:"Select a company"}],children:n.jsx(nt,{size:w,placeholder:"Select Company",disabled:v,onChange:s=>{ke(s),le(""),f.setFieldsValue({bikeModel:void 0,variant:void 0,color:void 0,chassisNo:void 0}),f.setFieldsValue({company:String(s).toUpperCase()})},style:{textTransform:"uppercase"},dropdownRender:void 0,children:wn.map((s,O)=>n.jsx(Wt,{value:s,children:s},O))})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Bike Model",name:"bikeModel",rules:[{required:!0,message:"Select a model"}],children:n.jsx(nt,{size:w,placeholder:"Select Model",disabled:v||!ve,onChange:s=>{le(s),f.setFieldsValue({variant:void 0,color:void 0,chassisNo:void 0}),f.setFieldsValue({bikeModel:String(s).toUpperCase()})},style:{textTransform:"uppercase"},dropdownRender:void 0,children:jn.map((s,O)=>n.jsx(Wt,{value:s,children:s},O))})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Variant",name:"variant",rules:[{required:!0,message:"Select a variant"}],children:n.jsx(nt,{size:w,placeholder:"Select Variant",disabled:v||!re,onChange:s=>{f.setFieldsValue({color:void 0,chassisNo:void 0}),f.setFieldsValue({variant:String(s).toUpperCase()})},style:{textTransform:"uppercase"},dropdownRender:void 0,children:xo.map((s,O)=>n.jsx(Wt,{value:s,children:s},O))})})})]}),n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Color",name:"color",rules:[{required:!0,message:"Select color"}],children:n.jsx(nt,{size:w,disabled:v||!Ae||!dn.length,placeholder:Ae?dn.length?"Select color":"No colors in vehicle catalog":"Select variant first",options:dn.map(s=>({value:s,label:s})),onChange:s=>f.setFieldsValue({color:String(s||"").toUpperCase(),chassisNo:void 0}),style:{textTransform:"uppercase"},showSearch:!1,dropdownRender:void 0})})}),n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"On-Road Price ()",children:n.jsx("div",{style:{display:"flex",gap:8},children:n.jsx(Ue,{size:w,style:{width:"100%"},value:Ct,disabled:!ho,min:0,onChange:s=>{const O=Number(s||0)||0;Bn(O)}})})})})]}),n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Chassis Number",name:"chassisNo",rules:[{required:!0,message:"Select chassis or choose Allot Vehicle"}],children:n.jsxs(nt,{size:w,placeholder:Ke?"Select Chassis":"Select color first",disabled:ne||!Ke,loading:en,showSearch:!0,optionFilterProp:"children",onChange:s=>{ee(!1),f.setFieldsValue({chassisNo:String(s).toUpperCase()}),Wn(s)},allowClear:!0,style:{textTransform:"uppercase"},dropdownRender:void 0,children:[So.map(s=>n.jsx(Wt,{value:s,children:s},s)),n.jsx(Wt,{value:"__ALLOT__",children:"Allot Vehicle (assign later)"})]})})}),n.jsx(ge,{xs:24,md:12,style:{display:"flex",alignItems:"center"},children:n.jsxs("div",{children:[n.jsx("div",{style:{marginBottom:6},children:"Availability"}),Oe==="found"&&n.jsxs(rt,{color:"green",children:["In Stock",Te?.branch?` @ ${Te.branch}`:""]}),Oe==="allot"&&n.jsx(rt,{color:"blue",children:"To be allotted"}),Oe==="not_found"&&n.jsx(rt,{color:"red",children:"Not Found"}),Oe==="checking"&&n.jsx(rt,{children:"Checking"}),Oe==="idle"&&n.jsx(rt,{children:"Select chassis to check"})]})})]}),n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"RTO (Office)",name:"rtoOffice",initialValue:"KA",rules:[{required:!0,message:"Enter RTO code (KA + 2 digits)"},{pattern:/^KA\d{2}$/,message:"Use format KA01, KA13, KA05"}],normalize:s=>{const O=String(s||"").toUpperCase().replace(/\s+/g,"");if(!O)return"KA";const P=O.startsWith("KA")?O.slice(2):O.replace(/[^0-9]/g,""),D=String(P||"").replace(/\D/g,"").slice(0,2);return D?`KA${D}`:"KA"},getValueFromEvent:s=>s?.target?.value?.toUpperCase?.(),children:n.jsx(vt,{size:w,placeholder:"e.g., KA02",maxLength:4,disabled:v,style:{textTransform:"uppercase"}})})})}),n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,md:18,children:n.jsx(V.Item,{label:"Purchase Mode",name:"purchaseType",initialValue:"cash",rules:[{required:!0,message:"Choose purchase mode"}],children:n.jsxs(yt.Group,{disabled:v,children:[n.jsx(yt.Button,{value:"cash",children:"Cash"}),n.jsx(yt.Button,{value:"loan",children:"Loan"}),n.jsx(yt.Button,{value:"nohp",children:"No HP"})]})})})}),Pe==="loan"&&n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Financier",name:"financier",rules:[{required:!0,message:"Select financier"}],children:n.jsx(nt,{size:w,placeholder:"Select Financier",showSearch:!0,optionFilterProp:"children",disabled:v,onChange:s=>f.setFieldsValue({financier:String(s).toUpperCase()}),style:{textTransform:"uppercase"},dropdownRender:void 0,children:ql.map(s=>n.jsx(Wt,{value:s,children:s},s))})})})}),Pe==="nohp"&&n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"No HP Options",name:"nohpFinancier",rules:[{required:!0,message:"Select option"}],children:n.jsxs(nt,{size:w,placeholder:"Select",disabled:v,onChange:s=>f.setFieldsValue({nohpFinancier:String(s).toUpperCase()}),style:{textTransform:"uppercase"},dropdownRender:void 0,children:[n.jsx(Wt,{value:"IDFC",children:"IDFC"}),n.jsx(Wt,{value:"L&T",children:"L&T FINANCE LIMITED"})]})})})}),(Pe==="loan"||Pe==="nohp")&&n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Disbursement Amount ()",name:"disbursementAmount",rules:[{required:!0,message:"Enter disbursement amount"}],children:n.jsx(Ue,{size:w,style:{width:"100%"},min:1,step:500,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v||zt})})})}),n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Address Proof",name:"addressProofMode",initialValue:"aadhaar",rules:[{required:!0}],children:n.jsxs(yt.Group,{children:[n.jsx(yt.Button,{value:"aadhaar",children:"As per Aadhaar / Voter ID"}),n.jsx(yt.Button,{value:"additional",children:"Additional"})]})})})}),xe==="additional"&&n.jsx(Ht,{size:"small",title:n.jsx(_r,{strong:!0,children:"Additional Address Proof"}),style:{marginTop:8,marginBottom:12,borderRadius:12},headStyle:{background:"#f8fafc",borderRadius:12},children:n.jsx(Le,{gutter:[16,16],children:n.jsx(ge,{xs:24,children:n.jsx(V.Item,{label:"Select proof types",name:"addressProofTypes",rules:[{required:!0,message:"Select at least one type"}],children:n.jsx(hs.Group,{options:[{label:"Driving License",value:"DL"},{label:"Gas Bill",value:"GasBill"},{label:"Rental Agreement",value:"RentalAgreement"},{label:"Others",value:"Others"}]})})})})}),n.jsx(Le,{gutter:[16,16],children:n.jsx(ge,{xs:24,children:n.jsx(V.Item,{label:"Upload Document (PDF only)",children:n.jsxs(Ul,{multiple:!1,beforeUpload:An,fileList:I,onChange:({fileList:s})=>E(s.slice(0,1)),maxCount:1,accept:".pdf",itemRender:s=>s,disabled:!1,children:[n.jsx("p",{className:"ant-upload-drag-icon",children:n.jsx(dl,{})}),n.jsx("p",{className:"ant-upload-text",children:"Upload the document in PDF format."}),n.jsx("p",{className:"ant-upload-hint",children:"Maximum size 5MB. PDFs only."})]})})})}),(Pe==="loan"||Pe==="nohp")&&n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"EMI Amount ()",name:"emiAmount",children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,placeholder:"Enter EMI amount",disabled:v})})}),n.jsx(ge,{xs:24,md:12,children:n.jsx(V.Item,{label:"Tenure (Months)",name:"tenure",children:n.jsx(Ue,{size:w,style:{width:"100%"},min:1,step:1,precision:0,placeholder:"Enter months (e.g., 36)",disabled:v})})})]}),n.jsx(Le,{gutter:[16,0],children:n.jsx(ge,{xs:24,children:n.jsx(V.Item,{label:"Address",name:"address",rules:[{required:!0,message:"Please enter address"}],getValueFromEvent:s=>s?.target?.value?.toUpperCase?.(),children:n.jsx(vt.TextArea,{rows:3,placeholder:"House No, Street, Area, City, PIN",allowClear:!0,disabled:v,style:{textTransform:"uppercase"}})})})}),(Pe==="loan"||Pe==="nohp")&&n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Down Payment ()",name:"downPayment",rules:[{required:!0,message:"Enter down payment"}],children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:500,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Extra Fitting Amount ()",name:"extraFittingAmount",initialValue:0,children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Discount ()",name:"discountAmount",initialValue:0,children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})}),xe==="additional"&&n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Affidavit Charges ()",name:"affidavitCharges",rules:[{required:!0,message:"Enter affidavit charges"}],children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})})]}),Pe==="cash"&&n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Extra Fitting Amount ()",name:"extraFittingAmount",initialValue:0,children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Discount ()",name:"discountAmount",initialValue:0,children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})}),xe==="additional"&&n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Affidavit Charges ()",name:"affidavitCharges",rules:[{required:!0,message:"Enter affidavit charges"}],children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:100,prefix:n.jsx(Pt,{}),placeholder:"Enter amount",disabled:v})})})]}),(Pe==="loan"||Pe==="nohp")&&n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Total DP ()",children:n.jsx(Ue,{size:w,style:{width:"100%"},value:yn,disabled:!0})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Balanced DP ()",children:n.jsx(Ue,{size:w,style:{width:"100%"},value:bo,disabled:!0})})})]}),Pe==="cash"&&n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Total Vehicle Cost ()",children:n.jsx(Ue,{size:w,style:{width:"100%"},value:ln,disabled:!0})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Balanced Amount ()",children:n.jsx(Ue,{size:w,style:{width:"100%"},value:Dn,disabled:!0})})})]}),n.jsxs(Le,{gutter:[16,0],children:[n.jsx(ge,{xs:24,children:n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Booking Payments (split Cash + Online inside each partial)"})}),[1,2,3].map(s=>n.jsxs(ot.Fragment,{children:[n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:`Amount ${s} - Cash ()`,name:`bookingAmount${s}Cash`,dependencies:s===1?[`bookingAmount${s}Online`]:void 0,rules:s===1?[{validator:(O,P)=>{const D=Number(P||0)||0,G=Number(f.getFieldValue(`bookingAmount${s}Online`)||0)||0;return D>0||G>0?Promise.resolve():Promise.reject(new Error("Enter Amount 1 (cash or online)"))}}]:[],children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:500,prefix:n.jsx(Pt,{}),placeholder:"0"})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:`Amount ${s} - Online ()`,name:`bookingAmount${s}Online`,children:n.jsx(Ue,{size:w,style:{width:"100%"},min:0,step:500,prefix:n.jsx(Pt,{}),placeholder:"0"})})}),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{shouldUpdate:!0,noStyle:!0,children:()=>{const O=Number(f.getFieldValue(`bookingAmount${s}Online`)||0)||0;return n.jsx(V.Item,{label:`UTR / Ref No.${s}`,name:`paymentReference${s}`,rules:O>0?[{required:!0,message:"Enter UTR / reference number"}]:[],getValueFromEvent:P=>{const D=P&&P.target?P.target.value:P;return typeof D=="string"?D.toUpperCase():D},children:n.jsx(vt,{size:w,placeholder:"e.g., 23XXXXUTR123",allowClear:!0,disabled:O<=0,style:{textTransform:"uppercase"}})})}})})]},`p-${s}`)),n.jsx(ge,{xs:24,md:8,children:n.jsx(V.Item,{label:"Total Booking Amount ()",children:n.jsx(Ue,{size:w,style:{width:"100%"},value:it,disabled:!0})})})]}),n.jsxs(V.Item,{style:{marginTop:8,marginBottom:0},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:S?"1fr":"1fr auto",gap:8},children:[n.jsx(ze,{type:"primary",htmlType:"submit",size:S?"middle":"large",loading:yo,disabled:zn>Date.now(),children:"Save Booking"}),zt&&n.jsx(ze,{className:"no-print",icon:n.jsx(vs,{}),size:S?"middle":"large",onClick:xn,disabled:Ln,loading:Ln,children:"Print Booking Slip"})]}),!zt&&n.jsxs("div",{style:{marginTop:6,color:"#b91c1c",fontSize:12},children:["Save first, then fetch booking to enable printing."," ","  ,   ."]})]})]});return e?n.jsx("div",{style:{paddingTop:4},children:Nn}):n.jsxs("div",{style:{padding:S?12:M?18:24,background:S?"transparent":"linear-gradient(180deg,#f8fbff 0%,#ffffff 100%)",minHeight:"100dvh",display:"grid",alignItems:"start",position:"relative"},children:[_&&n.jsx("div",{style:{position:"fixed",inset:0,zIndex:2e3,background:"rgba(255,255,255,0.88)",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(io,{tip:"Fetching booking details...",size:"large"})}),n.jsx(Ht,{bordered:!1,style:{width:"100%",maxWidth:920,margin:S?"8px auto 24dvh":"16px auto",borderRadius:16,boxShadow:"0 10px 30px rgba(37, 99, 235, 0.10), 0 2px 8px rgba(0,0,0,0.06)"},bodyStyle:{padding:S?16:28},headStyle:{borderBottom:"none",padding:S?"12px 16px 0":"16px 28px 0"},title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:S?"wrap":"nowrap"},children:[qn,n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx(Vl,{level:S?4:3,style:{margin:0},children:"Two Wheeler Booking"}),n.jsx(_r,{type:"secondary",children:"Fill the details below to reserve your ride."})]}),n.jsx("div",{style:{flex:1}}),n.jsxs(qt,{size:8,wrap:!0,children:[n.jsx(Sl,{form:f,webhookUrl:to,setSelectedCompany:ke,setSelectedModel:le,onApplied:Dt,autoSearch:te}),n.jsx(zl,{form:f,webhookUrl:to,bookingId:$?.bookingId,mobile:$?.mobile})]})]}),children:Nn}),n.jsx(pa,{ref:C,active:!0,vals:Un})]})}const Ec=Object.freeze(Object.defineProperty({__proto__:null,default:Zl},Symbol.toStringTag,{value:"Module"}));export{Zl as B,Dl as F,la as P,Or as R,Fn as U,zl as a,wl as b,kc as c,Tn as d,fl as e,Ac as f,oo as g,Os as h,Nc as i,Cc as j,$c as k,Er as l,Ec as m,Oc as r,Pc as u};
